[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Breaking Down Demographics",
    "section": "",
    "text": "Your report goes here.\n\n\nCode\n# a test code chunk",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Report</span>"
    ]
  },
  {
    "objectID": "eda/eda-member1.html",
    "href": "eda/eda-member1.html",
    "title": "Nico T",
    "section": "",
    "text": "Code\n# Importing libraries and data set\nlibrary(tidyverse)\nlibrary(DataExplorer)\nlibrary(gtsummary)\ndemographics &lt;- read.csv(\"../data/raw/data1/acs2017_county_data.csv\")\n\n\n\nLooking at our variables\n\nFirst Observations\n\n\nCode\nhead(demographics)\n\n\n  CountyId   State         County TotalPop   Men  Women Hispanic White Black\n1     1001 Alabama Autauga County    55036 26899  28137      2.7  75.4  18.9\n2     1003 Alabama Baldwin County   203360 99527 103833      4.4  83.1   9.5\n3     1005 Alabama Barbour County    26201 13976  12225      4.2  45.7  47.8\n4     1007 Alabama    Bibb County    22580 12251  10329      2.4  74.6  22.0\n5     1009 Alabama  Blount County    57667 28490  29177      9.0  87.4   1.5\n6     1011 Alabama Bullock County    10478  5616   4862      0.3  21.6  75.6\n  Native Asian Pacific VotingAgeCitizen Income IncomeErr IncomePerCap\n1    0.3   0.9       0            41016  55317      2838        27824\n2    0.8   0.7       0           155376  52562      1348        29364\n3    0.2   0.6       0            20269  33368      2551        17561\n4    0.4   0.0       0            17662  43404      3431        20911\n5    0.3   0.1       0            42513  47412      2630        22021\n6    1.0   0.7       0             8212  29655      5376        20856\n  IncomePerCapErr Poverty ChildPoverty Professional Service Office Construction\n1            2024    13.7         20.1         35.3    18.0   23.2          8.1\n2             735    11.8         16.1         35.7    18.2   25.6          9.7\n3             798    27.2         44.9         25.0    16.8   22.6         11.5\n4            1889    15.2         26.6         24.4    17.6   19.7         15.9\n5             850    15.6         25.4         28.5    12.9   23.3         15.8\n6            2355    28.5         50.4         19.7    17.1   18.6         14.0\n  Production Drive Carpool Transit Walk OtherTransp WorkAtHome MeanCommute\n1       15.4  86.0     9.6     0.1  0.6         1.3        2.5        25.8\n2       10.8  84.7     7.6     0.1  0.8         1.1        5.6        27.0\n3       24.1  83.4    11.1     0.3  2.2         1.7        1.3        23.4\n4       22.4  86.4     9.5     0.7  0.3         1.7        1.5        30.0\n5       19.5  86.8    10.2     0.1  0.4         0.4        2.1        35.0\n6       30.6  73.1    15.7     0.3  6.2         1.7        3.0        29.8\n  Employed PrivateWork PublicWork SelfEmployed FamilyWork Unemployment\n1    24112        74.1       20.2          5.6        0.1          5.2\n2    89527        80.7       12.9          6.3        0.1          5.5\n3     8878        74.1       19.1          6.5        0.3         12.4\n4     8171        76.0       17.4          6.3        0.3          8.2\n5    21380        83.9       11.9          4.0        0.1          4.9\n6     4290        81.4       13.6          5.0        0.0         12.1\n\n\nCode\ndim(demographics)\n\n\n[1] 3220   37\n\n\n\n\nCode\ndemographics %&gt;%\n   mutate(across(where(is.character), as.factor)) %&gt;% \n   summary()\n\n\n    CountyId          State                    County        TotalPop       \n Min.   : 1001   Texas   : 254   Washington County:  30   Min.   :      74  \n 1st Qu.:19032   Georgia : 159   Jefferson County :  25   1st Qu.:   11214  \n Median :30024   Virginia: 133   Franklin County  :  24   Median :   25848  \n Mean   :31394   Kentucky: 120   Jackson County   :  23   Mean   :  100768  \n 3rd Qu.:46106   Missouri: 115   Lincoln County   :  23   3rd Qu.:   66608  \n Max.   :72153   Kansas  : 105   Madison County   :  19   Max.   :10105722  \n                 (Other) :2334   (Other)          :3076                     \n      Men              Women            Hispanic         White       \n Min.   :     39   Min.   :     35   Min.   :  0.0   Min.   :  0.00  \n 1st Qu.:   5646   1st Qu.:   5554   1st Qu.:  2.1   1st Qu.: 63.50  \n Median :  12879   Median :  12994   Median :  4.1   Median : 83.60  \n Mean   :  49588   Mean   :  51180   Mean   : 11.3   Mean   : 74.92  \n 3rd Qu.:  33017   3rd Qu.:  33594   3rd Qu.: 10.0   3rd Qu.: 92.80  \n Max.   :4979641   Max.   :5126081   Max.   :100.0   Max.   :100.00  \n                                                                     \n     Black            Native           Asian           Pacific        \n Min.   : 0.000   Min.   : 0.000   Min.   : 0.000   Min.   : 0.00000  \n 1st Qu.: 0.600   1st Qu.: 0.100   1st Qu.: 0.200   1st Qu.: 0.00000  \n Median : 2.000   Median : 0.300   Median : 0.600   Median : 0.00000  \n Mean   : 8.682   Mean   : 1.768   Mean   : 1.289   Mean   : 0.08342  \n 3rd Qu.: 9.500   3rd Qu.: 0.600   3rd Qu.: 1.200   3rd Qu.: 0.10000  \n Max.   :86.900   Max.   :90.300   Max.   :41.800   Max.   :33.70000  \n                                                                      \n VotingAgeCitizen      Income         IncomeErr      IncomePerCap  \n Min.   :     59   Min.   : 11680   Min.   :  262   Min.   : 5943  \n 1st Qu.:   8442   1st Qu.: 40622   1st Qu.: 1730   1st Qu.:21568  \n Median :  19699   Median : 47636   Median : 2587   Median :25139  \n Mean   :  71310   Mean   : 48995   Mean   : 3139   Mean   :25657  \n 3rd Qu.:  50366   3rd Qu.: 55476   3rd Qu.: 3802   3rd Qu.:28997  \n Max.   :6218279   Max.   :129588   Max.   :41001   Max.   :69529  \n                                                                   \n IncomePerCapErr    Poverty       ChildPoverty    Professional  \n Min.   :  129   Min.   : 2.40   Min.   : 0.00   Min.   :11.40  \n 1st Qu.:  832   1st Qu.:11.47   1st Qu.:14.90   1st Qu.:27.20  \n Median : 1225   Median :15.40   Median :21.50   Median :30.50  \n Mean   : 1514   Mean   :16.78   Mean   :23.04   Mean   :31.48  \n 3rd Qu.: 1802   3rd Qu.:19.80   3rd Qu.:28.60   3rd Qu.:34.90  \n Max.   :16145   Max.   :65.20   Max.   :83.60   Max.   :69.00  \n                                 NA's   :1                      \n    Service          Office       Construction     Production   \n Min.   : 0.00   Min.   : 4.80   Min.   : 0.00   Min.   : 0.00  \n 1st Qu.:15.80   1st Qu.:19.90   1st Qu.: 9.80   1st Qu.:11.50  \n Median :17.80   Median :22.10   Median :12.10   Median :15.40  \n Mean   :18.21   Mean   :21.88   Mean   :12.59   Mean   :15.84  \n 3rd Qu.:20.20   3rd Qu.:23.90   3rd Qu.:14.80   3rd Qu.:19.50  \n Max.   :46.40   Max.   :37.20   Max.   :36.40   Max.   :48.70  \n                                                                \n     Drive          Carpool          Transit            Walk       \n Min.   : 4.60   Min.   : 0.000   Min.   : 0.000   Min.   : 0.000  \n 1st Qu.:77.30   1st Qu.: 8.000   1st Qu.: 0.100   1st Qu.: 1.400  \n Median :81.00   Median : 9.500   Median : 0.300   Median : 2.300  \n Mean   :79.63   Mean   : 9.852   Mean   : 0.939   Mean   : 3.244  \n 3rd Qu.:84.10   3rd Qu.:11.300   3rd Qu.: 0.800   3rd Qu.: 3.825  \n Max.   :97.20   Max.   :29.300   Max.   :61.800   Max.   :59.200  \n                                                                   \n  OtherTransp       WorkAtHome      MeanCommute       Employed      \n Min.   : 0.000   Min.   : 0.000   Min.   : 5.10   Min.   :     39  \n 1st Qu.: 0.800   1st Qu.: 2.900   1st Qu.:19.60   1st Qu.:   4573  \n Median : 1.300   Median : 4.100   Median :23.20   Median :  10612  \n Mean   : 1.599   Mean   : 4.737   Mean   :23.47   Mean   :  47093  \n 3rd Qu.: 1.900   3rd Qu.: 5.800   3rd Qu.:27.00   3rd Qu.:  28747  \n Max.   :43.200   Max.   :33.000   Max.   :45.10   Max.   :4805817  \n                                                                    \n  PrivateWork      PublicWork     SelfEmployed      FamilyWork    \n Min.   :31.10   Min.   : 4.40   Min.   : 0.000   Min.   :0.0000  \n 1st Qu.:71.20   1st Qu.:12.70   1st Qu.: 5.200   1st Qu.:0.1000  \n Median :76.10   Median :15.90   Median : 6.800   Median :0.2000  \n Mean   :74.86   Mean   :17.09   Mean   : 7.773   Mean   :0.2788  \n 3rd Qu.:80.20   3rd Qu.:19.90   3rd Qu.: 9.200   3rd Qu.:0.3000  \n Max.   :88.80   Max.   :64.80   Max.   :38.000   Max.   :8.0000  \n                                                                  \n  Unemployment   \n Min.   : 0.000  \n 1st Qu.: 4.475  \n Median : 6.100  \n Mean   : 6.666  \n 3rd Qu.: 8.000  \n Max.   :40.900  \n                 \n\n\n\nIt looks like we have 3220 counties with 37 varibles. Two are characters, and the rest are doubles or integers respectively. The race variables seem to measure the percentage of a county is said race. Some of the variables are measured in percentages while others are measured in counts.\n\n\nLooking at the counties with 100 percent white or hispanic populations\nThis seems odd because I would assume that very little communities in the united states would have homogeneous populations.\n\n\nCode\ndemographics |&gt; \n  filter(White == 100 | Hispanic == 100)\n\n\n  CountyId        State                 County TotalPop   Men Women Hispanic\n1    46075 South Dakota           Jones County      740   375   365        0\n2    72019  Puerto Rico Barranquitas Municipio    29237 14398 14839      100\n  White Black Native Asian Pacific VotingAgeCitizen Income IncomeErr\n1   100     0      0     0       0              617  39432      8759\n2     0     0      0     0       0            22093  15694      1496\n  IncomePerCap IncomePerCapErr Poverty ChildPoverty Professional Service Office\n1        26526            3319    10.8          0.0         44.7     9.8   15.1\n2         7716             597    60.7         77.8         28.4    22.3   23.9\n  Construction Production Drive Carpool Transit Walk OtherTransp WorkAtHome\n1         17.2       13.3  61.6     4.5     0.0 20.4         1.9       11.6\n2         14.1       11.3  87.4     6.6     0.8  2.9         0.0        2.3\n  MeanCommute Employed PrivateWork PublicWork SelfEmployed FamilyWork\n1        14.9      430        55.3       16.3         22.6        5.8\n2        31.2     6011        65.7       25.6          8.7        0.0\n  Unemployment\n1          2.9\n2         11.7\n\n\n\nThese communties also report that the populations of the other groups are 0, so I am not concerned with these values.\n\n\n\n\nMissing Values\n\n\nCode\nplot_missing(demographics)\n\n\n\n\n\n\n\n\n\n\nIt appears that we have 1 missing value in the child poverty variable\n\n\n\nLooking at the missing data\n\n\nCode\ndemographics |&gt; \n  filter(is.na(ChildPoverty))\n\n\n  CountyId  State         County TotalPop Men Women Hispanic White Black Native\n1    15005 Hawaii Kalawao County       86  41    45      4.7  20.9     0      0\n  Asian Pacific VotingAgeCitizen Income IncomeErr IncomePerCap IncomePerCapErr\n1  29.1    33.7               84  61750     11280        46024            7959\n  Poverty ChildPoverty Professional Service Office Construction Production\n1    12.7           NA         22.2    38.1   20.6            0         19\n  Drive Carpool Transit Walk OtherTransp WorkAtHome MeanCommute Employed\n1  32.8     9.4       0 40.6        10.9        6.3         6.6       63\n  PrivateWork PublicWork SelfEmployed FamilyWork Unemployment\n1        34.9       61.9          3.2          0            0\n\n\n\nWe might want to look further into how to solve for this missing value\n\n\n\nCode\nplot_histogram(demographics)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHere we can see how some groups are minorites, but what is mre interesting is to see how they look different in communities with different levels of demographics in there population.\n\n\n\n\nLooking at relationships\n\n\nCode\nplot_correlation(demographics)\n\n\n\n\n\n\n\n\n\n\n\nCode\nplot_scatterplot(split_columns(demographics)$continuous, by = \"White\", sampled_rows = 1000L)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nplot_scatterplot(split_columns(demographics)$continuous, by = \"Black\", sampled_rows = 1000L)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIt looks like an interesting variable to explore is the employment status compared to different races. Also looking at thngs like how do people of different demographics get to work would also be an instesting thing to observe as well. Since the plots and correlation meter show that they are highly related. We can also find plenty of information to make a good data story with this information",
    "crumbs": [
      "EDA",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Nico T</span>"
    ]
  },
  {
    "objectID": "eda/eda-member2.html",
    "href": "eda/eda-member2.html",
    "title": "Member 2 First Name & Last Name Initial",
    "section": "",
    "text": "Your exploratory data analysis of the team datasets go here.\n\n\nCode\nlibrary(tidyverse)\nlibrary(tidycensus)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n\n\n\nCode\ncensus_data &lt;- read_csv(\"../data/processed/acs_2023.csv\")\n\n\n\n\nCode\nsanfrancisco &lt;- get_acs(\n  state = \"CA\",\n  county = \"San Francisco\",\n  geography = \"county\",\n  variables = c(\"B02001_002\", \"B02001_003\", \"B02001_004\", \"B02001_005\", \n                \"B02001_006\", \"B02001_007\", \"B02001_008\"),\n  year = 2023\n)\n\n\n\n\nCode\nmesa &lt;- get_acs(\n  state = \"AZ\",\n  county = \"Maricopa\",\n  geography = \"county\",\n  variables = c(\"B02001_002\", \"B02001_003\", \"B02001_004\", \"B02001_005\", \n                \"B02001_006\", \"B02001_007\", \"B02001_008\"),\n  year = 2023\n)\n\n\n\n\nCode\ndata &lt;- rbind(sanfrancisco, mesa)\n\ndata &lt;- data %&gt;%\n  select(NAME, variable, estimate) %&gt;%\n  rename(\"county\" = \"NAME\",\n         \"race\" = \"variable\",\n         \"population\" = \"estimate\") %&gt;%\n  mutate(race = case_when(\n    race == \"B02001_002\" ~ \"White\",\n    race == \"B02001_003\" ~ \"Black\",\n    race == \"B02001_004\" ~ \"American Indian\",\n    race == \"B02001_005\" ~ \"Asian\",\n    race == \"B02001_006\" ~ \"Pacific Islander\",\n    race == \"B02001_007\" ~ \"Other\",\n    race == \"B02001_008\" ~ \"Two or more races\"\n  )) %&gt;%\n  mutate(county = case_when(\n    county == \"San Francisco County, California\" ~ \"San Francisco\",\n    county == \"Maricopa County, Arizona\" ~ \"Maricopa\"\n  ))\n\n\n\n\nCode\ndata %&gt;% \n  group_by(county) %&gt;%\n  mutate(prop = population / sum(population)) %&gt;%\n  ggplot(aes(x = county, y = prop, fill = race)) +\n  geom_bar(stat = \"identity\", position = \"fill\") +\n  scale_y_continuous(labels = scales::percent) +\n  labs(title = \"Race Composition of Two Counties\",\n       x = \"County\",\n       y = \"Percent of Population\",\n       fill = \"Race Group\") + \n  scale_fill_manual(values = c(\n  \"#4E79A7\", # steel blue\n  \"#A0CBE8\", # light blue\n  \"#F28E2B\", # orange\n  \"#FFBE7D\", # light orange\n  \"#59A14F\", # muted green\n  \"#8CD17D\", # light green\n  \"#B6992D\"  # olive gold\n)) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\ndata5 &lt;- data %&gt;%\n  filter(race %in% c(\"White\", \"Black\", \"Asian\", \"American Indian\")) %&gt;%\n  mutate(race = factor(\n    race,\n    levels = c(\n      \"American Indian\",\n      \"Black\",\n      \"Asian\",\n      \"White\"\n    )\n  ))\n\ndata5 %&gt;% \n  group_by(county) %&gt;%\n  mutate(prop = population / sum(population)) %&gt;%\n  ggplot(aes(x = county, y = prop, fill = race)) +\n  geom_bar(stat = \"identity\", position = \"fill\") +\n  scale_y_continuous(labels = scales::percent) +\n  labs(title = \"Race Composition of Two Counties\",\n       x = \"County\",\n       y = \"Percent of Population\",\n       fill = \"Race Group\") + \n  scale_fill_manual(values = c(\n  \n  \"#FFBE7D\",\n  \"#59A14F\",\n  \"#8CD17D\",\n  \"#A0CBE8\"\n)) +\n  theme_minimal() +\n  coord_flip()\n\n\n\n\n\n\n\n\n\n\n\nCode\nsanfrancisco2 &lt;- get_acs(\n  state = \"CA\",\n  county = \"San Francisco\",\n  geography = \"county\",\n  variables = c(\"B15003_002\",\"B15003_003\",\"B15003_004\",\"B15003_005\",\n                \"B15003_006\",\"B15003_007\",\"B15003_008\",\"B15003_009\",\"B15003_010\",\n                \"B15003_011\",\"B15003_012\",\"B15003_013\",\"B15003_014\",\"B15003_015\",\n                \"B15003_016\",\"B15003_017\",\"B15003_018\",\"B15003_019\",\"B15003_020\",\n                \"B15003_021\",\"B15003_022\",\"B15003_023\",\"B15003_024\",\"B15003_025\"),\n  year = 2023\n)\n\n\n\n\nCode\nmesa2 &lt;- get_acs(\n  state = \"AZ\",\n  county = \"Maricopa\",\n  geography = \"county\",\n  variables = c(\"B15003_002\",\"B15003_003\",\"B15003_004\",\"B15003_005\",\n                \"B15003_006\",\"B15003_007\",\"B15003_008\",\"B15003_009\",\"B15003_010\",\n                \"B15003_011\",\"B15003_012\",\"B15003_013\",\"B15003_014\",\"B15003_015\",\n                \"B15003_016\",\"B15003_017\",\"B15003_018\",\"B15003_019\",\"B15003_020\",\n                \"B15003_021\",\"B15003_022\",\"B15003_023\",\"B15003_024\",\"B15003_025\"),\n  year = 2023\n)\n\n\n\n\nCode\ndata2 &lt;- rbind(sanfrancisco2, mesa2)\n\ndata2 &lt;- data2 %&gt;%\n  select(NAME, variable, estimate) %&gt;%\n  rename(\"county\" = \"NAME\",\n         \"education\" = \"variable\",\n         \"population\" = \"estimate\") %&gt;%\n  mutate(education = case_when(\n    education == \"B15003_002\" ~ \"None\",\n    education == \"B15003_003\" ~ \"Nursery\",\n    education == \"B15003_004\" ~ \"Kindergarten\",\n    education == \"B15003_005\" ~ \"Kindergarten\",\n    education == \"B15003_006\" ~ \"Kindergarten\",\n    education == \"B15003_007\" ~ \"Kindergarten\",\n    education == \"B15003_008\" ~ \"Kindergarten\",\n    education == \"B15003_009\" ~ \"Elementary\",\n    education == \"B15003_010\" ~ \"Elementary\",\n    education == \"B15003_011\" ~ \"Elementary\",\n    education == \"B15003_012\" ~ \"Elementary\",\n    education == \"B15003_013\" ~ \"Middle\",\n    education == \"B15003_014\" ~ \"Middle\",\n    education == \"B15003_015\" ~ \"Middle\",\n    education == \"B15003_016\" ~ \"Middle\",\n    education == \"B15003_017\" ~ \"Highschool (or equivalent)\",\n    education == \"B15003_018\" ~ \"GED\",\n    education == \"B15003_019\" ~ \"Some College\",\n    education == \"B15003_020\" ~ \"Some College\",\n    education == \"B15003_021\" ~ \"Associate's\",\n    education == \"B15003_022\" ~ \"Bachelor's\",\n    education == \"B15003_023\" ~ \"Master's\",\n    education == \"B15003_024\" ~ \"Professional\",\n    education == \"B15003_025\" ~ \"Doctorate\"\n  )) %&gt;%\n  mutate(education = case_when(\n    education == \"None\" ~ \"None\",\n    education == \"Nursery\" ~ \"Pre-Highschool\",\n    education == \"Kindergarten\" ~ \"Pre-Highschool\",\n    education == \"Elementary\" ~ \"Pre-Highschool\",\n    education == \"Middle\" ~ \"Pre-Highschool\",\n    education == \"Highschool (or equivalent)\" ~ \"Highschool (or equivalent)\",\n    education == \"GED\" ~ \"Highschool (or equivalent)\",\n    education == \"Some College\" ~ \"Some College\",\n    education == \"Associate's\" ~ \"Undergraduate Degree (or equivalent)\",\n    education == \"Bachelor's\" ~ \"Undergraduate Degree (or equivalent)\",\n    education == \"Professional\" ~ \"Undergraduate Degree (or equivalent)\",\n    education == \"Master's\" ~ \"Graduate Degree\",\n    education == \"Doctorate\" ~ \"Graduate Degree\",\n  )) %&gt;%\n  mutate(county = case_when(\n    county == \"San Francisco County, California\" ~ \"San Francisco\",\n    county == \"Maricopa County, Arizona\" ~ \"Maricopa\"\n  ))\n\n\n\n\nCode\ndata2 &lt;- data2 %&gt;% \n  group_by(county) %&gt;%\n  mutate(prop = population / sum(population)) %&gt;%\n  mutate(education = factor(\n    education,\n    levels = c(\n      \"Graduate Degree\",\n      \"Undergraduate Degree (or equivalent)\",\n      \"Some College\",\n      \"Highschool (or equivalent)\",\n      \"Pre-Highschool\",\n      \"None\"\n    )\n  ))\n  \n\ndata2 %&gt;%\n  ggplot(aes(x = county, y = prop, fill = education)) +\n  geom_bar(stat = \"identity\", position = \"fill\") +\n  scale_y_continuous(labels = scales::percent) +\n  labs(title = \"Highest Education Completed in Two Counties\",\n       x = \"County\",\n       y = \"Percent of Population\",\n       fill = \"Education Level\") + \n  scale_fill_manual(values = c(\n  \"#4E79A7\",\n  \"#A0CBE8\",\n  \"#59A14F\",\n  \"#8CD17D\",\n  \"#FFBE7D\",\n  \"#F28E2B\"\n)) +\n  theme_minimal() + \n  coord_flip()\n\n\n\n\n\n\n\n\n\n\n\nCode\nsanfrancisco3 &lt;- get_acs(\n  state = \"CA\",\n  county = \"San Francisco\",\n  geography = \"county\",\n  variables = c(\"B11001_003\", \"B11001_005\", \"B11001_006\", \n                \"B11001_008\", \"B11001_009\"),\n  year = 2023\n)\n\n\n\n\nCode\nmesa3 &lt;- get_acs(\n  state = \"AZ\",\n  county = \"Maricopa\",\n  geography = \"county\",\n  variables = c(\"B11001_003\", \"B11001_005\", \"B11001_006\", \n                \"B11001_008\", \"B11001_009\"),\n  year = 2023\n)\n\n\n\n\nCode\ndata3 &lt;- rbind(sanfrancisco3, mesa3)\n\ndata3 &lt;- data3 %&gt;%\n  select(NAME, variable, estimate) %&gt;%\n  rename(\"county\" = \"NAME\",\n         \"household\" = \"variable\",\n         \"population\" = \"estimate\")  %&gt;%\n  mutate(county = case_when(\n    county == \"San Francisco County, California\" ~ \"San Francisco\",\n    county == \"Maricopa County, Arizona\" ~ \"Maricopa\"\n  )) %&gt;%\n  mutate(household = case_when(\n    household == \"B11001_003\" ~ \"Married couple (family)\",\n    household == \"B11001_005\" ~ \"Male householder, no spouse (family)\",\n    household == \"B11001_006\" ~ \"Female householder, no spouse (family)\",\n    household == \"B11001_008\" ~ \"Lives alone (non-family)\",\n    household == \"B11001_009\" ~ \"Does not live alone (non-family)\"\n  ))\n\n\n\n\nCode\ndata3 %&gt;% \n  group_by(county) %&gt;%\n  mutate(prop = population / sum(population)) %&gt;%\n  ggplot(aes(x = county, y = prop, fill = household)) +\n  geom_bar(stat = \"identity\", position = \"fill\") +\n  scale_y_continuous(labels = scales::percent) +\n  labs(title = \"Household Type in Two Counties\",\n       x = \"County\",\n       y = \"Percent of Population\",\n       fill = \"Household Type\") + \n  scale_fill_manual(values = c(\n  \"#4E79A7\",\n  \"#F28E2B\",\n  \"#FFBE7D\",\n  \"#59A14F\",\n  \"#8CD17D\"\n)) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\nCode\nsanfrancisco4 &lt;- get_acs(\n  state = \"CA\",\n  county = \"San Francisco\",\n  geography = \"county\",\n  variables = c(\"B07011_001\"),\n  year = 2023\n)\n\n\n\n\nCode\nmesa4 &lt;- get_acs(\n  state = \"AZ\",\n  county = \"Maricopa\",\n  geography = \"county\",\n  variables = c(\"B07011_001\"),\n  year = 2023\n)\n\n\n\n\nCode\navg_income &lt;- get_acs(\n  geography = \"county\",\n  variables = c(\"B07011_001\"),\n  year = 2023\n) %&gt;%\n  summarize(income = mean(estimate, na.rm = TRUE)/1000) %&gt;%\n  mutate(county = \"Average U.S County\")\n\n\n\n\nCode\ndata4 &lt;- rbind(sanfrancisco4, mesa4)\n\ndata4 &lt;- data4 %&gt;%\n  select(NAME, estimate) %&gt;%\n  rename(\"county\" = \"NAME\",\n         \"income\" = \"estimate\")  %&gt;%\n  mutate(county = case_when(\n    county == \"San Francisco County, California\" ~ \"San Francisco\",\n    county == \"Maricopa County, Arizona\" ~ \"Maricopa\"),\n    income = income/1000)\n\n\n\n\nCode\ndata4 &lt;- rbind(data4, avg_income)\n\n\n\n\nCode\nggplot(data4, aes(x = county, y = income)) +\n  geom_bar(stat = \"identity\") +\n  theme_minimal() +\n  labs(title = \"Average Annual Income in Two Counties\",\n       x = \"County\",\n       y = \"Income (thousand)\") + \n  scale_fill_manual(values = c(\n    \"Average U.S County\" = \"#1b9e77\",\n    \"Maricopa\" = \"#d95f02\",\n    \"San Francisco\" = \"#7570b3\"\n  ))",
    "crumbs": [
      "EDA",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Member 2 First Name & Last Name Initial</span>"
    ]
  },
  {
    "objectID": "eda/eda-member3.html",
    "href": "eda/eda-member3.html",
    "title": "Member 3 First Name & Last Name Initial",
    "section": "",
    "text": "Your exploratory data analysis of the team datasets go here.",
    "crumbs": [
      "EDA",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Member 3 First Name & Last Name Initial</span>"
    ]
  },
  {
    "objectID": "appx/proposal.html",
    "href": "appx/proposal.html",
    "title": "Appendix A — Proposal",
    "section": "",
    "text": "Breaking Down Demographics\nTeam members: Lorenzo Gurrola, Nico Thorn, Jessica Lin",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Proposal</span>"
    ]
  },
  {
    "objectID": "appx/proposal.html#project-description",
    "href": "appx/proposal.html#project-description",
    "title": "Appendix A — Proposal",
    "section": "Project Description:",
    "text": "Project Description:\nOur project aims to breakdown how demographic groups affect aspects of people’s day to day lives. By evaluating different statistics by different types of demographics, we aim to develop a better understanding of how one’s demographics can potentially affect other aspects of one’s life.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Proposal</span>"
    ]
  },
  {
    "objectID": "appx/proposal.html#broad-questions",
    "href": "appx/proposal.html#broad-questions",
    "title": "Appendix A — Proposal",
    "section": "Broad Questions",
    "text": "Broad Questions\n\nAre there relationships between certain demographics and job statistics (e.g. income, occupation, hours, etc.)?\nIs a person’s location related to there demographics, and has this distribution changed overtime?",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Proposal</span>"
    ]
  },
  {
    "objectID": "appx/proposal.html#inspiration",
    "href": "appx/proposal.html#inspiration",
    "title": "Appendix A — Proposal",
    "section": "Inspiration",
    "text": "Inspiration\nAll of us had different types of inspiration for this project, including: our own demographics, wide spread use of demographics in everyday life, etc.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Proposal</span>"
    ]
  },
  {
    "objectID": "appx/proposal.html#potential-dataset",
    "href": "appx/proposal.html#potential-dataset",
    "title": "Appendix A — Proposal",
    "section": "Potential Dataset",
    "text": "Potential Dataset\nThe US Census could be a good potential data set since it collects demographics as well as other types of information for analysis.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Proposal</span>"
    ]
  },
  {
    "objectID": "appx/proposal.html#rough-implenation-plan",
    "href": "appx/proposal.html#rough-implenation-plan",
    "title": "Appendix A — Proposal",
    "section": "Rough Implenation Plan",
    "text": "Rough Implenation Plan\n\nMilestone 2\nAll group members will listen to an article, listen to a podcast, or watch a video about effective teamwork then summarize it in the corresponding sheet in their progress tracker.\n\n\nMilestone 3\nAll group members will meet and work collaboratively on reading through and evaluating a case study.\n\n\nMilestone 4\nEach member will perform an exploratory data analysis (EDA) on one of the project dataset and add the results into their respective Quarto file\n\n\nMilestone 5\nFindings will be divided equally among the group members and each member will be responsible for presenting their share of the findings.\n\n\nMilestone 6\nDifferent graphs annd parts of the datastory will be divided amoungst the group members equally. Each person will be responsible for their section and reviewing another member’s section.\n\n\nMilestone 7\nEach member will submit their repository.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Proposal</span>"
    ]
  },
  {
    "objectID": "appx/case-study.html",
    "href": "appx/case-study.html",
    "title": "Appendix B — Case Study",
    "section": "",
    "text": "We decided to look at https://pudding.cool/2017/01/making-it-big/ for our case study.\nVisualization Overview:\nWhat we like:\n\nInteractive Visualization at the beginning makes it easier to visualize the concept that it is hard to make it big and the chances of big success are slim.\nTimeline for individual bands make it easy to see, just how long and the normal progression it takes to “make it big”.\nProvides the reader a chance to look at their own favorite bands. Provides a timeline for all bands in the dataset organized by alphabetical order.\nConsistent color palette is used through out the visualizations add a sense of cohesiveness.\nAdditional annotations are in the visualizations to make points clearer.",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Case Study</span>"
    ]
  },
  {
    "objectID": "wa/wa-member1.html",
    "href": "wa/wa-member1.html",
    "title": "Appendix C — Nico T.",
    "section": "",
    "text": "Code\n# library(tidyverse)\n# demographics &lt;- read.csv(\"../data/raw/data1/acs2017_county_data.csv\")\n# acs_2023 &lt;-read_csv(\"..\\\\data\\\\raw\\\\nhgis0004_csv\\\\nhgis0004_ds266_2023_county.csv\")\n\n\n\n\nCode\n# demographics |&gt; \n#   mutate(most_common_race = case_when(\n#     White &gt; Black & White &gt; Hispanic & White &gt;Native & White &gt;Pacific ~ \"White\",\n#     Black &gt; White & Black &gt; Hispanic & Black &gt; Native & Black &gt; Pacific ~ \"Black\",\n#     Hispanic &gt; White & Hispanic &gt; Black & Hispanic &gt; Native & Hispanic &gt; Pacific ~ \"Hispanic\",\n#     Native &gt; White & Native &gt; Black & Native &gt; Hispanic & Native &gt; Pacific ~ \"Native\",\n#     Pacific &gt; Black & Pacific &gt; White & Pacific &gt; Hispanic & Pacific &gt; Native ~ \"Pacific\"\n#   )) |&gt; \n#   select(FamilyWork, SelfEmployed, PublicWork, PrivateWork, CountyId, most_common_race) |&gt; \n#   pivot_longer(cols = c(SelfEmployed, PublicWork, PrivateWork, FamilyWork), names_to = \"Employment_Category\", values_to = \"Percentage\") |&gt;\n#   group_by(most_common_race, Employment_Category) |&gt; \n#   summarise(average_percentage = mean(Percentage)) |&gt; \n#   ggplot(aes(x = Employment_Category, y = average_percentage))+\n#   geom_col()+\n#   facet_wrap(~most_common_race) +\n#   labs(title = \"Average Percentage of Population that Work in Different Employment Categories\", xlab = \"Employment Category\", ylab = \"Average Percentage\")+\n#   theme_minimal()\n#   \n\n\n\n\nCode\n# demographics |&gt; \n#   mutate(most_common_race = case_when(\n#     White &gt; Black & White &gt; Hispanic & White &gt;Native & White &gt;Pacific ~ \"White\",\n#     Black &gt; White & Black &gt; Hispanic & Black &gt; Native & Black &gt; Pacific ~ \"Black\",\n#     Hispanic &gt; White & Hispanic &gt; Black & Hispanic &gt; Native & Hispanic &gt; Pacific ~ \"Hispanic\",\n#     Native &gt; White & Native &gt; Black & Native &gt; Hispanic & Native &gt; Pacific ~ \"Native\",\n#     Pacific &gt; Black & Pacific &gt; White & Pacific &gt; Hispanic & Pacific &gt; Native ~ \"Pacific\"\n#   )) |&gt; \n#   select(Production, Construction, Office, Service, Professional, CountyId, most_common_race) |&gt; \n#    pivot_longer(cols = c(Production, Construction, Office, Service, Professional), names_to = \"Employment_Category\", values_to = \"Percentage\") |&gt;\n#   group_by(most_common_race, Employment_Category) |&gt;\n#   summarise(average_percentage = mean(Percentage)) |&gt;\n#   ggplot(aes(x = Employment_Category, y = average_percentage))+\n#   geom_col()+\n#   facet_wrap(~most_common_race) +\n#   labs(title = \"Average Percentage of Population that Work in Different Employment Categories\", xlab = \"Employment Category\", ylab = \"Average Percentage\")+\n#   theme_minimal()\n\n\n\n\nCode\n# demographics |&gt; \n#   mutate(most_common_race = case_when(\n#     White &gt; Black & White &gt; Hispanic & White &gt;Native & White &gt;Pacific ~ \"White\",\n#     Black &gt; White & Black &gt; Hispanic & Black &gt; Native & Black &gt; Pacific ~ \"Black\",\n#     Hispanic &gt; White & Hispanic &gt; Black & Hispanic &gt; Native & Hispanic &gt; Pacific ~ \"Hispanic\",\n#     Native &gt; White & Native &gt; Black & Native &gt; Hispanic & Native &gt; Pacific ~ \"Native\",\n#     Pacific &gt; Black & Pacific &gt; White & Pacific &gt; Hispanic & Pacific &gt; Native ~ \"Pacific\"\n#   )) |&gt; \n#   select(Poverty, CountyId, most_common_race) |&gt; \n#   group_by(most_common_race) |&gt;\n#   summarise(average_percentage_poverty = mean(Poverty)) |&gt;\n#   ggplot(aes(x = most_common_race, y = average_percentage_poverty))+\n#   geom_col()+\n#   labs(title = \"Percentage of Population in Poverty\")+\n#   theme_minimal()\n\n\n\n\nCode\n# demographics |&gt; \n#   mutate(most_common_race = case_when(\n#     White &gt; Black & White &gt; Hispanic & White &gt;Native & White &gt;Pacific ~ \"White\",\n#     Black &gt; White & Black &gt; Hispanic & Black &gt; Native & Black &gt; Pacific ~ \"Black\",\n#     Hispanic &gt; White & Hispanic &gt; Black & Hispanic &gt; Native & Hispanic &gt; Pacific ~ \"Hispanic\",\n#     Native &gt; White & Native &gt; Black & Native &gt; Hispanic & Native &gt; Pacific ~ \"Native\",\n#     Pacific &gt; Black & Pacific &gt; White & Pacific &gt; Hispanic & Pacific &gt; Native ~ \"Pacific\"\n#   )) |&gt; \n#   select(ChildPoverty, CountyId, most_common_race) |&gt; \n#   group_by(most_common_race) |&gt;\n#   summarise(average_percentage_Child_poverty = mean(ChildPoverty)) |&gt;\n#   ggplot(aes(x = most_common_race, y = average_percentage_Child_poverty))+\n#   geom_col()+\n#   labs(title = \"Percentage of Child Population in Poverty\")+\n#   theme_minimal()\n\n\n\n\nCode\n# demographics |&gt; \n#   mutate(most_common_race = case_when(\n#     White &gt; Black & White &gt; Hispanic & White &gt;Native & White &gt;Pacific ~ \"White\",\n#     Black &gt; White & Black &gt; Hispanic & Black &gt; Native & Black &gt; Pacific ~ \"Black\",\n#     Hispanic &gt; White & Hispanic &gt; Black & Hispanic &gt; Native & Hispanic &gt; Pacific ~ \"Hispanic\",\n#     Native &gt; White & Native &gt; Black & Native &gt; Hispanic & Native &gt; Pacific ~ \"Native\",\n#     Pacific &gt; Black & Pacific &gt; White & Pacific &gt; Hispanic & Pacific &gt; Native ~ \"Pacific\"\n#   )) |&gt; \n#   select(Drive, Carpool, Transit, Walk , OtherTransp, CountyId, most_common_race) |&gt; \n#    pivot_longer(cols = c(Drive, Carpool, Transit, Walk , OtherTransp), names_to = \"Transport_Type\", values_to = \"Percentage\") |&gt;\n#   group_by(most_common_race, Transport_Type) |&gt;\n#   summarise(average_percentage = mean(Percentage)) |&gt;\n#   ggplot(aes(x = Transport_Type, y = average_percentage))+\n#   geom_col()+\n#   facet_wrap(~most_common_race) +\n#   labs(title = \"Average Percentage of Population that get to Work Through Different Means\", xlab = \"Employment Category\", ylab = \"Average Percentage\")+\n#   theme_minimal()\n\n\n\n\nCode\n# names(acs_2023)[names(acs_2023) == 'ARKSE001'] &lt;- 'total_population'\n# names(acs_2023)[names(acs_2023) == 'ARKSE002'] &lt;- 'white_population'\n# names(acs_2023)[names(acs_2023) == 'ARKSE003'] &lt;- 'black_aferican_american'\n# names(acs_2023)[names(acs_2023) == 'ARKSE004'] &lt;- 'american_indian_alaska_native'\n# names(acs_2023)[names(acs_2023) == 'ARKSE005'] &lt;- 'asian_population'\n# names(acs_2023)[names(acs_2023) == 'ARKSE006'] &lt;- 'native_hawaiian_pacific_islander'\n# names(acs_2023)[names(acs_2023) == 'ARKSE007'] &lt;- 'other_population'\n# names(acs_2023)[names(acs_2023) == 'ARKSE008'] &lt;- 'two_or_more'\n# names(acs_2023)[names(acs_2023) == 'ARKSE009'] &lt;- 'two_or_more_not_other'\n# names(acs_2023)[names(acs_2023) == 'ARKSE010'] &lt;- 'two_or_more_other'\n# names(acs_2023)[names(acs_2023) == 'ART7E002'] &lt;- 'family_household'\n# names(acs_2023)[names(acs_2023) == 'ART7E003'] &lt;- 'married_couple_family'\n# names(acs_2023)[names(acs_2023) == 'ART7E004'] &lt;- 'other_family'\n# names(acs_2023)[names(acs_2023) == 'ART7E005'] &lt;- 'other_family_male_householder'\n# names(acs_2023)[names(acs_2023) == 'ART7E006'] &lt;- 'other_family_female_householder'\n# names(acs_2023)[names(acs_2023) == 'ART7E007'] &lt;- 'nonfamily_household'\n# names(acs_2023)[names(acs_2023) == 'ART7E008'] &lt;- 'householder_living_alone'\n# names(acs_2023)[names(acs_2023) == 'ART7E009'] &lt;- 'householder_not_alone'\n# names(acs_2023)[names(acs_2023) == 'ART7E001'] &lt;- 'total_households'\n# names(acs_2023)[names(acs_2023) == 'ARXXE002'] &lt;- 'no_schooling'\n# names(acs_2023)[names(acs_2023) == 'ARXXE003'] &lt;- 'nursery_4th'\n# names(acs_2023)[names(acs_2023) == 'ARXXE004'] &lt;- '5th_6th'\n# names(acs_2023)[names(acs_2023) == 'ARXXE005'] &lt;- '7th_8th'\n# names(acs_2023)[names(acs_2023) == 'ARXXE006'] &lt;- '9th_grade'\n# names(acs_2023)[names(acs_2023) == 'ARXXE007'] &lt;- '10th_grade'\n# names(acs_2023)[names(acs_2023) == 'ARXXE008'] &lt;- '11th_grade'\n# names(acs_2023)[names(acs_2023) == 'ARXXE009'] &lt;- '12th_grade_no_diploma'\n# names(acs_2023)[names(acs_2023) == 'ARXXE010'] &lt;- 'highschool_diploma'\n# names(acs_2023)[names(acs_2023) == 'ARXXE011'] &lt;- 'GED_or_alt'\n# names(acs_2023)[names(acs_2023) == 'ARXXE012'] &lt;- 'less_year_college'\n# names(acs_2023)[names(acs_2023) == 'ARXXE013'] &lt;- 'over_year_college_no_degree'\n# names(acs_2023)[names(acs_2023) == 'ARXXE014'] &lt;- 'associates_degree'\n# names(acs_2023)[names(acs_2023) == 'ARXXE015'] &lt;- 'bachelors_degree'\n# names(acs_2023)[names(acs_2023) == 'ARXXE016'] &lt;- 'masters_degree'\n# names(acs_2023)[names(acs_2023) == 'ARXXE017'] &lt;- 'professional_school_degree'\n# names(acs_2023)[names(acs_2023) == 'ARXXE018'] &lt;- 'doctorate_degree'\n# names(acs_2023)[names(acs_2023) == 'ARXXE001'] &lt;- 'total_over_25'\n# names(acs_2023)[names(acs_2023) == 'AR56E001'] &lt;- 'aggregate_yearly_income'\n# names(acs_2023)[names(acs_2023) == 'AR97E001'] &lt;- 'total_employed'\n# names(acs_2023)[names(acs_2023) == 'AR97E002'] &lt;- 'agriculture_forestry_fishing_hunting_mining'\n# names(acs_2023)[names(acs_2023) == 'AR97E003'] &lt;- 'construction'\n# names(acs_2023)[names(acs_2023) == 'AR97E004'] &lt;- 'manufacturing'\n# names(acs_2023)[names(acs_2023) == 'AR97E005'] &lt;- 'wholesale_trade'\n# names(acs_2023)[names(acs_2023) == 'AR97E006'] &lt;- 'retail_trade'\n# names(acs_2023)[names(acs_2023) == 'AR97E007'] &lt;- 'transportation_warehousing_utilities'\n# names(acs_2023)[names(acs_2023) == 'AR97E008'] &lt;- 'information_occupation'\n# names(acs_2023)[names(acs_2023) == 'AR97E009'] &lt;- 'finance_insurance_realestate_rental_leasing'\n# names(acs_2023)[names(acs_2023) == 'AR97E010'] &lt;- 'professional_scientific_management_administrative_wastemanagement'\n# names(acs_2023)[names(acs_2023) == 'AR97E011'] &lt;- 'educational_healthcare_socialassistance'\n# names(acs_2023)[names(acs_2023) == 'AR97E012'] &lt;- 'arts_entertainment_recreation_accommodation_food'\n# names(acs_2023)[names(acs_2023) == 'AR97E013'] &lt;- 'other_services_except_public_administration'\n# names(acs_2023)[names(acs_2023) == 'AR97E014'] &lt;- 'public_administration'\n# names(acs_2023)[names(acs_2023) == 'AR97E015'] &lt;- 'management_business_science_arts_occupations'\n# names(acs_2023)[names(acs_2023) == 'AR97E029'] &lt;- 'service_occupations'\n# names(acs_2023)[names(acs_2023) == 'AR97E043'] &lt;- 'sales_office_occupations'\n# names(acs_2023)[names(acs_2023) == 'AR97E057'] &lt;- 'naturalresources_construction_maintenance_occupations'\n# names(acs_2023)[names(acs_2023) == 'AR97E071'] &lt;- 'production_transportation_materialmoving_occupations'\n# acs_2023 &lt;- acs_2023 |&gt; \n#   select(contains(\"_\"))\n# \n# write.csv(acs_2023, \"..\\\\data\\\\processed\\\\acs_2023.csv\")\n\n\n\n\nCode\n# cleaned &lt;- read.csv(\"..\\\\data\\\\processed\\\\acs_2023.csv\")\n# acs_clean &lt;- cleaned |&gt; \n# mutate(subregion = tolower(str_remove(str_extract(NAME_E,\"((([A-Za-z]?)*\\\\.?)* ?)*\"),\" County\"))) |&gt;\n#   mutate(region =tolower(str_remove(str_extract(NAME_E,\"\\\\, ([A-Za-z]?)*\"), \", \"))) \n\n\n\n\nCode\n# library(maps)\n# library(mapdata)\n\n\n\n\nCode\n# us_counties &lt;- map_data(\"county\")\n# us_states&lt;- map_data(\"state\")\n\n\n\n\nCode\n# ggplot(data=acs_counties, aes(x=long, y=lat, fill=white_population, group=group)) + \n#   geom_polygon() + \n#   guides(fill=FALSE) + \n#   theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(),\n#         axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank()) + \n#   ggtitle('U.S. Map with States') + \n#   theme_minimal()\n\n\n\n\nCode\n# census_api_key &lt;- readLines(\"census_api_key.txt\")\n# get_acs1 &lt;- function(year,variables,key,include_moe = TRUE){\n#   new_variables &lt;- c()\n#   if(year &lt; 2005 | year &gt; 2022 | year == 2020){\n#   stop(\"year is not betwwen 2005 and 2022, or your year is  equal to 2022\")\n# }\n# else{\n#   Sys.sleep(0.5)\n#     if(include_moe == FALSE){\n#       for (i in seq_along(variables)){\n#         if(str_detect(variables[i],\"[0-9]\") == TRUE){\n#         new_variables[i] &lt;- variables[i] %&gt;% paste0(\"E\")\n#       }\n#       else{\n#         new_variables[i] &lt;- variables[i]\n#       }\n#       }\n#     }\n#     else{\n#       for(i in seq_along(variables)){\n#         if(str_detect(variables[i],\"[0-9]\") == TRUE){\n#           new_variables &lt;- c(new_variables,variables[i] %&gt;% paste0(\"E\"))\n#           new_variables &lt;- c(new_variables, variables[i] %&gt;% paste0(\"M\"))\n#         }\n#         else{\n#           new_variables &lt;- c(new_variables, variables[i])\n#         }\n#       }\n#     }\n#     request &lt;- request(\"https://api.census.gov\") |&gt; \n#     req_url_path_append(\"data\") |&gt; \n#     req_url_path_append(as.character(year)) |&gt; \n#     req_url_path_append(\"acs\") |&gt; \n#     req_url_path_append(\"acs5\") |&gt; \n#     req_url_query(get = new_variables, `for` = I(\"county:*\"), `in` = I(\"state:*\"), key = key, .multi = \"comma\")\n#     resp &lt;- req_perform(request)\n#     resp_json_df &lt;- resp |&gt; resp_body_json(simplifyVector = TRUE)\n# \n# # Data Cleaning\n# resp_json_df &lt;- janitor::row_to_names(resp_json_df, 1) |&gt; # Move 1st row to Names\n#   as.data.frame() |&gt;# Convert Matrix to Data Frame\n#   mutate(across(starts_with('B'), as.numeric)) # Convert all variables that start with B to numeric\n# return(resp_json_df)\n# }\n# }\n\n\n\n\nCode\n# library(tidycensus)\n# library(httr2)\n# v17 &lt;- load_variables(2021, \"acs5\", cache = TRUE)\n# View(v17)\n# test_acs&lt;- get_acs1(2021, c('B02001_002','B02001_001', 'NAME'), key = census_api_key, FALSE) |&gt; \n#   mutate(subregion = tolower(str_remove(str_extract(NAME,\"((([A-Za-z]?)*\\\\.?)* ?)*\"),\" County\"))) |&gt;\n#   mutate(region =tolower(str_remove(str_extract(NAME,\"\\\\, ([A-Za-z]?)*\"), \", \")))\n# \n# names(test_acs)[names(test_acs) == 'B02001_002E'] &lt;- 'white_population'\n\n\n\n\nCode\n# acs_counties &lt;- us_counties |&gt; \n#   left_join(test_acs)\n\n\n\n\nCode\n# ggplot() + \n#   geom_polygon(data=acs_counties, aes(x=long, y=lat, fill=white_population, group=group))+\n#   geom_polygon(data = us_states, aes(x=long, y = lat, group = group), color = 'white', fill = NA)+\n#   guides(fill=FALSE) + \n#   theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(),\n#         axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank()) + \n#   ggtitle('U.S. Map with States') + \n#   coord_fixed(1.3)+\n#   theme_minimal()\n\n\n\n\nCode\n# library(ggthemes)\n# library(ggspatial)\n# sanfransisco &lt;- get_acs(\n#   state = \"CA\",\n#   county = \"San Francisco\",\n#   geography = \"tract\",\n#   variables = \"B02001_002\",\n#   geometry = TRUE,\n#   year = 2021\n# ) |&gt;\n#   mutate(white_population = case_when(\n#     estimate &lt; 1000 ~ \"&lt; 1000\",\n#     estimate &gt;= 1000 & estimate &lt; 2000 ~ \"1000 to 1999\",\n#     estimate &gt;= 2000 & estimate &lt; 3000 ~ \"2000 to 2999\",\n#     estimate &gt;= 3000 & estimate &lt;=4000 ~ \"3000 to 4000\",\n#     estimate &gt; 4000 ~ \"&gt; 4000\"\n#   )) |&gt; \n#   mutate(white_population = fct_relevel(white_population, \"&gt; 4000\", after = Inf))\n# \n# sanfransisco_city &lt;- data.frame(lat = 37.7749, long = -122.4194, name = \"San Fransisco\")\n# \n# mesa_city &lt;- data.frame(lat = 33.4152, long = - 111.8315, name = \"Mesa\")\n# \n# Mesa &lt;- get_acs(\n#   state = \"AZ\",\n#   county = \"Maricopa\",\n#   geography = \"tract\",\n#   variables = \"B02001_002\",\n#   geometry = TRUE,\n#   year = 2021\n# ) |&gt;\n#   mutate(white_population = case_when(\n#     estimate &lt; 1000 ~ \"&lt; 1000\",\n#     estimate &gt;= 1000 & estimate &lt; 2000 ~ \"1000 to 1999\",\n#     estimate &gt;= 2000 & estimate &lt; 3000 ~ \"2000 to 2999\",\n#     estimate &gt;= 3000 & estimate &lt;=4000 ~ \"3000 to 4000\",\n#     estimate &gt; 4000 ~ \"&gt; 4000\"\n#   )) |&gt; \n#   mutate(white_population = fct_relevel(white_population, \"&gt; 4000\", after = Inf))\n# \n# mesa_race &lt;- \n#   get_acs(\n#   state = \"AZ\",\n#   county = \"Maricopa\",\n#   geography = \"tract\",\n#   variables = c(\"B02001_003\", \"B02001_004\", \"B02001_005\", \"B02001_006\",\"B02001_007\",\"B02001_008\"),\n#   geometry = TRUE,\n#   year = 2021\n# ) |&gt; \n#   group_by(NAME, geometry) |&gt; \n#   summarize(estimate = sum(estimate)) |&gt;\n#   mutate(minority_population = case_when(\n#     estimate &lt; 1000 ~ \"&lt; 1000\",\n#     estimate &gt;= 1000 & estimate &lt; 2000 ~ \"1000 to 1999\",\n#     estimate &gt;= 2000 & estimate &lt; 3000 ~ \"2000 to 2999\",\n#     estimate &gt;= 3000 & estimate &lt; 4000 ~ \"3000 to 3999\",\n#     estimate &gt;= 4000 & estimate &lt;= 5000 ~ \"4000 to 5000\",\n#     estimate &gt; 5000 ~ \"&gt; 5000\"\n#   )) |&gt; \n#   mutate(minority_population = fct_relevel(minority_population, \"&gt; 5000\", after = Inf))\n# \n# sanfransisco_race &lt;- \n#   get_acs(\n#   state = \"CA\",\n#   county = \"San Francisco\",\n#   geography = \"tract\",\n#   variables = c(\"B02001_003\", \"B02001_004\", \"B02001_005\", \"B02001_006\",\"B02001_007\",\"B02001_008\"),\n#   geometry = TRUE,\n#   year = 2021\n# ) |&gt; \n#   group_by(NAME, geometry) |&gt; \n#   summarize(estimate = sum(estimate)) |&gt;\n#   mutate(minority_population = case_when(\n#     estimate &lt; 1000 ~ \"&lt; 1000\",\n#     estimate &gt;= 1000 & estimate &lt; 2000 ~ \"1000 to 1999\",\n#     estimate &gt;= 2000 & estimate &lt; 3000 ~ \"2000 to 2999\",\n#     estimate &gt;= 3000 & estimate &lt; 4000 ~ \"3000 to 3999\",\n#     estimate &gt;= 4000 & estimate &lt;= 5000 ~ \"4000 to 5000\",\n#     estimate &gt; 5000 ~ \"&gt; 5000\"\n#   )) |&gt; \n#   mutate(minority_population = fct_relevel(minority_population, \"&gt; 5000\", after = Inf),\n#          minority_population = fct_relevel(minority_population, \"&lt; 1000\", after = 0))\n# \n# sanfransisco_family &lt;- \n#   get_acs(\n#   state = \"CA\",\n#   county = \"San Francisco\",\n#   geography = \"tract\",\n#   variables = \"B11001_007\",\n#   geometry = TRUE,\n#   year = 2021\n# ) |&gt;\n#   mutate(non_family_households = case_when(\n#     estimate &lt; 250 ~ \"&lt; 250\",\n#     estimate &gt;= 250 & estimate &lt; 500 ~ \"250 to 499\",\n#     estimate &gt;= 500 & estimate &lt; 750 ~ \"500 to 749\",\n#     estimate &gt;= 750 & estimate &lt; 1000 ~ \"750 to 999\",\n#     estimate &gt;= 1000 & estimate &lt;= 1500 ~ \"1000 to 1499\",\n#     estimate &gt;= 1500 & estimate &lt;= 2000 ~ \"1500 to 1999\",\n#     estimate &gt; 2000 ~ \"&gt; 2000\"\n#   )) |&gt; \n#   mutate(non_family_households = fct_relevel(non_family_households, \"&gt; 2000\", after = Inf),\n#          non_family_households = fct_relevel(non_family_households, \"&lt; 250\", after = 0),\n#          non_family_households = fct_relevel(non_family_households, \"1000 to 1499\", after = 5),\n#          non_family_households = fct_relevel(non_family_households, \"1500 to 1999\", after = 5))\n#   \n#   \n# \n# mesa_family &lt;- \n#   get_acs(\n#   state = \"AZ\",\n#   county = \"Maricopa\",\n#   geography = \"tract\",\n#   variables = \"B11001_007\",\n#   geometry = TRUE,\n#   year = 2021\n# ) |&gt;\n#   mutate(non_family_households = case_when(\n#     estimate &lt; 250 ~ \"&lt; 250\",\n#     estimate &gt;= 250 & estimate &lt; 500 ~ \"250 to 499\",\n#     estimate &gt;= 500 & estimate &lt; 750 ~ \"500 to 749\",\n#     estimate &gt;= 750 & estimate &lt; 1000 ~ \"750 to 999\",\n#     estimate &gt;= 1000 & estimate &lt;= 1500 ~ \"1000 to 1499\",\n#     estimate &gt;= 1500 & estimate &lt;= 2000 ~ \"1500 to 1999\",\n#     estimate &gt; 2000 ~ \"&gt; 2000\"\n#   )) |&gt; \n#   mutate(non_family_households = fct_relevel(non_family_households, \"&gt; 2000\", after = Inf),\n#          non_family_households = fct_relevel(non_family_households, \"&lt; 250\", after = 0),\n#          non_family_households = fct_relevel(non_family_households, \"1000 to 1499\", after = 5),\n#          non_family_households = fct_relevel(non_family_households, \"1500 to 1999\", after = 5))\n# \n# mesa_family_h &lt;- \n#   get_acs(\n#   state = \"AZ\",\n#   county = \"Maricopa\",\n#   geography = \"tract\",\n#   variables = \"B11001_002\",\n#   geometry = TRUE,\n#   year = 2021\n# )|&gt;\n#   mutate(family_households = case_when(\n#     estimate &lt; 250 ~ \"&lt; 250\",\n#     estimate &gt;= 250 & estimate &lt; 500 ~ \"250 to 499\",\n#     estimate &gt;= 500 & estimate &lt; 750 ~ \"500 to 749\",\n#     estimate &gt;= 750 & estimate &lt; 1000 ~ \"750 to 999\",\n#     estimate &gt;= 1000 & estimate &lt;= 1500 ~ \"1000 to 1499\",\n#     estimate &gt;= 1500 & estimate &lt;= 2000 ~ \"1500 to 1999\",\n#     estimate &gt; 2000 ~ \"&gt; 2000\"\n#   )) |&gt; \n#   mutate(family_households = fct_relevel(family_households, \"&gt; 2000\", after = Inf),\n#          family_households = fct_relevel(family_households, \"&lt; 250\", after = 0),\n#          family_households = fct_relevel(family_households, \"1000 to 1499\", after = 5),\n#          family_households = fct_relevel(family_households, \"1500 to 1999\", after = 5))\n# \n# sanfransisco_family_h &lt;- \n#   get_acs(\n#   state = \"CA\",\n#   county = \"San Francisco\",\n#   geography = \"tract\",\n#   variables = \"B11001_002\",\n#   geometry = TRUE,\n#   year = 2021\n# ) |&gt;\n#   mutate(family_households = case_when(\n#     estimate &lt; 250 ~ \"&lt; 250\",\n#     estimate &gt;= 250 & estimate &lt; 500 ~ \"250 to 499\",\n#     estimate &gt;= 500 & estimate &lt; 750 ~ \"500 to 749\",\n#     estimate &gt;= 750 & estimate &lt; 1000 ~ \"750 to 999\",\n#     estimate &gt;= 1000 & estimate &lt;= 1500 ~ \"1000 to 1499\",\n#     estimate &gt;= 1500 & estimate &lt;= 2000 ~ \"1500 to 1999\",\n#     estimate &gt; 2000 ~ \"&gt; 2000\"\n#   )) |&gt; \n#   mutate(family_households = fct_relevel(family_households, \"&gt; 2000\", after = Inf),\n#          family_households = fct_relevel(family_households, \"&lt; 250\", after = 0),\n#          family_households = fct_relevel(family_households, \"1000 to 1499\", after = 5),\n#          family_households = fct_relevel(family_households, \"1500 to 1999\", after = 5))\n# \n# sanfransisco_income &lt;- \n#   get_acs(\n#   state = \"CA\",\n#   county = \"San Francisco\",\n#   geography = \"tract\",\n#   variables = \"B07011_001\",\n#   geometry = TRUE,\n#   year = 2021\n# )\n# \n# mesa_income &lt;- \n#   get_acs(\n#   state = \"AZ\",\n#   county = \"Maricopa\",\n#   geography = \"tract\",\n#   variables = \"B07011_001\",\n#   geometry = TRUE,\n#   year = 2021\n# )\n\n\n\n\nCode\n  # ggplot() + \n  # geom_sf(data = sanfransisco, aes(fill = white_population), color = NA) +\n  # geom_point(data = sanfransisco_city, aes(x = long, y = lat), color = \"white\")+\n  # geom_label(data = sanfransisco_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = -0.25)+\n  # scale_fill_viridis_d(option = \"D\", name = \"White Population\") +\n  # scale_x_continuous(limits = c(-122.525, -122.35), expand = c(0, 0))+\n  # scale_y_continuous(limits = c(37.7, 37.84), expand = c(0,0))+\n  # ggtitle(\"San Fransicso County White Population Distribution\")+\n  # theme_map()+\n  # annotation_north_arrow(location = \"tr\",\n  #                        height = unit(0.8, \"cm\"),\n  #                        width = unit(0.8, \"cm\"),\n  #                        style = north_arrow_nautical())+\n  # annotation_scale(plot_unit = \"mi\")+\n  # theme(legend.position = c(0, 0.745),\n  #       legend.background = element_rect(fill=\"lightblue\",\n  #                                 linewidth =0.5, linetype=\"solid\", \n  #                                 colour =\"darkblue\"),\n  #       legend.text = element_text(size = 5),\n  #       legend.title = element_text(size = 7, face = \"bold\"),\n  #       legend.key.size = unit(0.35, \"cm\"),\n  #       )\n\n\n\n\nCode\n  # ggplot() + \n  # geom_sf(data = Mesa, aes(fill = white_population), color = NA) +\n  # scale_fill_viridis_d(option = \"D\", name = \"White Population\") +\n  # geom_point(data = mesa_city, aes(x = long, y = lat), color = \"white\", size = 2.5)+\n  # geom_label(data = mesa_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = -0.25)+\n  # ggtitle(\"Maricopa County White Population Distribution\")+\n  # theme_map()+\n  # annotation_north_arrow(location = \"tr\",\n  #                        height = unit(0.8, \"cm\"),\n  #                        width = unit(0.8, \"cm\"),\n  #                        style = north_arrow_nautical())+\n  # annotation_scale(plot_unit = \"mi\",\n  #                  location = \"br\")+\n  # theme(legend.position = c(0.76, 0.20),\n  #       legend.background = element_rect(fill=\"lightblue\",\n  #                                 linewidth =0.5, linetype=\"solid\", \n  #                                 colour =\"darkblue\"),\n  #       legend.text = element_text(size = 5),\n  #       legend.title = element_text(size = 7, face = \"bold\"),\n  #       legend.key.size = unit(0.35, \"cm\"),\n  #       )\n\n\n\n\nCode\n# ggplot() + \n#   geom_sf(data = mesa_race, aes(fill = minority_population), color = NA) +\n#   scale_fill_viridis_d(option = \"D\", name = \"Minority Population\") +\n#   geom_point(data = mesa_city, aes(x = long, y = lat), color = \"white\", size = 2.5)+\n#   geom_label(data = mesa_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = 1.35)+\n#   ggtitle(\"Maricopa County Minority Population Distribution\")+\n#   theme_map()+\n#   annotation_north_arrow(location = \"tr\",\n#                          height = unit(0.8, \"cm\"),\n#                          width = unit(0.8, \"cm\"),\n#                          style = north_arrow_nautical())+\n#   annotation_scale(plot_unit = \"mi\",\n#                    location = \"br\")+\n#   theme(legend.position = c(0.76, 0.20),\n#         legend.background = element_rect(fill=\"lightblue\",\n#                                   linewidth =0.5, linetype=\"solid\", \n#                                   colour =\"darkblue\"),\n#         legend.text = element_text(size = 5),\n#         legend.title = element_text(size = 7, face = \"bold\"),\n#         legend.key.size = unit(0.35, \"cm\"),\n#         )\n\n\n\n\nCode\n  ggplot() + \n  geom_sf(data = sanfransisco_race, aes(fill = minority_population), color = NA) +\n  geom_point(data = sanfransisco_city, aes(x = long, y = lat), color = \"white\")+\n  geom_label(data = sanfransisco_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = -0.25)+\n  scale_fill_viridis_d(option = \"D\", name = \"Minority Population\") +\n  scale_x_continuous(limits = c(-122.525, -122.35), expand = c(0, 0))+\n  scale_y_continuous(limits = c(37.7, 37.84), expand = c(0,0))+\n  ggtitle(\"San Fransicso County Minority Population Distribution\")+\n  theme_map()+\n  annotation_north_arrow(location = \"tr\",\n                         height = unit(0.8, \"cm\"),\n                         width = unit(0.8, \"cm\"),\n                         style = north_arrow_nautical())+\n  annotation_scale(plot_unit = \"mi\")+\n  theme(legend.position = c(0, 0.745),\n        legend.background = element_rect(fill=\"lightblue\",\n                                  linewidth =0.5, linetype=\"solid\", \n                                  colour =\"darkblue\"),\n        legend.text = element_text(size = 5),\n        legend.title = element_text(size = 7, face = \"bold\"),\n        legend.key.size = unit(0.35, \"cm\"),\n        )\n\n\n\n\nCode\nggplot() + \n  geom_sf(data = sanfransisco_family, aes(fill = non_family_households), color = NA) +\n  geom_point(data = sanfransisco_city, aes(x = long, y = lat), color = \"white\")+\n  geom_label(data = sanfransisco_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = -0.25)+\n  scale_fill_viridis_d(option = \"D\", name = \"Non-family Housholds\") +\n  scale_x_continuous(limits = c(-122.525, -122.35), expand = c(0, 0))+\n  scale_y_continuous(limits = c(37.7, 37.84), expand = c(0,0))+\n  ggtitle(\"San Fransicso County Non-family Housholds Distribution\")+\n  theme_map()+\n  annotation_north_arrow(location = \"tr\",\n                         height = unit(0.8, \"cm\"),\n                         width = unit(0.8, \"cm\"),\n                         style = north_arrow_nautical())+\n  annotation_scale(plot_unit = \"mi\")+\n  theme(legend.position = c(0, 0.745),\n        legend.background = element_rect(fill=\"lightblue\",\n                                  linewidth =0.5, linetype=\"solid\", \n                                  colour =\"darkblue\"),\n        legend.text = element_text(size = 5),\n        legend.title = element_text(size = 7, face = \"bold\"),\n        legend.key.size = unit(0.35, \"cm\"),\n        )\n\n\n\n\nCode\nggplot() + \n  geom_sf(data = mesa_family, aes(fill = non_family_households), color = NA) +\n  scale_fill_viridis_d(option = \"D\", name = \"Non-family Households\") +\n  geom_point(data = mesa_city, aes(x = long, y = lat), color = \"white\", size = 2.5)+\n  geom_label(data = mesa_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = 1.35)+\n  ggtitle(\"Maricopa County Non-family Households Distribution\")+\n  theme_map()+\n  annotation_north_arrow(location = \"tr\",\n                         height = unit(0.8, \"cm\"),\n                         width = unit(0.8, \"cm\"),\n                         style = north_arrow_nautical())+\n  annotation_scale(plot_unit = \"mi\",\n                   location = \"br\")+\n  theme(legend.position = c(0.76, 0.20),\n        legend.background = element_rect(fill=\"lightblue\",\n                                  linewidth =0.5, linetype=\"solid\", \n                                  colour =\"darkblue\"),\n        legend.text = element_text(size = 5),\n        legend.title = element_text(size = 7, face = \"bold\"),\n        legend.key.size = unit(0.35, \"cm\"),\n        )\n\n\n\n\nCode\n# ggplot() + \n#   geom_sf(data = sanfransisco_family_h, aes(fill = family_households), color = NA) +\n#   geom_point(data = sanfransisco_city, aes(x = long, y = lat), color = \"white\")+\n#   geom_label(data = sanfransisco_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = -0.25)+\n#   scale_fill_viridis_d(option = \"D\", name = \"Family Housholds\") +\n#   scale_x_continuous(limits = c(-122.525, -122.35), expand = c(0, 0))+\n#   scale_y_continuous(limits = c(37.7, 37.84), expand = c(0,0))+\n#   ggtitle(\"San Fransicso County Family Housholds Distribution\")+\n#   theme_map()+\n#   annotation_north_arrow(location = \"tr\",\n#                          height = unit(0.8, \"cm\"),\n#                          width = unit(0.8, \"cm\"),\n#                          style = north_arrow_nautical())+\n#   annotation_scale(plot_unit = \"mi\")+\n#   theme(legend.position = c(0, 0.745),\n#         legend.background = element_rect(fill=\"lightblue\",\n#                                   linewidth =0.5, linetype=\"solid\", \n#                                   colour =\"darkblue\"),\n#         legend.text = element_text(size = 5),\n#         legend.title = element_text(size = 7, face = \"bold\"),\n#         legend.key.size = unit(0.35, \"cm\"),\n#         )\n\n\n\n\nCode\n# ggplot() + \n#   geom_sf(data = mesa_family_h, aes(fill = family_households), color = NA) +\n#   scale_fill_viridis_d(option = \"D\", name = \"Family Households\") +\n#   geom_point(data = mesa_city, aes(x = long, y = lat), color = \"white\", size = 2.5)+\n#   geom_label(data = mesa_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = 1.35)+\n#   ggtitle(\"Maricopa County Family Households Distribution\")+\n#   theme_map()+\n#   annotation_north_arrow(location = \"tr\",\n#                          height = unit(0.8, \"cm\"),\n#                          width = unit(0.8, \"cm\"),\n#                          style = north_arrow_nautical())+\n#   annotation_scale(plot_unit = \"mi\",\n#                    location = \"br\")+\n#   theme(legend.position = c(0.76, 0.20),\n#         legend.background = element_rect(fill=\"lightblue\",\n#                                   linewidth =0.5, linetype=\"solid\", \n#                                   colour =\"darkblue\"),\n#         legend.text = element_text(size = 5),\n#         legend.title = element_text(size = 7, face = \"bold\"),\n#         legend.key.size = unit(0.35, \"cm\"),\n#         )\n\n\n\n\nCode\n# ggplot() + \n#   geom_sf(data = mesa_income, aes(fill = estimate), color = NA) +\n#   scale_fill_viridis_c(option = \"D\", name = \"Median Income\") +\n#   geom_point(data = mesa_city, aes(x = long, y = lat), color = \"white\", size = 2.5)+\n#   geom_label(data = mesa_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = 1.35)+\n#   ggtitle(\"Maricopa County Median Income Distribution\")+\n#   theme_map()+\n#   annotation_north_arrow(location = \"tr\",\n#                          height = unit(0.8, \"cm\"),\n#                          width = unit(0.8, \"cm\"),\n#                          style = north_arrow_nautical())+\n#   annotation_scale(plot_unit = \"mi\",\n#                    location = \"br\")+\n#   theme(legend.position = c(0.76, 0.20),\n#         legend.background = element_rect(fill=\"lightblue\",\n#                                   linewidth =0.5, linetype=\"solid\", \n#                                   colour =\"darkblue\"),\n#         legend.text = element_text(size = 5),\n#         legend.title = element_text(size = 7, face = \"bold\"),\n#         legend.key.size = unit(0.35, \"cm\"),\n#         )\n\n\n\n\nCode\n# ggplot() + \n#   geom_sf(data = sanfransisco_income, aes(fill = estimate), color = NA) +\n#   geom_point(data = sanfransisco_city, aes(x = long, y = lat), color = \"white\")+\n#   geom_label(data = sanfransisco_city, aes(x = long, y = lat, label = name), hjust = -0.04, vjust = -0.25)+\n#   scale_fill_viridis_c(option = \"D\", name = \"Median Income\") +\n#   scale_x_continuous(limits = c(-122.525, -122.35), expand = c(0, 0))+\n#   scale_y_continuous(limits = c(37.7, 37.84), expand = c(0,0))+\n#   ggtitle(\"San Fransicso County Median Income Distribution\")+\n#   theme_map()+\n#   annotation_north_arrow(location = \"tr\",\n#                          height = unit(0.8, \"cm\"),\n#                          width = unit(0.8, \"cm\"),\n#                          style = north_arrow_nautical())+\n#   annotation_scale(plot_unit = \"mi\")+\n#   theme(legend.position = c(0, 0.745),\n#         legend.background = element_rect(fill=\"lightblue\",\n#                                   linewidth =0.5, linetype=\"solid\", \n#                                   colour =\"darkblue\"),\n#         legend.text = element_text(size = 5),\n#         legend.title = element_text(size = 7, face = \"bold\"),\n#         legend.key.size = unit(0.35, \"cm\"),\n#         )\n\n\n\n\nCode\n# loading libraries\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(tidycensus) # Getting our data\nlibrary(ggthemes)\nlibrary(grid) # For mapping inset graphs\nlibrary(classInt) # Making breaks\nlibrary(ggspatial) # For adding map annotations\n\n\n\n\nCode\n# Getting our data\n# We are making a function to streamline our data collection from tidy census\n\nget_data &lt;- function(city, variable_list){\n  if(city == \"San Francisco\"){\n    return(get_acs(\n      state = \"CA\",\n      county = \"San Francisco\",\n      geography = \"tract\",\n      variables = variable_list,\n      geometry = TRUE,\n      year = 2021\n    )\n    )\n  }\n  else{\n    return(get_acs(\n      state = \"AZ\",\n      county = \"Maricopa\",\n      geography = \"tract\",\n      variables = variable_list,\n      geometry = TRUE,\n      year = 2021\n    )\n    )\n  }\n}\n\n# Getting all the San Francisco data we need\n# Data for percent of San Francisco population that is white\nsanfrancisco_white_population &lt;- get_data(city = \"San Francisco\", variable_list = c(\"B02001_001\", \"B02001_002\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B02001_001\" ~ \"total_population\",\n                              variable == \"B02001_002\" ~ \"white_population\"\n                              )\n         ) %&gt;% \n  pivot_wider(names_from = variable, values_from = estimate) %&gt;% \n  mutate(total_population = as.numeric(paste(total_population)),\n         white_population = as.numeric(paste(white_population)),\n         percent = white_population / total_population)\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |============                                                          |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |======================================================================| 100%\n\n\nCode\n# Data for percent of San Francisco population that is minority(not white)\nsanfrancisco_minority &lt;- get_data(city = \"San Francisco\", variable_list = c(\"B02001_001\", \"B02001_003\", \"B02001_004\", \"B02001_005\", \"B02001_006\", \"B02001_007\", \"B02001_008\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B02001_001\" ~ \"total_population\",\n                              variable == \"B02001_003\" ~ \"black_african_american\",\n                              variable == \"B02001_004\" ~ \"native_american\",\n                              variable == \"B02001_005\" ~ \"asian\",\n                              variable == \"B02001_006\" ~ \"pacific_islander\",\n                              variable == \"B02001_007\" ~ \"other\",\n                              variable == \"B02001_008\" ~ \"two_or_more\"\n                              )\n         ) %&gt;% \n  pivot_wider(names_from = variable, values_from = estimate) %&gt;% \n  mutate(total_population = as.numeric(paste(total_population)),\n         black_african_american = as.numeric(paste(black_african_american)),\n         native_american = as.numeric(paste(native_american)),\n         asian = as.numeric(paste(asian)),\n         pacific_islander = as.numeric(paste(pacific_islander)),\n         other= as.numeric(paste(other)),\n         two_or_more = as.numeric(paste(two_or_more)),\n         total_minority = black_african_american + native_american + asian + pacific_islander + other + two_or_more,\n         percent = total_minority/total_population\n        )\n\n# Data for Family Households in San Francisco\nsanfrancisco_familyhousehold &lt;- get_data(city = \"San Francisco\", variable_list = c(\"B11001_001\", \"B11001_002\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B11001_001\" ~ \"total_households\",\n                              variable == \"B11001_002\" ~ \"family_households\",\n                              )\n         ) %&gt;%\n  pivot_wider(names_from = variable, values_from = estimate) %&gt;%\n  mutate(total_households = as.numeric(paste(total_households)),\n         family_households = as.numeric(paste(family_households)),\n         percent = family_households/total_households)\n\n# Data for Non-family Households in San Francisco\nsanfrancisco_nonfamilyhousehold &lt;- get_data(city = \"San Francisco\", variable_list = c(\"B11001_001\", \"B11001_007\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B11001_001\" ~ \"total_households\",\n                              variable == \"B11001_007\" ~ \"nonfamily_households\",\n                              )\n         ) %&gt;%\n  pivot_wider(names_from = variable, values_from = estimate) %&gt;%\n  mutate(total_households = as.numeric(paste(total_households)),\n         nonfamily_households = as.numeric(paste(nonfamily_households)),\n         percent = nonfamily_households/total_households)\n\n# Data for median income in San Francisco\nsanfrancisco_income &lt;- get_data(city = \"San Francisco\", variable_list = \"B07011_001\") %&gt;% \n  select(geometry,variable,estimate) %&gt;%\n  mutate(variable = case_when(\n                              variable == \"B07011_001\" ~ \"median_income\"\n                              )\n  ) %&gt;% \n  pivot_wider(names_from = variable, values_from = estimate) %&gt;%\n  mutate(median_income = as.numeric(paste(median_income)))\n\n# Data for highest level of education in San Francisco\nsanfrancisco_education &lt;- get_data(city = \"San Francisco\", variable_list = c(\"B15003_002\", \"B15003_003\", \"B15003_004\", \"B15003_005\", \"B15003_006\", \"B15003_007\", \"B15003_008\", \"B15003_009\", \"B15003_010\", \"B15003_011\", \"B15003_012\", \"B15003_013\", \"B15003_014\", \"B15003_015\", \"B15003_016\", \"B15003_017\", \"B15003_018\", \"B15003_019\", \"B15003_020\", \"B15003_021\", \"B15003_022\", \"B15003_023\", \"B15003_024\", \"B15003_025\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B15003_002\" ~ \"none\",\n                              variable == \"B15003_003\" ~ \"pre_highschool\",\n                              variable == \"B15003_004\" ~ \"pre_highschool\",\n                              variable == \"B15003_005\" ~ \"pre_highschool\",\n                              variable == \"B15003_006\" ~ \"pre_highschool\",\n                              variable == \"B15003_007\" ~ \"pre_highschool\",\n                              variable == \"B15003_008\" ~ \"pre_highschool\",\n                              variable == \"B15003_009\" ~ \"pre_highschool\",\n                              variable == \"B15003_009\" ~ \"pre_highschool\",\n                              variable == \"B15003_010\" ~ \"pre_highschool\",\n                              variable == \"B15003_011\" ~ \"pre_highschool\",\n                              variable == \"B15003_012\" ~ \"pre_highschool\",\n                              variable == \"B15003_013\" ~ \"pre_highschool\",\n                              variable == \"B15003_014\" ~ \"pre_highschool\",\n                              variable == \"B15003_015\" ~ \"pre_highschool\",\n                              variable == \"B15003_016\" ~ \"pre_highschool\",\n                              variable == \"B15003_017\" ~ \"highschool_or_equivalent\",\n                              variable == \"B15003_018\" ~ \"highschool_or_equivalent\",\n                              variable == \"B15003_019\" ~ \"some_college\",\n                              variable == \"B15003_020\" ~ \"some_college\",\n                              variable == \"B15003_021\" ~ \"undergraduate\",\n                              variable == \"B15003_022\" ~ \"undergraduate\",\n                              variable == \"B15003_023\" ~ \"undergraduate\",\n                              variable == \"B15003_024\" ~ \"graduate\",\n                              variable == \"B15003_025\" ~ \"graduate\"\n                              )\n         )%&gt;% \n  pivot_wider(names_from = variable, values_from = estimate) %&gt;% \n  mutate(none = as.numeric(paste(none)),\n         pre_highschool = as.numeric(paste(lapply(pre_highschool, sum))),\n         highschool_or_equivalent = as.numeric(paste(lapply(highschool_or_equivalent, sum))),\n         some_college = as.numeric(paste(lapply(some_college, sum))),\n         undergraduate = as.numeric(paste(lapply(undergraduate, sum))),\n         graduate = as.numeric(paste(lapply(graduate, sum))),\n         majority_educated = case_when(\n                                      none &gt; pre_highschool & none &gt; highschool_or_equivalent & none &gt; some_college & none &gt; undergraduate & none &gt; graduate ~ \"None\",\n                                      pre_highschool &gt; none & pre_highschool &gt; highschool_or_equivalent & pre_highschool &gt; some_college & pre_highschool &gt; undergraduate & pre_highschool &gt;graduate ~ \"Pre-highschool\",\n                                      highschool_or_equivalent &gt; none & highschool_or_equivalent &gt; pre_highschool & highschool_or_equivalent &gt; some_college & highschool_or_equivalent &gt; undergraduate & highschool_or_equivalent &gt; graduate ~ \"Highschool or Equivalent\",\n                                      some_college &gt; none & some_college &gt; pre_highschool & some_college &gt; highschool_or_equivalent & some_college &gt; undergraduate & some_college &gt; graduate ~ \"Some College\",\n                                      undergraduate &gt; none & undergraduate &gt; pre_highschool & undergraduate &gt; highschool_or_equivalent & undergraduate &gt; some_college & undergraduate &gt; graduate ~ \"Undergraduate Degree\",\n                                      graduate &gt; none & graduate &gt; pre_highschool & graduate &gt; highschool_or_equivalent & graduate &gt; some_college & graduate &gt; undergraduate ~ \"graduate\"\n                                      )\n         )\n\n# Data for percent of Mesa population that is white\nmesa_white_population &lt;- get_data(city = \"Mesa\", variable_list = c(\"B02001_001\", \"B02001_002\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B02001_001\" ~ \"total_population\",\n                              variable == \"B02001_002\" ~ \"white_population\"\n                              )\n         ) %&gt;% \n  pivot_wider(names_from = variable, values_from = estimate) %&gt;% \n  mutate(total_population = as.numeric(paste(total_population)),\n         white_population = as.numeric(paste(white_population)),\n         percent = white_population / total_population)\n\n\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |======================================================================| 100%\n\n\nCode\n# Data for percent of Mesa population that is minority(not white)\nmesa_minority &lt;- get_data(city = \"Mesa\", variable_list = c(\"B02001_001\", \"B02001_003\", \"B02001_004\", \"B02001_005\", \"B02001_006\", \"B02001_007\", \"B02001_008\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B02001_001\" ~ \"total_population\",\n                              variable == \"B02001_003\" ~ \"black_african_american\",\n                              variable == \"B02001_004\" ~ \"native_american\",\n                              variable == \"B02001_005\" ~ \"asian\",\n                              variable == \"B02001_006\" ~ \"pacific_islander\",\n                              variable == \"B02001_007\" ~ \"other\",\n                              variable == \"B02001_008\" ~ \"two_or_more\"\n                              )\n         ) %&gt;% \n  pivot_wider(names_from = variable, values_from = estimate) %&gt;% \n  mutate(total_population = as.numeric(paste(total_population)),\n         black_african_american = as.numeric(paste(black_african_american)),\n         native_american = as.numeric(paste(native_american)),\n         asian = as.numeric(paste(asian)),\n         pacific_islander = as.numeric(paste(pacific_islander)),\n         other= as.numeric(paste(other)),\n         two_or_more = as.numeric(paste(two_or_more)),\n         total_minority = black_african_american + native_american + asian + pacific_islander + other + two_or_more,\n         percent = total_minority/total_population\n        )\n\n# Data for Family Households in Mesa\nmesa_familyhousehold &lt;- get_data(city = \"Mesa\", variable_list = c(\"B11001_001\", \"B11001_002\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B11001_001\" ~ \"total_households\",\n                              variable == \"B11001_002\" ~ \"family_households\",\n                              )\n         ) %&gt;%\n  pivot_wider(names_from = variable, values_from = estimate) %&gt;%\n  mutate(total_households = as.numeric(paste(total_households)),\n         family_households = as.numeric(paste(family_households)),\n         percent = family_households/total_households)\n\n# Data for Non-family Households in Mesa\nmesa_nonfamilyhousehold &lt;- get_data(city = \"Mesa\", variable_list = c(\"B11001_001\", \"B11001_007\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B11001_001\" ~ \"total_households\",\n                              variable == \"B11001_007\" ~ \"nonfamily_households\",\n                              )\n         ) %&gt;%\n  pivot_wider(names_from = variable, values_from = estimate) %&gt;%\n  mutate(total_households = as.numeric(paste(total_households)),\n         nonfamily_households = as.numeric(paste(nonfamily_households)),\n         percent = nonfamily_households/total_households)\n\n# Data for median income in Mesa\nmesa_income &lt;- get_data(city = \"Mesa\", variable_list = \"B07011_001\") %&gt;% \n  select(geometry,variable,estimate) %&gt;%\n  mutate(variable = case_when(\n                              variable == \"B07011_001\" ~ \"median_income\"\n                              )\n  ) %&gt;% \n  pivot_wider(names_from = variable, values_from = estimate) %&gt;%\n  mutate(median_income = as.numeric(paste(median_income)))\n\n# Data for highest level of education in Mesa\nmesa_education &lt;- get_data(city = \"Mesa\", variable_list = c(\"B15003_002\", \"B15003_003\", \"B15003_004\", \"B15003_005\", \"B15003_006\", \"B15003_007\", \"B15003_008\", \"B15003_009\", \"B15003_010\", \"B15003_011\", \"B15003_012\", \"B15003_013\", \"B15003_014\", \"B15003_015\", \"B15003_016\", \"B15003_017\", \"B15003_018\", \"B15003_019\", \"B15003_020\", \"B15003_021\", \"B15003_022\", \"B15003_023\", \"B15003_024\", \"B15003_025\")) %&gt;% \n  select(geometry,variable,estimate) %&gt;% \n  mutate(variable = case_when(\n                              variable == \"B15003_002\" ~ \"none\",\n                              variable == \"B15003_003\" ~ \"pre_highschool\",\n                              variable == \"B15003_004\" ~ \"pre_highschool\",\n                              variable == \"B15003_005\" ~ \"pre_highschool\",\n                              variable == \"B15003_006\" ~ \"pre_highschool\",\n                              variable == \"B15003_007\" ~ \"pre_highschool\",\n                              variable == \"B15003_008\" ~ \"pre_highschool\",\n                              variable == \"B15003_009\" ~ \"pre_highschool\",\n                              variable == \"B15003_009\" ~ \"pre_highschool\",\n                              variable == \"B15003_010\" ~ \"pre_highschool\",\n                              variable == \"B15003_011\" ~ \"pre_highschool\",\n                              variable == \"B15003_012\" ~ \"pre_highschool\",\n                              variable == \"B15003_013\" ~ \"pre_highschool\",\n                              variable == \"B15003_014\" ~ \"pre_highschool\",\n                              variable == \"B15003_015\" ~ \"pre_highschool\",\n                              variable == \"B15003_016\" ~ \"pre_highschool\",\n                              variable == \"B15003_017\" ~ \"highschool_or_equivalent\",\n                              variable == \"B15003_018\" ~ \"highschool_or_equivalent\",\n                              variable == \"B15003_019\" ~ \"some_college\",\n                              variable == \"B15003_020\" ~ \"some_college\",\n                              variable == \"B15003_021\" ~ \"undergraduate\",\n                              variable == \"B15003_022\" ~ \"undergraduate\",\n                              variable == \"B15003_023\" ~ \"undergraduate\",\n                              variable == \"B15003_024\" ~ \"graduate\",\n                              variable == \"B15003_025\" ~ \"graduate\"\n                              )\n         )%&gt;% \n  pivot_wider(names_from = variable, values_from = estimate) %&gt;% \n  mutate(none = as.numeric(paste(none)),\n         pre_highschool = as.numeric(paste(lapply(pre_highschool, sum))),\n         highschool_or_equivalent = as.numeric(paste(lapply(highschool_or_equivalent, sum))),\n         some_college = as.numeric(paste(lapply(some_college, sum))),\n         undergraduate = as.numeric(paste(lapply(undergraduate, sum))),\n         graduate = as.numeric(paste(lapply(graduate, sum))),\n         majority_educated = case_when(\n                                      none &gt; pre_highschool & none &gt; highschool_or_equivalent & none &gt; some_college & none &gt; undergraduate & none &gt; graduate ~ \"None\",\n                                      pre_highschool &gt; none & pre_highschool &gt; highschool_or_equivalent & pre_highschool &gt; some_college & pre_highschool &gt; undergraduate & pre_highschool &gt;graduate ~ \"Pre-highschool\",\n                                      highschool_or_equivalent &gt; none & highschool_or_equivalent &gt; pre_highschool & highschool_or_equivalent &gt; some_college & highschool_or_equivalent &gt; undergraduate & highschool_or_equivalent &gt; graduate ~ \"Highschool or Equivalent\",\n                                      some_college &gt; none & some_college &gt; pre_highschool & some_college &gt; highschool_or_equivalent & some_college &gt; undergraduate & some_college &gt; graduate ~ \"Some College\",\n                                      undergraduate &gt; none & undergraduate &gt; pre_highschool & undergraduate &gt; highschool_or_equivalent & undergraduate &gt; some_college & undergraduate &gt; graduate ~ \"Undergraduate Degree\",\n                                      graduate &gt; none & graduate &gt; pre_highschool & graduate &gt; highschool_or_equivalent & graduate &gt; some_college & graduate &gt; undergraduate ~ \"graduate\"\n                                      )\n         )\n\n# City Locations \nsanfransisco_city &lt;- data.frame(lat = 37.7749, long = -122.4194, name = \"San Fransisco\")\n\nmesa_city &lt;- data.frame(lat = 33.4152, long = - 111.8315, name = \"Mesa\")\n\n\n\n\nCode\n# For breaks we will use the Jenk's Natural Intervals method. This will help us create more natural intervals where the variance in each interval is minimized while the variance between intervals is maximized.\n\n# Since we want the maps to have the same breaks, we are going to combine our data to better create breaks that can be used across datasets\n\n# Making the breaks for white population maps\nwhite_data &lt;- rbind(sanfrancisco_white_population, mesa_white_population)\n\nwhite_ni &lt;- classIntervals(white_data$percent,\n                              n = 5,\n                              style = \"jenks\"\n                              )$brks\n\nwhite_labels &lt;- c()\n\nfor (i in seq_along(white_ni)){\n  white_labels &lt;- c(\n      white_labels, paste0(\n        round(white_ni[i],3)*100,\n        \"% to \", \n        round(white_ni[i+1],3)*100,\n        \"%\"\n      )\n  )\n}\n\nwhite_labels &lt;- white_labels[1:length(white_labels)-1]\n\nsanfrancisco_white_population$cat &lt;- cut(\n  sanfrancisco_white_population$percent, \n  breaks = white_ni,\n  labels = white_labels,\n  include.lowest = TRUE\n)\n\nmesa_white_population$cat &lt;- cut(\n  mesa_white_population$percent, \n  breaks = white_ni,\n  labels = white_labels,\n  include.lowest = TRUE\n)\n\n\n\n\nCode\n# Making a function to make maps of San Francisco\nmake_sanfrancisco &lt;- function(data, variable, title_text, legend_name, colors){\n  ggplot()+\n  geom_sf(data = data,\n          aes(fill = variable),\n          color = \"black\",\n          size = 0.5\n          )+\n  scale_x_continuous(limits = c(-122.5, -122.4), \n                     expand = c(0, 0)\n                     )+\n  scale_y_continuous(limits = c(37.7, 37.84), \n                     expand = c(0,0)\n                     )+\n  scale_fill_manual(\n    name = legend_name,\n    values = colors\n  )+\n  guides(\n    fill = guide_legend(\n      direction = \"horizontal\",\n      keyheight = unit(2, \"mm\"),\n      keywidth = unit(13, \"mm\"),\n      title.position = \"top\",\n      label.position = \"bottom\",\n      title.hjust = 0.5,\n      label.hjust = 0.5,\n      nrow = 1,\n      byrow = TRUE,\n    )\n  )+\n  labs(\n    title = title_text\n  )+\n  theme_void()+\n  annotation_north_arrow(location = \"tl\",\n                         pad_x = unit(0, \"cm\"),\n                         pad_y = unit(3.25, \"cm\"),\n                         height = unit(0.8, \"cm\"),\n                         width = unit(0.8, \"cm\"),\n                         style = north_arrow_nautical())+\n  annotation_scale(plot_unit = \"mi\",\n                   location = \"br\",\n                   pad_x = unit(-4, \"cm\"),\n                   pad_y = unit(6.5, \"cm\"))+\n  coord_sf(clip = \"off\")+\n  theme(\n    legend.position = c(0.65,-0.023),\n    plot.title = element_text(\n                              size = 15.75,\n                              vjust = -12,\n                              hjust = 0.5\n                              ),\n    plot.margin = margin(1, 1, 3, 1, \"cm\")\n  )\n}\n\n\n# Testing with San Francisco White Population Map\ncols &lt;- c(\"#edf8fb\", \"#b2e2e2\",\"#66c2a4\",\"#2ca25f\",\"#006d2c\")\n\nmake_sanfrancisco(data = sanfrancisco_white_population, variable = sanfrancisco_white_population$cat, title_text =  \"San Francisco White Population Density 2021\", legend_name = \"% of Population that is White\", colors = cols)\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Making a function that makes maps of Maricopa Country\nmake_mesa &lt;- function(data, variable, title_text, legend_name, colors){\n  ggplot()+\n  geom_sf(data = data,\n          aes(fill = variable),\n          color = \"black\",\n          size = 0.5)+\n  scale_fill_manual(\n    name = legend_name,\n    values = colors)+\n  guides(\n    fill = guide_legend(\n      direction = \"horizontal\",\n      keyheight = unit(2, \"mm\"),\n      keywidth = unit(13, \"mm\"),\n      title.position = \"top\",\n      label.position = \"bottom\",\n      title.hjust = 0.5,\n      label.hjust = 0.5,\n      nrow = 1,\n      byrow = TRUE))+\n  labs(\n    title = title_text\n  )+\n  theme_void()+\n  annotation_north_arrow(location = \"tr\",\n                         pad_x = unit(1.5, \"cm\"),\n                         pad_y = unit(1.5, \"cm\"),\n                         height = unit(0.8, \"cm\"),\n                         width = unit(0.8, \"cm\"),\n                         style = north_arrow_nautical())+\n  annotation_scale(plot_unit = \"mi\",\n                   location = \"br\",\n                   pad_x = unit(2.5, \"cm\"),\n                   pad_y = unit(5.5, \"cm\"))+\n  coord_sf(clip = \"off\")+\n  theme(\n    legend.position = c(0.5,-0.023),\n    plot.title = element_text(\n                              size = 15.75,\n                              vjust = 0,\n                              hjust = 0.5\n                              ),\n    plot.margin = margin(1, 1, 3, 1, \"cm\")\n  )\n}\n  \n\nmake_mesa(data = mesa_white_population, mesa_white_population$cat, \"Mesa White Population Density\", \"% of Population that is White\", cols)",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>C</span>  <span class='chapter-title'>Nico T.</span>"
    ]
  },
  {
    "objectID": "wa/wa-member2.html",
    "href": "wa/wa-member2.html",
    "title": "Appendix D — Member 2 First Name & Last Name Initial",
    "section": "",
    "text": "Work area to try code",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>D</span>  <span class='chapter-title'>Member 2 First Name & Last Name Initial</span>"
    ]
  },
  {
    "objectID": "wa/wa-member3.html",
    "href": "wa/wa-member3.html",
    "title": "Appendix E — Member 3 First Name & Last Name Initial",
    "section": "",
    "text": "Work area to try code",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>E</span>  <span class='chapter-title'>Member 3 First Name & Last Name Initial</span>"
    ]
  }
]