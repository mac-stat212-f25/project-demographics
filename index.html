<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Lorenzo G">
<meta name="author" content="Nico T">
<meta name="author" content="Jessica L">
<title>Breaking Down Demographics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./eda/eda-member1.html" rel="next">
<script src="site_libs/cookie-consent/cookie-consent.js"></script>
<link href="site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b6165e882820e9cbe81d0573c00a9ad9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-336fc07c9e36db0483797e7526239151.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-b6165e882820e9cbe81d0573c00a9ad9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="style/custom.css">
</head>
<body class="nav-sidebar docked quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html"><span class="chapter-title">A Tale of Two Counties</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./assets/sidebar-logo.png" alt="Random negative space illustration" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Demographics</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">A Tale of Two Counties</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda/eda-member1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Nico T</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda/eda-member2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Member 2 First Name &amp; Last Name Initial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda/eda-member3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Member 3 First Name &amp; Last Name Initial</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appx/proposal.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Proposal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appx/case-study.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Case Study</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wa/wa-member1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Nico T.</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wa/wa-member2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Member 2 First Name &amp; Last Name Initial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wa/wa-member3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Member 3 First Name &amp; Last Name Initial</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#acs-background" id="toc-acs-background" class="nav-link" data-scroll-target="#acs-background">ACS Background</a></li>
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">Motivation</a></li>
  <li><a href="#variable-choices" id="toc-variable-choices" class="nav-link" data-scroll-target="#variable-choices">Variable Choices</a></li>
  <li><a href="#race" id="toc-race" class="nav-link" data-scroll-target="#race">Race</a></li>
  <li><a href="#households" id="toc-households" class="nav-link" data-scroll-target="#households">Households</a></li>
  <li><a href="#education" id="toc-education" class="nav-link" data-scroll-target="#education">Education</a></li>
  <li><a href="#larger-scale" id="toc-larger-scale" class="nav-link" data-scroll-target="#larger-scale">Larger Scale</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Breaking Down Demographics</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Lorenzo G </p>
             <p>Nico T </p>
             <p>Jessica L </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Friday, December 19, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header><section id="intro" class="level1"><h1>Intro</h1>
<p>Life can be very different depending on what area you live in. For example, price of living, type of household one lives in, as well as how well educated you are, these are all influenced heavily by where you live in the United States. For our project, we wanted to choose two very different counties, comparing and contrasting the differences in the lifestyle of the average person living there.</p>
</section><section id="acs-background" class="level1"><h1>ACS Background</h1>
<p>The United States Census Bureau also collects the decennial census, which surveys every citizen in the United States on a ten year cycle. This survey often collects basic information about the population. The Census Bureau also runs the American Community Survey (ACS) which asks more in depth questions. The ACS does not survey all Americans like the census does, which can lead to possible margins of error which are also reported along with the data. Despite this, the ACS offers a deeper look into the demographics of the United States. This is why we chose to work with this data. To access the data from the ACS, we utilized the tidycensus package in RStudio. The tidycensus package allows users of RStudio streamlined access to the Census API, which allows developers to use census and ACS data. This made it easier for us to focus on the following cities and their counties.</p>
</section><section id="motivation" class="level1"><h1>Motivation</h1>
<p>We decided to choose the two most politically different cities in the United States for our comparison. This paper by Pew Research did a study of the most liberal and conservative big cities in America, assigning each a value from -1 (very liberal) to +1 (very conservative). However, please note that big cities often tend towards liberalism, so while San Francisco (the most liberal city) was assigned a score of -1, Mesa (the most conservative city) was assigned a score of +0.4. To pull the census data, we used counties, so San Francisco became “San Francisco county,” and the city of Mesa became “Maricopa county.”</p>
</section><section id="variable-choices" class="level1"><h1>Variable Choices</h1>
<p>Along with our goal to see how polarization and demographics are related, we decided to look at demographics that are most commonly associated with a conservative-liberal or democrat-split. The first of these variables is race. In the American political climate, while political candidates tend to try to reach out to people of different races, they tend to focus their attention on one or two groups and address their issues. Typically, more liberal or democratic views are seen to appeal to more diverse groups while focusing on issues that concern them while more conservative views tend to focus on the average white American and less so on the entire population. The next variable is types of households. What does the living situation of the people who answered the ACS in these areas look like? When listening to debates, you often hear conservatives advocating for traditional values and living situations such as married couples living together with their families and fulfilling the “American Dream”. Liberals don’t tend to have the same view, and value all types of living situations. Income is also a factor that comes into play in American Politics. Both conservative and liberal politicians claim to want to help the working class, however, year after year there seems to be more people from lower income brackets voting for the more conservative candidate. The last variable that we will be analyzing is education. While education and income variables are pretty closely related (people with higher income are more likely to have a higher level of education), there is still a distinct relationship between education levels and the views of a person. Those who tend to have higher levels of income are assumed to be more liberal than those who have had a less rigorous education background. Are these preconceptions consistent with the “most liberal” and “most conservative” cities in the United States and their surrounding areas? Or do we look at demographics too seriously when thinking about political backgrounds.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Getting our data</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># We are making a function to streamline our data collection from tidy census</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(city, variable_list){</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="cf">if</span>(city <span class="sc">==</span> <span class="st">"San Francisco"</span>){</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="fu">return</span>(<span class="fu">get_acs</span>(</span>
<span id="cb1-7"><a href="#cb1-7"></a>      <span class="at">state =</span> <span class="st">"CA"</span>,</span>
<span id="cb1-8"><a href="#cb1-8"></a>      <span class="at">county =</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb1-9"><a href="#cb1-9"></a>      <span class="at">geography =</span> <span class="st">"tract"</span>,</span>
<span id="cb1-10"><a href="#cb1-10"></a>      <span class="at">variables =</span> variable_list,</span>
<span id="cb1-11"><a href="#cb1-11"></a>      <span class="at">geometry =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-12"><a href="#cb1-12"></a>      <span class="at">year =</span> <span class="dv">2021</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>    )</span>
<span id="cb1-14"><a href="#cb1-14"></a>    )</span>
<span id="cb1-15"><a href="#cb1-15"></a>  }</span>
<span id="cb1-16"><a href="#cb1-16"></a>  <span class="cf">else</span>{</span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="fu">return</span>(<span class="fu">get_acs</span>(</span>
<span id="cb1-18"><a href="#cb1-18"></a>      <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb1-19"><a href="#cb1-19"></a>      <span class="at">county =</span> <span class="st">"Maricopa"</span>,</span>
<span id="cb1-20"><a href="#cb1-20"></a>      <span class="at">geography =</span> <span class="st">"tract"</span>,</span>
<span id="cb1-21"><a href="#cb1-21"></a>      <span class="at">variables =</span> variable_list,</span>
<span id="cb1-22"><a href="#cb1-22"></a>      <span class="at">geometry =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-23"><a href="#cb1-23"></a>      <span class="at">year =</span> <span class="dv">2021</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>    )</span>
<span id="cb1-25"><a href="#cb1-25"></a>    )</span>
<span id="cb1-26"><a href="#cb1-26"></a>  }</span>
<span id="cb1-27"><a href="#cb1-27"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Since we are going to be making two identical data sets for each variable we are looking at, it is useful to make a function to reduce clutter and chances or error</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># This function helps us turn or single value lists into a double</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>convert_to_numeric <span class="ot">&lt;-</span> <span class="cf">function</span>(value){</span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">as.numeric</span>(<span class="fu">paste</span>(value))</span>
<span id="cb2-6"><a href="#cb2-6"></a>}</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co"># This function helps us do the wrangling for the race data</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>wrangling_race <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb2-10"><a href="#cb2-10"></a>  data <span class="sc">|&gt;</span> </span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="fu">select</span>(geometry,variable,estimate) <span class="sc">|&gt;</span> </span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(variable <span class="sc">==</span> <span class="st">"B02001_002"</span> <span class="sc">~</span> <span class="st">"white_population"</span>,</span>
<span id="cb2-13"><a href="#cb2-13"></a>                                variable <span class="sc">==</span> <span class="st">"B02001_003"</span> <span class="sc">~</span> <span class="st">"black_african_american"</span>,</span>
<span id="cb2-14"><a href="#cb2-14"></a>                                variable <span class="sc">==</span> <span class="st">"B02001_004"</span> <span class="sc">~</span> <span class="st">"native_american"</span>,</span>
<span id="cb2-15"><a href="#cb2-15"></a>                                variable <span class="sc">==</span> <span class="st">"B02001_005"</span> <span class="sc">~</span> <span class="st">"asian"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb2-17"><a href="#cb2-17"></a>    <span class="fu">mutate</span>(<span class="at">white_population =</span> <span class="fu">convert_to_numeric</span>(white_population),</span>
<span id="cb2-18"><a href="#cb2-18"></a>           <span class="at">black_african_american =</span> <span class="fu">convert_to_numeric</span>(black_african_american),</span>
<span id="cb2-19"><a href="#cb2-19"></a>           <span class="at">native_american =</span> <span class="fu">convert_to_numeric</span>(native_american),</span>
<span id="cb2-20"><a href="#cb2-20"></a>           <span class="at">asian =</span> <span class="fu">convert_to_numeric</span>(asian)) <span class="sc">|&gt;</span> </span>
<span id="cb2-21"><a href="#cb2-21"></a>    <span class="fu">mutate</span>(<span class="at">majority =</span> <span class="fu">case_when</span>(white_population <span class="sc">&gt;</span> black_african_american <span class="sc">&amp;</span> white_population <span class="sc">&gt;</span> native_american <span class="sc">&amp;</span> white_population <span class="sc">&gt;</span> asian <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb2-22"><a href="#cb2-22"></a>                                black_african_american <span class="sc">&gt;</span> white_population <span class="sc">&amp;</span> black_african_american <span class="sc">&gt;</span> native_american <span class="sc">&amp;</span> black_african_american <span class="sc">&gt;</span> asian <span class="sc">~</span> <span class="st">"Black/African American"</span>,</span>
<span id="cb2-23"><a href="#cb2-23"></a>                                native_american <span class="sc">&gt;</span> white_population <span class="sc">&amp;</span> native_american <span class="sc">&gt;</span> black_african_american <span class="sc">&amp;</span> native_american <span class="sc">&gt;</span> asian <span class="sc">~</span> <span class="st">"Native American"</span>,</span>
<span id="cb2-24"><a href="#cb2-24"></a>                                asian <span class="sc">&gt;</span> white_population <span class="sc">&amp;</span> asian <span class="sc">&gt;</span> black_african_american <span class="sc">&amp;</span> asian <span class="sc">&gt;</span> native_american <span class="sc">~</span> <span class="st">"Asian"</span>))</span>
<span id="cb2-25"><a href="#cb2-25"></a>}</span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co"># This function helps us wrangle the education data</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>wrangling_education <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb2-29"><a href="#cb2-29"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>    <span class="fu">select</span>(geometry,variable,estimate) <span class="sc">|&gt;</span> </span>
<span id="cb2-31"><a href="#cb2-31"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(variable <span class="sc">==</span> <span class="st">"B15003_002"</span> <span class="sc">~</span> <span class="st">"none"</span>,</span>
<span id="cb2-32"><a href="#cb2-32"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_003"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-33"><a href="#cb2-33"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_004"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-34"><a href="#cb2-34"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_005"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-35"><a href="#cb2-35"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_006"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-36"><a href="#cb2-36"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_007"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-37"><a href="#cb2-37"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_008"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-38"><a href="#cb2-38"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_009"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-39"><a href="#cb2-39"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_009"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-40"><a href="#cb2-40"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_010"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-41"><a href="#cb2-41"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_011"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-42"><a href="#cb2-42"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_012"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-43"><a href="#cb2-43"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_013"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-44"><a href="#cb2-44"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_014"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-45"><a href="#cb2-45"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_015"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-46"><a href="#cb2-46"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_016"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb2-47"><a href="#cb2-47"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_017"</span> <span class="sc">~</span> <span class="st">"highschool_or_equivalent"</span>,</span>
<span id="cb2-48"><a href="#cb2-48"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_018"</span> <span class="sc">~</span> <span class="st">"highschool_or_equivalent"</span>,</span>
<span id="cb2-49"><a href="#cb2-49"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_019"</span> <span class="sc">~</span> <span class="st">"some_college"</span>,</span>
<span id="cb2-50"><a href="#cb2-50"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_020"</span> <span class="sc">~</span> <span class="st">"some_college"</span>,</span>
<span id="cb2-51"><a href="#cb2-51"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_021"</span> <span class="sc">~</span> <span class="st">"undergraduate"</span>,</span>
<span id="cb2-52"><a href="#cb2-52"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_022"</span> <span class="sc">~</span> <span class="st">"undergraduate"</span>,</span>
<span id="cb2-53"><a href="#cb2-53"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_023"</span> <span class="sc">~</span> <span class="st">"undergraduate"</span>,</span>
<span id="cb2-54"><a href="#cb2-54"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_024"</span> <span class="sc">~</span> <span class="st">"graduate"</span>,</span>
<span id="cb2-55"><a href="#cb2-55"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_025"</span> <span class="sc">~</span> <span class="st">"graduate"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-56"><a href="#cb2-56"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb2-57"><a href="#cb2-57"></a>    <span class="fu">mutate</span>(<span class="at">none =</span> <span class="fu">convert_to_numeric</span>(none),</span>
<span id="cb2-58"><a href="#cb2-58"></a>         <span class="at">pre_highschool =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(pre_highschool, sum)),</span>
<span id="cb2-59"><a href="#cb2-59"></a>         <span class="at">highschool_or_equivalent =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(highschool_or_equivalent, sum)),</span>
<span id="cb2-60"><a href="#cb2-60"></a>         <span class="at">some_college =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(some_college, sum)),</span>
<span id="cb2-61"><a href="#cb2-61"></a>         <span class="at">undergraduate =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(undergraduate, sum)),</span>
<span id="cb2-62"><a href="#cb2-62"></a>         <span class="at">graduate =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(graduate, sum))) <span class="sc">|&gt;</span> </span>
<span id="cb2-63"><a href="#cb2-63"></a>    <span class="fu">mutate</span>(<span class="at">majority =</span> <span class="fu">case_when</span>(none <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> none <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> none <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> none <span class="sc">&gt;</span> undergraduate <span class="sc">&amp;</span> none <span class="sc">&gt;</span> graduate <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb2-64"><a href="#cb2-64"></a>                                       pre_highschool <span class="sc">&gt;</span> none <span class="sc">&amp;</span> pre_highschool <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> pre_highschool <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> pre_highschool <span class="sc">&gt;</span> undergraduate <span class="sc">&amp;</span> pre_highschool <span class="sc">&gt;</span>graduate <span class="sc">~</span> <span class="st">"Pre-highschool"</span>,</span>
<span id="cb2-65"><a href="#cb2-65"></a>                                       highschool_or_equivalent <span class="sc">&gt;</span> none <span class="sc">&amp;</span> highschool_or_equivalent <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> highschool_or_equivalent <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> highschool_or_equivalent <span class="sc">&gt;</span> undergraduate <span class="sc">&amp;</span> highschool_or_equivalent <span class="sc">&gt;</span> graduate <span class="sc">~</span> <span class="st">"Highschool or Equivalent"</span>,</span>
<span id="cb2-66"><a href="#cb2-66"></a>                                       some_college <span class="sc">&gt;</span> none <span class="sc">&amp;</span> some_college <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> some_college <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> some_college <span class="sc">&gt;</span> undergraduate <span class="sc">&amp;</span> some_college <span class="sc">&gt;</span> graduate <span class="sc">~</span> <span class="st">"Some College"</span>,</span>
<span id="cb2-67"><a href="#cb2-67"></a>                                       undergraduate <span class="sc">&gt;</span> none <span class="sc">&amp;</span> undergraduate <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> undergraduate <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> undergraduate <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> undergraduate <span class="sc">&gt;</span> graduate <span class="sc">~</span> <span class="st">"Undergraduate Degree"</span>,</span>
<span id="cb2-68"><a href="#cb2-68"></a>                                       graduate <span class="sc">&gt;</span> none <span class="sc">&amp;</span> graduate <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> graduate <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> graduate <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> graduate <span class="sc">&gt;</span> undergraduate <span class="sc">~</span> <span class="st">"graduate"</span>))</span>
<span id="cb2-69"><a href="#cb2-69"></a>}</span>
<span id="cb2-70"><a href="#cb2-70"></a></span>
<span id="cb2-71"><a href="#cb2-71"></a><span class="co"># Function for wrangling the household data</span></span>
<span id="cb2-72"><a href="#cb2-72"></a>wrangling_households <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb2-73"><a href="#cb2-73"></a>  data <span class="sc">|&gt;</span> </span>
<span id="cb2-74"><a href="#cb2-74"></a>    <span class="fu">select</span>(geometry,variable,estimate) <span class="sc">|&gt;</span> </span>
<span id="cb2-75"><a href="#cb2-75"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(variable <span class="sc">==</span> <span class="st">"B11001_003"</span> <span class="sc">~</span> <span class="st">"married_couple"</span>,</span>
<span id="cb2-76"><a href="#cb2-76"></a>                                variable <span class="sc">==</span> <span class="st">"B11001_005"</span> <span class="sc">~</span> <span class="st">"male_householder"</span>,</span>
<span id="cb2-77"><a href="#cb2-77"></a>                                variable <span class="sc">==</span> <span class="st">"B11001_006"</span> <span class="sc">~</span> <span class="st">"female_householder"</span>,</span>
<span id="cb2-78"><a href="#cb2-78"></a>                                variable <span class="sc">==</span> <span class="st">"B11001_008"</span> <span class="sc">~</span> <span class="st">"lives_alone"</span>,</span>
<span id="cb2-79"><a href="#cb2-79"></a>                                variable <span class="sc">==</span> <span class="st">"B11001_009"</span> <span class="sc">~</span> <span class="st">"not_alone"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-80"><a href="#cb2-80"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb2-81"><a href="#cb2-81"></a>    <span class="fu">mutate</span>(<span class="at">married_couple =</span> <span class="fu">convert_to_numeric</span>(married_couple),</span>
<span id="cb2-82"><a href="#cb2-82"></a>           <span class="at">male_householder =</span> <span class="fu">convert_to_numeric</span>(male_householder),</span>
<span id="cb2-83"><a href="#cb2-83"></a>           <span class="at">female_householder =</span> <span class="fu">convert_to_numeric</span>(female_householder),</span>
<span id="cb2-84"><a href="#cb2-84"></a>           <span class="at">lives_alone =</span> <span class="fu">convert_to_numeric</span>(lives_alone),</span>
<span id="cb2-85"><a href="#cb2-85"></a>           <span class="at">not_alone =</span> <span class="fu">convert_to_numeric</span>(not_alone)) <span class="sc">|&gt;</span> </span>
<span id="cb2-86"><a href="#cb2-86"></a>    <span class="fu">mutate</span>(<span class="at">majority =</span> <span class="fu">case_when</span>(married_couple <span class="sc">&gt;</span> male_householder <span class="sc">&amp;</span> married_couple <span class="sc">&gt;</span> female_householder <span class="sc">&amp;</span> married_couple <span class="sc">&gt;</span> lives_alone <span class="sc">&amp;</span> married_couple <span class="sc">&gt;</span> not_alone <span class="sc">~</span> <span class="st">"Married couple (family)"</span>,</span>
<span id="cb2-87"><a href="#cb2-87"></a>                                male_householder <span class="sc">&gt;</span> married_couple <span class="sc">&amp;</span> male_householder <span class="sc">&gt;</span> female_householder <span class="sc">&amp;</span> male_householder <span class="sc">&gt;</span> lives_alone <span class="sc">&amp;</span> male_householder <span class="sc">&gt;</span> not_alone <span class="sc">~</span> <span class="st">"Male householder, no spouse (family)"</span>,</span>
<span id="cb2-88"><a href="#cb2-88"></a>                                female_householder <span class="sc">&gt;</span> married_couple <span class="sc">&amp;</span> female_householder <span class="sc">&gt;</span> male_householder <span class="sc">&amp;</span> female_householder <span class="sc">&gt;</span> lives_alone <span class="sc">&amp;</span> female_householder <span class="sc">&gt;</span> not_alone <span class="sc">~</span> <span class="st">"Female householder, no spouse (family)"</span>,</span>
<span id="cb2-89"><a href="#cb2-89"></a>                                lives_alone <span class="sc">&gt;</span> married_couple <span class="sc">&amp;</span> lives_alone <span class="sc">&gt;</span> male_householder <span class="sc">&amp;</span> lives_alone <span class="sc">&gt;</span> female_householder <span class="sc">&amp;</span> lives_alone <span class="sc">&gt;</span> not_alone <span class="sc">~</span> <span class="st">"Lives alone (non-family)"</span>,</span>
<span id="cb2-90"><a href="#cb2-90"></a>                                not_alone <span class="sc">&gt;</span> married_couple <span class="sc">&amp;</span> not_alone <span class="sc">&gt;</span> male_householder <span class="sc">&amp;</span> not_alone <span class="sc">&gt;</span> female_householder <span class="sc">&amp;</span> not_alone <span class="sc">&gt;</span> lives_alone <span class="sc">~</span> <span class="st">"Does not live alone (non-family)"</span>))</span>
<span id="cb2-91"><a href="#cb2-91"></a>}</span>
<span id="cb2-92"><a href="#cb2-92"></a></span>
<span id="cb2-93"><a href="#cb2-93"></a><span class="co"># This function helps us clean the data for median income</span></span>
<span id="cb2-94"><a href="#cb2-94"></a>median_income <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb2-95"><a href="#cb2-95"></a>  data <span class="sc">|&gt;</span> </span>
<span id="cb2-96"><a href="#cb2-96"></a>    <span class="fu">select</span>(geometry,variable,estimate) <span class="sc">|&gt;</span> </span>
<span id="cb2-97"><a href="#cb2-97"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-98"><a href="#cb2-98"></a>                              variable <span class="sc">==</span> <span class="st">"B07011_001"</span> <span class="sc">~</span> <span class="st">"median_income"</span></span>
<span id="cb2-99"><a href="#cb2-99"></a>                              )</span>
<span id="cb2-100"><a href="#cb2-100"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-101"><a href="#cb2-101"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb2-102"><a href="#cb2-102"></a>    <span class="fu">mutate</span>(<span class="at">median_income =</span> <span class="fu">as.numeric</span>(<span class="fu">paste</span>(median_income)))</span>
<span id="cb2-103"><a href="#cb2-103"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>sf_ed <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="at">state =</span> <span class="st">"CA"</span>,</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="at">county =</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B15003_002"</span>,<span class="st">"B15003_003"</span>,<span class="st">"B15003_004"</span>,<span class="st">"B15003_005"</span>,</span>
<span id="cb3-6"><a href="#cb3-6"></a>                <span class="st">"B15003_006"</span>,<span class="st">"B15003_007"</span>,<span class="st">"B15003_008"</span>,<span class="st">"B15003_009"</span>,<span class="st">"B15003_010"</span>,</span>
<span id="cb3-7"><a href="#cb3-7"></a>                <span class="st">"B15003_011"</span>,<span class="st">"B15003_012"</span>,<span class="st">"B15003_013"</span>,<span class="st">"B15003_014"</span>,<span class="st">"B15003_015"</span>,</span>
<span id="cb3-8"><a href="#cb3-8"></a>                <span class="st">"B15003_016"</span>,<span class="st">"B15003_017"</span>,<span class="st">"B15003_018"</span>,<span class="st">"B15003_019"</span>,<span class="st">"B15003_020"</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>                <span class="st">"B15003_021"</span>,<span class="st">"B15003_022"</span>,<span class="st">"B15003_023"</span>,<span class="st">"B15003_024"</span>,<span class="st">"B15003_025"</span>),</span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>) </span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a>ms_ed <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb3-14"><a href="#cb3-14"></a>  <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb3-15"><a href="#cb3-15"></a>  <span class="at">county =</span> <span class="st">"Maricopa"</span>,</span>
<span id="cb3-16"><a href="#cb3-16"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb3-17"><a href="#cb3-17"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B15003_002"</span>,<span class="st">"B15003_003"</span>,<span class="st">"B15003_004"</span>,<span class="st">"B15003_005"</span>,</span>
<span id="cb3-18"><a href="#cb3-18"></a>                <span class="st">"B15003_006"</span>,<span class="st">"B15003_007"</span>,<span class="st">"B15003_008"</span>,<span class="st">"B15003_009"</span>,<span class="st">"B15003_010"</span>,</span>
<span id="cb3-19"><a href="#cb3-19"></a>                <span class="st">"B15003_011"</span>,<span class="st">"B15003_012"</span>,<span class="st">"B15003_013"</span>,<span class="st">"B15003_014"</span>,<span class="st">"B15003_015"</span>,</span>
<span id="cb3-20"><a href="#cb3-20"></a>                <span class="st">"B15003_016"</span>,<span class="st">"B15003_017"</span>,<span class="st">"B15003_018"</span>,<span class="st">"B15003_019"</span>,<span class="st">"B15003_020"</span>,</span>
<span id="cb3-21"><a href="#cb3-21"></a>                <span class="st">"B15003_021"</span>,<span class="st">"B15003_022"</span>,<span class="st">"B15003_023"</span>,<span class="st">"B15003_024"</span>,<span class="st">"B15003_025"</span>),</span>
<span id="cb3-22"><a href="#cb3-22"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>)</span>
<span id="cb3-24"><a href="#cb3-24"></a></span>
<span id="cb3-25"><a href="#cb3-25"></a>education_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sf_ed, ms_ed) <span class="sc">%&gt;%</span> </span>
<span id="cb3-26"><a href="#cb3-26"></a>  <span class="fu">select</span>(NAME, variable, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>  <span class="fu">rename</span>(<span class="st">"county"</span> <span class="ot">=</span> <span class="st">"NAME"</span>,</span>
<span id="cb3-28"><a href="#cb3-28"></a>         <span class="st">"education"</span> <span class="ot">=</span> <span class="st">"variable"</span>,</span>
<span id="cb3-29"><a href="#cb3-29"></a>         <span class="st">"population"</span> <span class="ot">=</span> <span class="st">"estimate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>  <span class="fu">mutate</span>(<span class="at">education =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-31"><a href="#cb3-31"></a>    education <span class="sc">==</span> <span class="st">"B15003_002"</span> <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb3-32"><a href="#cb3-32"></a>    education <span class="sc">==</span> <span class="st">"B15003_003"</span> <span class="sc">~</span> <span class="st">"Nursery"</span>,</span>
<span id="cb3-33"><a href="#cb3-33"></a>    education <span class="sc">==</span> <span class="st">"B15003_004"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb3-34"><a href="#cb3-34"></a>    education <span class="sc">==</span> <span class="st">"B15003_005"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb3-35"><a href="#cb3-35"></a>    education <span class="sc">==</span> <span class="st">"B15003_006"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb3-36"><a href="#cb3-36"></a>    education <span class="sc">==</span> <span class="st">"B15003_007"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb3-37"><a href="#cb3-37"></a>    education <span class="sc">==</span> <span class="st">"B15003_008"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb3-38"><a href="#cb3-38"></a>    education <span class="sc">==</span> <span class="st">"B15003_009"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb3-39"><a href="#cb3-39"></a>    education <span class="sc">==</span> <span class="st">"B15003_010"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb3-40"><a href="#cb3-40"></a>    education <span class="sc">==</span> <span class="st">"B15003_011"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb3-41"><a href="#cb3-41"></a>    education <span class="sc">==</span> <span class="st">"B15003_012"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb3-42"><a href="#cb3-42"></a>    education <span class="sc">==</span> <span class="st">"B15003_013"</span> <span class="sc">~</span> <span class="st">"Middle"</span>,</span>
<span id="cb3-43"><a href="#cb3-43"></a>    education <span class="sc">==</span> <span class="st">"B15003_014"</span> <span class="sc">~</span> <span class="st">"Middle"</span>,</span>
<span id="cb3-44"><a href="#cb3-44"></a>    education <span class="sc">==</span> <span class="st">"B15003_015"</span> <span class="sc">~</span> <span class="st">"Middle"</span>,</span>
<span id="cb3-45"><a href="#cb3-45"></a>    education <span class="sc">==</span> <span class="st">"B15003_016"</span> <span class="sc">~</span> <span class="st">"Middle"</span>,</span>
<span id="cb3-46"><a href="#cb3-46"></a>    education <span class="sc">==</span> <span class="st">"B15003_017"</span> <span class="sc">~</span> <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb3-47"><a href="#cb3-47"></a>    education <span class="sc">==</span> <span class="st">"B15003_018"</span> <span class="sc">~</span> <span class="st">"GED"</span>,</span>
<span id="cb3-48"><a href="#cb3-48"></a>    education <span class="sc">==</span> <span class="st">"B15003_019"</span> <span class="sc">~</span> <span class="st">"Some College"</span>,</span>
<span id="cb3-49"><a href="#cb3-49"></a>    education <span class="sc">==</span> <span class="st">"B15003_020"</span> <span class="sc">~</span> <span class="st">"Some College"</span>,</span>
<span id="cb3-50"><a href="#cb3-50"></a>    education <span class="sc">==</span> <span class="st">"B15003_021"</span> <span class="sc">~</span> <span class="st">"Associate's"</span>,</span>
<span id="cb3-51"><a href="#cb3-51"></a>    education <span class="sc">==</span> <span class="st">"B15003_022"</span> <span class="sc">~</span> <span class="st">"Bachelor's"</span>,</span>
<span id="cb3-52"><a href="#cb3-52"></a>    education <span class="sc">==</span> <span class="st">"B15003_023"</span> <span class="sc">~</span> <span class="st">"Master's"</span>,</span>
<span id="cb3-53"><a href="#cb3-53"></a>    education <span class="sc">==</span> <span class="st">"B15003_024"</span> <span class="sc">~</span> <span class="st">"Professional"</span>,</span>
<span id="cb3-54"><a href="#cb3-54"></a>    education <span class="sc">==</span> <span class="st">"B15003_025"</span> <span class="sc">~</span> <span class="st">"Doctorate"</span></span>
<span id="cb3-55"><a href="#cb3-55"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-56"><a href="#cb3-56"></a>  <span class="fu">mutate</span>(<span class="at">education =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-57"><a href="#cb3-57"></a>    education <span class="sc">==</span> <span class="st">"None"</span> <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb3-58"><a href="#cb3-58"></a>    education <span class="sc">==</span> <span class="st">"Nursery"</span> <span class="sc">~</span> <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb3-59"><a href="#cb3-59"></a>    education <span class="sc">==</span> <span class="st">"Kindergarten"</span> <span class="sc">~</span> <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb3-60"><a href="#cb3-60"></a>    education <span class="sc">==</span> <span class="st">"Elementary"</span> <span class="sc">~</span> <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb3-61"><a href="#cb3-61"></a>    education <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb3-62"><a href="#cb3-62"></a>    education <span class="sc">==</span> <span class="st">"Highschool (or equivalent)"</span> <span class="sc">~</span> <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb3-63"><a href="#cb3-63"></a>    education <span class="sc">==</span> <span class="st">"GED"</span> <span class="sc">~</span> <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb3-64"><a href="#cb3-64"></a>    education <span class="sc">==</span> <span class="st">"Some College"</span> <span class="sc">~</span> <span class="st">"Some College"</span>,</span>
<span id="cb3-65"><a href="#cb3-65"></a>    education <span class="sc">==</span> <span class="st">"Associate's"</span> <span class="sc">~</span> <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb3-66"><a href="#cb3-66"></a>    education <span class="sc">==</span> <span class="st">"Bachelor's"</span> <span class="sc">~</span> <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb3-67"><a href="#cb3-67"></a>    education <span class="sc">==</span> <span class="st">"Professional"</span> <span class="sc">~</span> <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb3-68"><a href="#cb3-68"></a>    education <span class="sc">==</span> <span class="st">"Master's"</span> <span class="sc">~</span> <span class="st">"Graduate Degree"</span>,</span>
<span id="cb3-69"><a href="#cb3-69"></a>    education <span class="sc">==</span> <span class="st">"Doctorate"</span> <span class="sc">~</span> <span class="st">"Graduate Degree"</span>,</span>
<span id="cb3-70"><a href="#cb3-70"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-71"><a href="#cb3-71"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-72"><a href="#cb3-72"></a>    county <span class="sc">==</span> <span class="st">"San Francisco County, California"</span> <span class="sc">~</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb3-73"><a href="#cb3-73"></a>    county <span class="sc">==</span> <span class="st">"Maricopa County, Arizona"</span> <span class="sc">~</span> <span class="st">"Maricopa"</span></span>
<span id="cb3-74"><a href="#cb3-74"></a>  ))<span class="sc">%&gt;%</span> </span>
<span id="cb3-75"><a href="#cb3-75"></a>  <span class="fu">group_by</span>(county) <span class="sc">%&gt;%</span></span>
<span id="cb3-76"><a href="#cb3-76"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> population <span class="sc">/</span> <span class="fu">sum</span>(population)) <span class="sc">%&gt;%</span></span>
<span id="cb3-77"><a href="#cb3-77"></a>  <span class="fu">mutate</span>(<span class="at">education =</span> <span class="fu">factor</span>(</span>
<span id="cb3-78"><a href="#cb3-78"></a>    education,</span>
<span id="cb3-79"><a href="#cb3-79"></a>    <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb3-80"><a href="#cb3-80"></a>      <span class="st">"Graduate Degree"</span>,</span>
<span id="cb3-81"><a href="#cb3-81"></a>      <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb3-82"><a href="#cb3-82"></a>      <span class="st">"Some College"</span>,</span>
<span id="cb3-83"><a href="#cb3-83"></a>      <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb3-84"><a href="#cb3-84"></a>      <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb3-85"><a href="#cb3-85"></a>      <span class="st">"None"</span></span>
<span id="cb3-86"><a href="#cb3-86"></a>    )</span>
<span id="cb3-87"><a href="#cb3-87"></a>  ))<span class="sc">%&gt;%</span></span>
<span id="cb3-88"><a href="#cb3-88"></a>  <span class="fu">group_by</span>(county, education) <span class="sc">%&gt;%</span></span>
<span id="cb3-89"><a href="#cb3-89"></a>  <span class="fu">summarize</span>(<span class="at">prop =</span> <span class="fu">sum</span>(prop)) <span class="sc">%&gt;%</span></span>
<span id="cb3-90"><a href="#cb3-90"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-91"><a href="#cb3-91"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-92"><a href="#cb3-92"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">if_else</span>(</span>
<span id="cb3-93"><a href="#cb3-93"></a>    county <span class="sc">==</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb3-94"><a href="#cb3-94"></a>    <span class="sc">-</span>prop,</span>
<span id="cb3-95"><a href="#cb3-95"></a>    prop</span>
<span id="cb3-96"><a href="#cb3-96"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb3-97"><a href="#cb3-97"></a>  <span class="fu">mutate</span>(<span class="at">education =</span> <span class="fu">factor</span>(</span>
<span id="cb3-98"><a href="#cb3-98"></a>    education,</span>
<span id="cb3-99"><a href="#cb3-99"></a>    <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb3-100"><a href="#cb3-100"></a>      <span class="st">"None"</span>,</span>
<span id="cb3-101"><a href="#cb3-101"></a>      <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb3-102"><a href="#cb3-102"></a>      <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb3-103"><a href="#cb3-103"></a>      <span class="st">"Some College"</span>,</span>
<span id="cb3-104"><a href="#cb3-104"></a>      <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb3-105"><a href="#cb3-105"></a>      <span class="st">"Graduate Degree"</span></span>
<span id="cb3-106"><a href="#cb3-106"></a>    )</span>
<span id="cb3-107"><a href="#cb3-107"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># data for maps</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># Data for income in San Francisco</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>sanfrancisco_income <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"San Francisco"</span>, <span class="st">"B07011_001"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">median_income</span>()</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># Data for income in Mesa</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>mesa_income <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"Mesa"</span>, <span class="st">"B07011_001"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="fu">median_income</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># For breaks we will use the Jenk's Natural Intervals method. This will help us create more natural intervals where the variance in each interval is minimized while the variance between intervals is maximized.</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Since we want the maps to have the same breaks, we are going to combine our data to better create breaks that can be used across datasets</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Making the breaks for white population maps</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>money_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sanfrancisco_income, mesa_income)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>income_ni <span class="ot">&lt;-</span> <span class="fu">classIntervals</span>(money_data<span class="sc">$</span>median_income,</span>
<span id="cb5-9"><a href="#cb5-9"></a>                              <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb5-10"><a href="#cb5-10"></a>                              <span class="at">style =</span> <span class="st">"jenks"</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>                              )<span class="sc">$</span>brks</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a>income_labels <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb5-14"><a href="#cb5-14"></a></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(income_ni)){</span>
<span id="cb5-16"><a href="#cb5-16"></a>  income_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-17"><a href="#cb5-17"></a>      income_labels, <span class="fu">paste0</span>(</span>
<span id="cb5-18"><a href="#cb5-18"></a>        <span class="st">"$"</span>, income_ni[i],</span>
<span id="cb5-19"><a href="#cb5-19"></a>        <span class="st">" to $"</span>,</span>
<span id="cb5-20"><a href="#cb5-20"></a>        income_ni[i<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb5-21"><a href="#cb5-21"></a>      )</span>
<span id="cb5-22"><a href="#cb5-22"></a>  )</span>
<span id="cb5-23"><a href="#cb5-23"></a>}</span>
<span id="cb5-24"><a href="#cb5-24"></a></span>
<span id="cb5-25"><a href="#cb5-25"></a>income_labels <span class="ot">&lt;-</span> income_labels[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(income_labels)<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a>sanfrancisco_income<span class="sc">$</span>cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb5-28"><a href="#cb5-28"></a>  sanfrancisco_income<span class="sc">$</span>median_income,</span>
<span id="cb5-29"><a href="#cb5-29"></a>  <span class="at">breaks =</span> income_ni,</span>
<span id="cb5-30"><a href="#cb5-30"></a>  <span class="at">labels =</span> income_labels,</span>
<span id="cb5-31"><a href="#cb5-31"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>)</span>
<span id="cb5-33"><a href="#cb5-33"></a></span>
<span id="cb5-34"><a href="#cb5-34"></a>mesa_income<span class="sc">$</span>cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb5-35"><a href="#cb5-35"></a>  mesa_income<span class="sc">$</span>median_income ,</span>
<span id="cb5-36"><a href="#cb5-36"></a>  <span class="at">breaks =</span> income_ni,</span>
<span id="cb5-37"><a href="#cb5-37"></a>  <span class="at">labels =</span> income_labels,</span>
<span id="cb5-38"><a href="#cb5-38"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span></span>
<span id="cb5-39"><a href="#cb5-39"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>sf_households <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="at">state =</span> <span class="st">"CA"</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="at">county =</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B11001_003"</span>, <span class="st">"B11001_005"</span>, <span class="st">"B11001_006"</span>, </span>
<span id="cb6-6"><a href="#cb6-6"></a>                <span class="st">"B11001_008"</span>, <span class="st">"B11001_009"</span>),</span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>)</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>ms_households <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="at">county =</span> <span class="st">"Maricopa"</span>,</span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B11001_003"</span>, <span class="st">"B11001_005"</span>, <span class="st">"B11001_006"</span>, </span>
<span id="cb6-15"><a href="#cb6-15"></a>                <span class="st">"B11001_008"</span>, <span class="st">"B11001_009"</span>),</span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>)</span>
<span id="cb6-18"><a href="#cb6-18"></a></span>
<span id="cb6-19"><a href="#cb6-19"></a>household_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sf_households, ms_households) <span class="sc">%&gt;%</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="fu">select</span>(NAME, variable, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21"></a>  <span class="fu">rename</span>(<span class="st">"county"</span> <span class="ot">=</span> <span class="st">"NAME"</span>,</span>
<span id="cb6-22"><a href="#cb6-22"></a>         <span class="st">"household"</span> <span class="ot">=</span> <span class="st">"variable"</span>,</span>
<span id="cb6-23"><a href="#cb6-23"></a>         <span class="st">"population"</span> <span class="ot">=</span> <span class="st">"estimate"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-25"><a href="#cb6-25"></a>    county <span class="sc">==</span> <span class="st">"San Francisco County, California"</span> <span class="sc">~</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb6-26"><a href="#cb6-26"></a>    county <span class="sc">==</span> <span class="st">"Maricopa County, Arizona"</span> <span class="sc">~</span> <span class="st">"Maricopa"</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb6-28"><a href="#cb6-28"></a>  <span class="fu">mutate</span>(<span class="at">household =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-29"><a href="#cb6-29"></a>    household <span class="sc">==</span> <span class="st">"B11001_003"</span> <span class="sc">~</span> <span class="st">"Married couple (family)"</span>,</span>
<span id="cb6-30"><a href="#cb6-30"></a>    household <span class="sc">==</span> <span class="st">"B11001_005"</span> <span class="sc">~</span> <span class="st">"Male householder, no spouse (family)"</span>,</span>
<span id="cb6-31"><a href="#cb6-31"></a>    household <span class="sc">==</span> <span class="st">"B11001_006"</span> <span class="sc">~</span> <span class="st">"Female householder, no spouse (family)"</span>,</span>
<span id="cb6-32"><a href="#cb6-32"></a>    household <span class="sc">==</span> <span class="st">"B11001_008"</span> <span class="sc">~</span> <span class="st">"Lives alone (non-family)"</span>,</span>
<span id="cb6-33"><a href="#cb6-33"></a>    household <span class="sc">==</span> <span class="st">"B11001_009"</span> <span class="sc">~</span> <span class="st">"Does not live alone (non-family)"</span></span>
<span id="cb6-34"><a href="#cb6-34"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb6-35"><a href="#cb6-35"></a>  <span class="fu">mutate</span>(<span class="at">household =</span> <span class="fu">factor</span>(</span>
<span id="cb6-36"><a href="#cb6-36"></a>    household,</span>
<span id="cb6-37"><a href="#cb6-37"></a>    <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb6-38"><a href="#cb6-38"></a>      <span class="st">"Lives alone (non-family)"</span>,</span>
<span id="cb6-39"><a href="#cb6-39"></a>      <span class="st">"Does not live alone (non-family)"</span>,</span>
<span id="cb6-40"><a href="#cb6-40"></a>      <span class="st">"Female householder, no spouse (family)"</span>,</span>
<span id="cb6-41"><a href="#cb6-41"></a>      <span class="st">"Male householder, no spouse (family)"</span>,</span>
<span id="cb6-42"><a href="#cb6-42"></a>      <span class="st">"Married couple (family)"</span></span>
<span id="cb6-43"><a href="#cb6-43"></a>    )</span>
<span id="cb6-44"><a href="#cb6-44"></a>  ))<span class="sc">%&gt;%</span></span>
<span id="cb6-45"><a href="#cb6-45"></a>  <span class="fu">group_by</span>(county) <span class="sc">%&gt;%</span></span>
<span id="cb6-46"><a href="#cb6-46"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> population<span class="sc">/</span><span class="fu">sum</span>(population)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-47"><a href="#cb6-47"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">if_else</span>(</span>
<span id="cb6-48"><a href="#cb6-48"></a>    county <span class="sc">==</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb6-49"><a href="#cb6-49"></a>    <span class="sc">-</span>prop,</span>
<span id="cb6-50"><a href="#cb6-50"></a>    prop</span>
<span id="cb6-51"><a href="#cb6-51"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>make_sanfrancisco <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable, title_text, legend_name, colors){</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> data,</span>
<span id="cb7-4"><a href="#cb7-4"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> variable),</span>
<span id="cb7-5"><a href="#cb7-5"></a>          <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb7-6"><a href="#cb7-6"></a>          <span class="at">size =</span> <span class="fl">0.5</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>          )<span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> sanfrancisco_city, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> sanfrancisco_city, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">label =</span> name), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.04</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">122.5</span>, <span class="sc">-</span><span class="fl">122.4</span>), </span>
<span id="cb7-11"><a href="#cb7-11"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a>                     )<span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">37.7</span>, <span class="fl">37.84</span>), </span>
<span id="cb7-14"><a href="#cb7-14"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb7-15"><a href="#cb7-15"></a>                     )<span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb7-17"><a href="#cb7-17"></a>    <span class="at">name =</span> legend_name,</span>
<span id="cb7-18"><a href="#cb7-18"></a>    <span class="at">values =</span> colors</span>
<span id="cb7-19"><a href="#cb7-19"></a>  )<span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>  <span class="fu">guides</span>(</span>
<span id="cb7-21"><a href="#cb7-21"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb7-22"><a href="#cb7-22"></a>      <span class="at">direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb7-23"><a href="#cb7-23"></a>      <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>),</span>
<span id="cb7-24"><a href="#cb7-24"></a>      <span class="at">keywidth =</span> <span class="fu">unit</span>(<span class="dv">13</span>, <span class="st">"mm"</span>),</span>
<span id="cb7-25"><a href="#cb7-25"></a>      <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb7-26"><a href="#cb7-26"></a>      <span class="at">label.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb7-27"><a href="#cb7-27"></a>      <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb7-28"><a href="#cb7-28"></a>      <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb7-29"><a href="#cb7-29"></a>      <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb7-30"><a href="#cb7-30"></a>      <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-31"><a href="#cb7-31"></a>    )</span>
<span id="cb7-32"><a href="#cb7-32"></a>  )<span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-34"><a href="#cb7-34"></a>    <span class="at">title =</span> title_text</span>
<span id="cb7-35"><a href="#cb7-35"></a>  )<span class="sc">+</span></span>
<span id="cb7-36"><a href="#cb7-36"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb7-37"><a href="#cb7-37"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"tl"</span>,</span>
<span id="cb7-38"><a href="#cb7-38"></a>                         <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb7-39"><a href="#cb7-39"></a>                         <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">3.25</span>, <span class="st">"cm"</span>),</span>
<span id="cb7-40"><a href="#cb7-40"></a>                         <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb7-41"><a href="#cb7-41"></a>                         <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb7-42"><a href="#cb7-42"></a>                         <span class="at">style =</span> <span class="fu">north_arrow_nautical</span>())<span class="sc">+</span></span>
<span id="cb7-43"><a href="#cb7-43"></a>  <span class="fu">annotation_scale</span>(<span class="at">plot_unit =</span> <span class="st">"mi"</span>,</span>
<span id="cb7-44"><a href="#cb7-44"></a>                   <span class="at">location =</span> <span class="st">"br"</span>,</span>
<span id="cb7-45"><a href="#cb7-45"></a>                   <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">4.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb7-46"><a href="#cb7-46"></a>                   <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">7.5</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb7-47"><a href="#cb7-47"></a>  <span class="fu">coord_sf</span>(<span class="at">clip =</span> <span class="st">"off"</span>)<span class="sc">+</span></span>
<span id="cb7-48"><a href="#cb7-48"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-49"><a href="#cb7-49"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb7-50"><a href="#cb7-50"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb7-51"><a href="#cb7-51"></a>                              <span class="at">size =</span> <span class="fl">15.75</span>,</span>
<span id="cb7-52"><a href="#cb7-52"></a>                              <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb7-53"><a href="#cb7-53"></a>                              <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb7-54"><a href="#cb7-54"></a>                              ),</span>
<span id="cb7-55"><a href="#cb7-55"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)</span>
<span id="cb7-56"><a href="#cb7-56"></a>  )</span>
<span id="cb7-57"><a href="#cb7-57"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>make_mesa <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable, title_text, legend_name, colors){</span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> data,</span>
<span id="cb8-4"><a href="#cb8-4"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> variable),</span>
<span id="cb8-5"><a href="#cb8-5"></a>          <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>          <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> mesa_city, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> mesa_city, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">label =</span> name), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.04</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="at">name =</span> legend_name,</span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="at">values =</span> colors)<span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="fu">guides</span>(</span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb8-14"><a href="#cb8-14"></a>      <span class="at">direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb8-15"><a href="#cb8-15"></a>      <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>),</span>
<span id="cb8-16"><a href="#cb8-16"></a>      <span class="at">keywidth =</span> <span class="fu">unit</span>(<span class="dv">13</span>, <span class="st">"mm"</span>),</span>
<span id="cb8-17"><a href="#cb8-17"></a>      <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb8-18"><a href="#cb8-18"></a>      <span class="at">label.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb8-19"><a href="#cb8-19"></a>      <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb8-20"><a href="#cb8-20"></a>      <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb8-21"><a href="#cb8-21"></a>      <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb8-22"><a href="#cb8-22"></a>      <span class="at">byrow =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-24"><a href="#cb8-24"></a>    <span class="at">title =</span> title_text</span>
<span id="cb8-25"><a href="#cb8-25"></a>  )<span class="sc">+</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb8-27"><a href="#cb8-27"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"tr"</span>,</span>
<span id="cb8-28"><a href="#cb8-28"></a>                         <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb8-29"><a href="#cb8-29"></a>                         <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb8-30"><a href="#cb8-30"></a>                         <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb8-31"><a href="#cb8-31"></a>                         <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb8-32"><a href="#cb8-32"></a>                         <span class="at">style =</span> <span class="fu">north_arrow_nautical</span>())<span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>  <span class="fu">annotation_scale</span>(<span class="at">plot_unit =</span> <span class="st">"mi"</span>,</span>
<span id="cb8-34"><a href="#cb8-34"></a>                   <span class="at">location =</span> <span class="st">"br"</span>,</span>
<span id="cb8-35"><a href="#cb8-35"></a>                   <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb8-36"><a href="#cb8-36"></a>                   <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">5.5</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37"></a>  <span class="fu">coord_sf</span>(<span class="at">clip =</span> <span class="st">"off"</span>)<span class="sc">+</span></span>
<span id="cb8-38"><a href="#cb8-38"></a>  <span class="fu">theme</span>(</span>
<span id="cb8-39"><a href="#cb8-39"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb8-40"><a href="#cb8-40"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb8-41"><a href="#cb8-41"></a>                              <span class="at">size =</span> <span class="fl">15.75</span>,</span>
<span id="cb8-42"><a href="#cb8-42"></a>                              <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb8-43"><a href="#cb8-43"></a>                              <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb8-44"><a href="#cb8-44"></a>                              ),</span>
<span id="cb8-45"><a href="#cb8-45"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)</span>
<span id="cb8-46"><a href="#cb8-46"></a>  )</span>
<span id="cb8-47"><a href="#cb8-47"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>,<span class="st">"#6c31fd"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a>sanfrancisco_race_map <span class="ot">&lt;-</span> <span class="fu">make_sanfrancisco</span>(<span class="at">data =</span> sanfrancisco_race, <span class="at">variable =</span> sanfrancisco_race<span class="sc">$</span>majority, <span class="at">title_text =</span>  <span class="st">"San Francisco County"</span>, <span class="at">legend_name =</span> <span class="st">"Predominate Race in Census Tract"</span>, <span class="at">colors =</span> cols)</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">ggsave</span>(<span class="st">"sanfrancisco_race_map.png"</span>, sanfrancisco_race_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>, <span class="st">"#6c31fd"</span>, <span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a>mesa_race_map <span class="ot">&lt;-</span><span class="fu">make_mesa</span>(<span class="at">data =</span> mesa_race, mesa_race<span class="sc">$</span>majority, <span class="st">"Maricopa County"</span>, <span class="st">"Predominate Race in Census Tract"</span>, cols)</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="fu">ggsave</span>(<span class="st">"mesa_race.png"</span>, mesa_race_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>race_barplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(race_data, <span class="fu">aes</span>(<span class="at">x =</span> race, <span class="at">y =</span> prop, <span class="at">fill =</span> race)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Race Distribution in the Two Counties"</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>       <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span>,</span>
<span id="cb11-6"><a href="#cb11-6"></a>       <span class="at">y =</span> <span class="st">"Percent of Population"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Race Group"</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="st">"#fe8127"</span>,</span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="st">"#6c31fd"</span>,</span>
<span id="cb11-12"><a href="#cb11-12"></a>  <span class="st">"#5fa09f"</span>,</span>
<span id="cb11-13"><a href="#cb11-13"></a>  <span class="st">"#fedf60"</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>))  <span class="sc">+</span> </span>
<span id="cb11-15"><a href="#cb11-15"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-17"><a href="#cb11-17"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.7</span>,<span class="fl">0.4</span>),</span>
<span id="cb11-18"><a href="#cb11-18"></a>        <span class="at">legend.direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb11-19"><a href="#cb11-19"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.315</span>, <span class="at">vjust =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb11-20"><a href="#cb11-20"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.265</span>, <span class="at">vjust =</span> <span class="dv">8</span>),</span>
<span id="cb11-21"><a href="#cb11-21"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="fl">4.5</span>, <span class="at">y =</span><span class="sc">-</span><span class="dv">30</span>, <span class="at">label =</span> <span class="st">"San Francisco County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb11-23"><a href="#cb11-23"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.5</span>, <span class="at">y=</span> <span class="dv">30</span>, <span class="at">label =</span> <span class="st">"Maricopa County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">24.93</span>, <span class="at">label =</span> <span class="st">"49.9%"</span>)<span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span><span class="dv">3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">21.53</span>, <span class="at">label =</span> <span class="st">"43.0%"</span>)<span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">12.3</span>, <span class="at">label =</span> <span class="st">"6.3%"</span>)<span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">1</span>, <span class="at">y =</span><span class="sc">-</span><span class="fl">6.8</span>, <span class="at">label =</span> <span class="st">"0.8%"</span>)<span class="sc">+</span></span>
<span id="cb11-28"><a href="#cb11-28"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">41.95</span>, <span class="at">label =</span> <span class="st">"83.9%"</span>)<span class="sc">+</span></span>
<span id="cb11-29"><a href="#cb11-29"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">11.8</span>, <span class="at">label =</span> <span class="st">"5.9%"</span>)<span class="sc">+</span></span>
<span id="cb11-30"><a href="#cb11-30"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">13.68</span>, <span class="at">label =</span> <span class="st">"7.7%"</span>)<span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">8.58</span>, <span class="at">label =</span> <span class="st">"2.5%"</span>)<span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">60</span>, <span class="at">label =</span> <span class="st">"Map colors are the same as this graph, except that the </span><span class="sc">\n</span><span class="st"> color represents the race that is makes up the majority of the </span><span class="sc">\n</span><span class="st"> population in the census tract."</span>)</span>
<span id="cb11-33"><a href="#cb11-33"></a></span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="fu">ggsave</span>(<span class="st">"race_barplot.png"</span>, race_barplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>race_map_sf <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"sanfrancisco_race_map.png"</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>race_map_mesa <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"mesa_race.png"</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>race_barplot_ig <span class="ot">&lt;-</span> <span class="fu">image_border</span>(<span class="fu">image_scale</span>(<span class="fu">image_read</span>(<span class="st">"race_barplot.png"</span>),<span class="st">"x1570"</span>), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">geometry =</span> <span class="st">"0x340"</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>race_maps <span class="ot">&lt;-</span> <span class="fu">image_append</span>(<span class="fu">c</span>(race_map_sf,race_barplot_ig, race_map_mesa))</span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="fu">image_write</span>(race_maps, <span class="at">path =</span> <span class="st">"race_plot.png"</span>, <span class="at">format =</span> <span class="st">"png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="race" class="level1 page-columns page-full"><h1>Race</h1>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p class="page-columns page-full"><img src="race_plot.png" class="column-screen img-fluid figure-img"></p>
<figcaption>Plot shows the distribution of race in the two counties by census tract and as a county as a whole</figcaption></figure>
</div>
<p>San Francisco county was predominantly white (49.9%), with also a large Asian population, and a smaller Black and American Indian population. Maricopa county, on the other hand, was overwhelmingly white (83.9%), with a smaller Asian, Black, and American Indian population.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>, <span class="st">"#8289fe"</span>, <span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>sanfrancisco_household_map <span class="ot">&lt;-</span> <span class="fu">make_sanfrancisco</span>(sanfrancisco_households, sanfrancisco_households<span class="sc">$</span>majority, <span class="st">"San Francisco County"</span>, <span class="st">"Majority Education level"</span>, cols)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="fu">ggsave</span>(<span class="st">"sanfrancisco_households.png"</span>, sanfrancisco_household_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>, <span class="st">"#8289fe"</span>, <span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>mesa_households_map <span class="ot">&lt;-</span> <span class="fu">make_mesa</span>(mesa_households,mesa_households<span class="sc">$</span>majority, <span class="st">"Maricopa County"</span>, <span class="st">"Household Type"</span>, cols)</span>
<span id="cb14-4"><a href="#cb14-4"></a></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="fu">ggsave</span>(<span class="st">"mesa_households.png"</span>, mesa_households_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>household_barplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(household_data, <span class="fu">aes</span>(<span class="at">x =</span> household, <span class="at">y =</span> prop, <span class="at">fill =</span> household)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Household Comparision across Two Counties"</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>       <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>         <span class="at">y =</span> <span class="st">"Percent of Population"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Household Type"</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="st">"#fe8127"</span>,</span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="st">"#5fa09f"</span>,</span>
<span id="cb15-11"><a href="#cb15-11"></a>  <span class="st">"#8289fe"</span>,</span>
<span id="cb15-12"><a href="#cb15-12"></a>  <span class="st">"#6c31fd"</span>,</span>
<span id="cb15-13"><a href="#cb15-13"></a>  <span class="st">"#fedf60"</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>)) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb15-16"><a href="#cb15-16"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-18"><a href="#cb15-18"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.84</span>,<span class="fl">0.47</span>),</span>
<span id="cb15-19"><a href="#cb15-19"></a>        <span class="at">legend.direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb15-20"><a href="#cb15-20"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.315</span>, <span class="at">vjust =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb15-21"><a href="#cb15-21"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.265</span>, <span class="at">vjust =</span> <span class="dv">8</span>),</span>
<span id="cb15-22"><a href="#cb15-22"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb15-23"><a href="#cb15-23"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="fl">5.5</span>, <span class="at">y =</span><span class="sc">-</span><span class="dv">30</span>, <span class="at">label =</span> <span class="st">"San Francisco County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">5.5</span>, <span class="at">y=</span> <span class="dv">30</span>, <span class="at">label =</span> <span class="st">"Maricopa County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25"></a></span>
<span id="cb15-26"><a href="#cb15-26"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">17.75</span>, <span class="at">label =</span> <span class="st">"35.5%"</span>)<span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">9.5</span>, <span class="at">label =</span> <span class="st">"3.5%"</span>)<span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span><span class="dv">3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">3.85</span>, <span class="at">label =</span> <span class="st">"7.7%"</span>)<span class="sc">+</span></span>
<span id="cb15-29"><a href="#cb15-29"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">7.6</span>, <span class="at">label =</span> <span class="st">"15.2%"</span>)<span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">1</span>, <span class="at">y =</span><span class="sc">-</span><span class="dv">19</span>, <span class="at">label =</span> <span class="st">"38.0%"</span>)<span class="sc">+</span></span>
<span id="cb15-31"><a href="#cb15-31"></a>  </span>
<span id="cb15-32"><a href="#cb15-32"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fl">23.65</span>, <span class="at">label =</span> <span class="st">"47.3%"</span>)<span class="sc">+</span></span>
<span id="cb15-33"><a href="#cb15-33"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">11.7</span>, <span class="at">label =</span> <span class="st">"5.7%"</span>)<span class="sc">+</span></span>
<span id="cb15-34"><a href="#cb15-34"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">6</span>, <span class="at">label =</span> <span class="st">"12.0%"</span>)<span class="sc">+</span></span>
<span id="cb15-35"><a href="#cb15-35"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">4.25</span>, <span class="at">label =</span> <span class="st">"8.5%"</span>)<span class="sc">+</span></span>
<span id="cb15-36"><a href="#cb15-36"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">13.2</span>, <span class="at">label =</span> <span class="st">"26.4%"</span>)</span>
<span id="cb15-37"><a href="#cb15-37"></a></span>
<span id="cb15-38"><a href="#cb15-38"></a><span class="fu">ggsave</span>(<span class="st">"household_barplot.png"</span>, household_barplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>household_map_sf <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"sanfrancisco_households.png"</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>household_map_mesa <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"mesa_households.png"</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>household_barplot_ig <span class="ot">&lt;-</span> <span class="fu">image_border</span>(<span class="fu">image_scale</span>(<span class="fu">image_read</span>(<span class="st">"household_barplot.png"</span>),<span class="st">"x1570"</span>), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">geometry =</span> <span class="st">"0x340"</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>race_maps <span class="ot">&lt;-</span> <span class="fu">image_append</span>(<span class="fu">c</span>(household_map_sf,household_barplot_ig, household_map_mesa))</span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="fu">image_write</span>(race_maps, <span class="at">path =</span> <span class="st">"household_plot.png"</span>, <span class="at">format =</span> <span class="st">"png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="households" class="level1 page-columns page-full"><h1>Households</h1>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p class="page-columns page-full"><img src="household_plot.png" class="column-screen img-fluid figure-img"></p>
<figcaption>Plot shows the distribution of household types in the two counties by census tract and as a county as a whole</figcaption></figure>
</div>
<p>In our plot, we can see that within these two counties, our preconceived notion is that more traditional/family household types are in the area considered the “most conservative” while there are more non-traditional/non-family households in the area considered the most liberal. The bar plot demonstrates that, while both San Francisco and Maricopa County both have a large percentage of their households that fall in the married couple category, Maricopa County has slightly more. The opposite can be said about live alone households, where San Francisco has a larger percentage of their households falling under this category than Maricopa County. The maps also show that these trends are more true around the cities, where most census tracts around San Francisco have the majority of their households that fall within a non-traditional housing category. More of the census tracts that surround Mesa have the majority of their households fall under the married couple category, which backs up our original idea.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#edf8fb"</span>, <span class="st">"#b2e2e2"</span>,<span class="st">"#66c2a4"</span>,<span class="st">"#2ca25f"</span>,<span class="st">"#006d2c"</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">make_sanfrancisco</span>(sanfrancisco_income,sanfrancisco_income<span class="sc">$</span>cat, <span class="st">"San Francisco County Median Income Distribution"</span>, <span class="st">"Median Income"</span>,cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/San Francisco Income map-1.png" class="img-fluid figure-img" width="720"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#edf8fb"</span>, <span class="st">"#b2e2e2"</span>,<span class="st">"#66c2a4"</span>,<span class="st">"#2ca25f"</span>,<span class="st">"#006d2c"</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">make_mesa</span>(mesa_income, mesa_income<span class="sc">$</span>cat,<span class="st">"Maricopa County Median Income Distribution"</span>, <span class="st">"Median Income"</span>,cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/Mesa Income Map-1.png" class="img-fluid figure-img" width="720"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>avg_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B07011_001"</span>),</span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="fu">summarize</span>(<span class="at">income =</span> <span class="fu">mean</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="st">"Average U.S County"</span>)</span>
<span id="cb19-8"><a href="#cb19-8"></a></span>
<span id="cb19-9"><a href="#cb19-9"></a>sf_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="at">state =</span> <span class="st">"CA"</span>,</span>
<span id="cb19-11"><a href="#cb19-11"></a>  <span class="at">county =</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb19-12"><a href="#cb19-12"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb19-13"><a href="#cb19-13"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B07011_001"</span>),</span>
<span id="cb19-14"><a href="#cb19-14"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>)</span>
<span id="cb19-16"><a href="#cb19-16"></a></span>
<span id="cb19-17"><a href="#cb19-17"></a>ms_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb19-18"><a href="#cb19-18"></a>  <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb19-19"><a href="#cb19-19"></a>  <span class="at">county =</span> <span class="st">"Maricopa"</span>,</span>
<span id="cb19-20"><a href="#cb19-20"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb19-21"><a href="#cb19-21"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B07011_001"</span>),</span>
<span id="cb19-22"><a href="#cb19-22"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb19-23"><a href="#cb19-23"></a>)</span>
<span id="cb19-24"><a href="#cb19-24"></a></span>
<span id="cb19-25"><a href="#cb19-25"></a>income_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sf_income, ms_income)<span class="sc">%&gt;%</span></span>
<span id="cb19-26"><a href="#cb19-26"></a>  <span class="fu">select</span>(NAME, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb19-27"><a href="#cb19-27"></a>  <span class="fu">rename</span>(<span class="st">"county"</span> <span class="ot">=</span> <span class="st">"NAME"</span>,</span>
<span id="cb19-28"><a href="#cb19-28"></a>         <span class="st">"income"</span> <span class="ot">=</span> <span class="st">"estimate"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb19-29"><a href="#cb19-29"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-30"><a href="#cb19-30"></a>    county <span class="sc">==</span> <span class="st">"San Francisco County, California"</span> <span class="sc">~</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb19-31"><a href="#cb19-31"></a>    county <span class="sc">==</span> <span class="st">"Maricopa County, Arizona"</span> <span class="sc">~</span> <span class="st">"Maricopa"</span>),</span>
<span id="cb19-32"><a href="#cb19-32"></a>    <span class="at">income =</span> income<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-33"><a href="#cb19-33"></a>  <span class="fu">rbind</span>(avg_income) </span>
<span id="cb19-34"><a href="#cb19-34"></a></span>
<span id="cb19-35"><a href="#cb19-35"></a><span class="fu">ggplot</span>(income_data, <span class="fu">aes</span>(<span class="at">x =</span> county, <span class="at">y =</span> income, <span class="at">fill =</span> county)) <span class="sc">+</span></span>
<span id="cb19-36"><a href="#cb19-36"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb19-37"><a href="#cb19-37"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-38"><a href="#cb19-38"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-39"><a href="#cb19-39"></a>    <span class="at">title =</span> <span class="st">"Average Annual Income in Two Counties"</span>,</span>
<span id="cb19-40"><a href="#cb19-40"></a>    <span class="at">x =</span> <span class="st">"County"</span>,</span>
<span id="cb19-41"><a href="#cb19-41"></a>    <span class="at">y =</span> <span class="st">"Income (thousand)"</span>,</span>
<span id="cb19-42"><a href="#cb19-42"></a>    <span class="at">fill =</span> <span class="st">"County"</span></span>
<span id="cb19-43"><a href="#cb19-43"></a>  ) <span class="sc">+</span></span>
<span id="cb19-44"><a href="#cb19-44"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb19-45"><a href="#cb19-45"></a>    <span class="st">"Average U.S County"</span> <span class="ot">=</span> <span class="st">"#7F7F7F"</span>,</span>
<span id="cb19-46"><a href="#cb19-46"></a>    <span class="st">"Maricopa"</span> <span class="ot">=</span> <span class="st">"#C0392B"</span>,</span>
<span id="cb19-47"><a href="#cb19-47"></a>    <span class="st">"San Francisco"</span> <span class="ot">=</span> <span class="st">"#2C7FB8"</span></span>
<span id="cb19-48"><a href="#cb19-48"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/Code for income barplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>#Income San Francisco county had a much larger average annual income ($69,000), than Maricopa ($43,000). However, they were both larger than the average U.S county annual income, which was only $35,000.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>,<span class="st">"#8289fe"</span>,<span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a>sf_education_map <span class="ot">&lt;-</span> <span class="fu">make_sanfrancisco</span>(sanfrancisco_education, sanfrancisco_education<span class="sc">$</span>majority, <span class="st">"San Francisco County"</span>, <span class="st">"Majority Education level"</span>, cols)</span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="fu">ggsave</span>(<span class="st">"sanfrancisco_education.png"</span>, sf_education_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>,<span class="st">"#6c31fd"</span>,<span class="st">"#8289fe"</span>,<span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a>mesa_education_map<span class="ot">&lt;-</span><span class="fu">make_mesa</span>(mesa_education, mesa_education<span class="sc">$</span>majority,<span class="st">"Maricopa"</span>, <span class="st">"Majority Education level"</span>, cols)</span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="fu">ggsave</span>(<span class="st">"mesa_education.png"</span>, mesa_education_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>education_bar_plot<span class="ot">&lt;-</span><span class="fu">ggplot</span>(education_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> prop, <span class="at">fill =</span> education)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Education Level across Two Counties"</span>,</span>
<span id="cb22-5"><a href="#cb22-5"></a>       <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span>,</span>
<span id="cb22-6"><a href="#cb22-6"></a>       <span class="at">y =</span> <span class="st">"Percent of Population"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Highest Education Attained"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)  <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="st">"#6c31fd"</span>,</span>
<span id="cb22-11"><a href="#cb22-11"></a>  <span class="st">"#8289fe"</span>,</span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="st">"#5fa09f"</span>,</span>
<span id="cb22-13"><a href="#cb22-13"></a>  <span class="st">"#fe8127"</span>,</span>
<span id="cb22-14"><a href="#cb22-14"></a>  <span class="st">"#fedf60"</span>,</span>
<span id="cb22-15"><a href="#cb22-15"></a>  <span class="st">"#d23743"</span></span>
<span id="cb22-16"><a href="#cb22-16"></a>))  <span class="sc">+</span> </span>
<span id="cb22-17"><a href="#cb22-17"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-19"><a href="#cb22-19"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.23</span>,<span class="fl">0.3</span>),</span>
<span id="cb22-20"><a href="#cb22-20"></a>        <span class="at">legend.direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb22-21"><a href="#cb22-21"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.315</span>, <span class="at">vjust =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb22-22"><a href="#cb22-22"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.265</span>, <span class="at">vjust =</span> <span class="dv">8</span>),</span>
<span id="cb22-23"><a href="#cb22-23"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="fl">6.5</span>, <span class="at">y =</span><span class="sc">-</span><span class="dv">32</span>, <span class="at">label =</span> <span class="st">"San Francisco County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y=</span> <span class="dv">22</span>, <span class="at">label =</span> <span class="st">"Maricopa County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb22-26"><a href="#cb22-26"></a>  <span class="co">#</span></span>
<span id="cb22-27"><a href="#cb22-27"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">6</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">10.05</span>, <span class="at">label =</span> <span class="st">"20.1%"</span>)<span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">22.65</span>, <span class="at">label =</span> <span class="st">"45.3%"</span>)<span class="sc">+</span></span>
<span id="cb22-29"><a href="#cb22-29"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">label =</span> <span class="st">"12.0%"</span>)<span class="sc">+</span></span>
<span id="cb22-30"><a href="#cb22-30"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span><span class="dv">3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">5.65</span>, <span class="at">label =</span> <span class="st">"11.3%"</span>)<span class="sc">+</span></span>
<span id="cb22-31"><a href="#cb22-31"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">3.75</span>, <span class="at">label =</span> <span class="st">"7.5%"</span>)<span class="sc">+</span></span>
<span id="cb22-32"><a href="#cb22-32"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">1</span>, <span class="at">y =</span><span class="sc">-</span><span class="fl">7.85</span>, <span class="at">label =</span> <span class="st">"3.7%"</span>)<span class="sc">+</span></span>
<span id="cb22-33"><a href="#cb22-33"></a>  </span>
<span id="cb22-34"><a href="#cb22-34"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">6</span>, <span class="at">y =</span> <span class="fl">5.65</span>, <span class="at">label =</span> <span class="st">"11.3%"</span>)<span class="sc">+</span></span>
<span id="cb22-35"><a href="#cb22-35"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fl">16.8</span>, <span class="at">label =</span> <span class="st">"33.6%"</span>)<span class="sc">+</span></span>
<span id="cb22-36"><a href="#cb22-36"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">11.3</span>, <span class="at">label =</span> <span class="st">"22.6%"</span>)<span class="sc">+</span></span>
<span id="cb22-37"><a href="#cb22-37"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">11.5</span>, <span class="at">label =</span> <span class="st">"22.0%"</span>)<span class="sc">+</span></span>
<span id="cb22-38"><a href="#cb22-38"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">4.3</span>, <span class="at">label =</span> <span class="st">"8.6%"</span>)<span class="sc">+</span></span>
<span id="cb22-39"><a href="#cb22-39"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">5.9</span>, <span class="at">label =</span> <span class="st">"1.9%"</span>)</span>
<span id="cb22-40"><a href="#cb22-40"></a></span>
<span id="cb22-41"><a href="#cb22-41"></a><span class="fu">ggsave</span>(<span class="st">"education_barplot.png"</span>, education_bar_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>household_map_sf <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"sanfrancisco_education.png"</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a>household_map_mesa <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"mesa_education.png"</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a>household_barplot_ig <span class="ot">&lt;-</span> <span class="fu">image_border</span>(<span class="fu">image_scale</span>(<span class="fu">image_read</span>(<span class="st">"education_barplot.png"</span>),<span class="st">"x1570"</span>), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">geometry =</span> <span class="st">"0x340"</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a>race_maps <span class="ot">&lt;-</span> <span class="fu">image_append</span>(<span class="fu">c</span>(household_map_sf,household_barplot_ig, household_map_mesa))</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="fu">image_write</span>(race_maps, <span class="at">path =</span> <span class="st">"education_plot.png"</span>, <span class="at">format =</span> <span class="st">"png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="education" class="level1 page-columns page-full"><h1>Education</h1>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p class="page-columns page-full"><img src="education_plot.png" class="column-screen img-fluid figure-img"></p>
<figcaption>Plot shows the distribution of the average highest level of education recieved in the two counties by census tract and as a county as a whole.</figcaption></figure>
</div>
<p>Our education plot was consistent with our other findings, where the information displayed is consistent with our prior thoughts. However, census tracts around both cities have a majority of people who answered the survey with an undergraduate degree as their highest level of education. This could be because Maricopa county is quite large, and incorporated more areas than San Francisco County, which could have resulted in the more even distribution of highest degree levels.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>radar_house <span class="ot">&lt;-</span> household_data <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>population) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">abs</span>(prop)) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb24-5"><a href="#cb24-5"></a>    <span class="at">names_from =</span> household,</span>
<span id="cb24-6"><a href="#cb24-6"></a>    <span class="at">values_from =</span> prop</span>
<span id="cb24-7"><a href="#cb24-7"></a>  )</span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a>radar_race <span class="ot">&lt;-</span> race_data <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="fu">select</span>(<span class="sc">-</span>population) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">abs</span>(prop)) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb24-13"><a href="#cb24-13"></a>    <span class="at">names_from =</span> race,</span>
<span id="cb24-14"><a href="#cb24-14"></a>    <span class="at">values_from =</span> prop</span>
<span id="cb24-15"><a href="#cb24-15"></a>  )</span>
<span id="cb24-16"><a href="#cb24-16"></a></span>
<span id="cb24-17"><a href="#cb24-17"></a>radar_education <span class="ot">&lt;-</span> education_data <span class="sc">%&gt;%</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">abs</span>(prop)) <span class="sc">%&gt;%</span></span>
<span id="cb24-19"><a href="#cb24-19"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb24-20"><a href="#cb24-20"></a>    <span class="at">names_from =</span> education,</span>
<span id="cb24-21"><a href="#cb24-21"></a>    <span class="at">values_from =</span> prop</span>
<span id="cb24-22"><a href="#cb24-22"></a>  )</span>
<span id="cb24-23"><a href="#cb24-23"></a></span>
<span id="cb24-24"><a href="#cb24-24"></a>radar_total <span class="ot">&lt;-</span> <span class="fu">cbind</span>(radar_house, radar_race <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>county), radar_education <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>county))</span>
<span id="cb24-25"><a href="#cb24-25"></a></span>
<span id="cb24-26"><a href="#cb24-26"></a><span class="fu">colnames</span>(radar_house) <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(<span class="fu">colnames</span>(radar_house), <span class="at">width =</span> <span class="dv">15</span>)</span>
<span id="cb24-27"><a href="#cb24-27"></a><span class="fu">colnames</span>(radar_race) <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(<span class="fu">colnames</span>(radar_race), <span class="at">width =</span> <span class="dv">15</span>)</span>
<span id="cb24-28"><a href="#cb24-28"></a><span class="fu">colnames</span>(radar_education) <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(<span class="fu">colnames</span>(radar_education), <span class="at">width =</span> <span class="dv">15</span>)</span>
<span id="cb24-29"><a href="#cb24-29"></a><span class="fu">colnames</span>(radar_total) <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(<span class="fu">colnames</span>(radar_total), <span class="at">width =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Radar with House Variables</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">ggradar</span>(</span>
<span id="cb25-3"><a href="#cb25-3"></a>  radar_house,</span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="at">group.colours =</span> <span class="fu">c</span>(<span class="st">"#C0392B"</span>, <span class="st">"#2C7FB8"</span>),</span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="at">axis.label.size =</span> <span class="dv">4</span>,</span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="at">grid.label.size =</span> <span class="dv">0</span>,</span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="at">axis.label.offset =</span> <span class="fl">1.2</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-10"><a href="#cb25-10"></a>    <span class="at">title =</span> <span class="st">"Household Comparision across Two Counties"</span>,</span>
<span id="cb25-11"><a href="#cb25-11"></a>    <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-14"><a href="#cb25-14"></a>  <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb25-15"><a href="#cb25-15"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb25-16"><a href="#cb25-16"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb25-17"><a href="#cb25-17"></a>  <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb25-18"><a href="#cb25-18"></a>) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"County"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Radar with Race Variables</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="fu">ggradar</span>(</span>
<span id="cb26-3"><a href="#cb26-3"></a>  radar_house,</span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="at">group.colours =</span> <span class="fu">c</span>(<span class="st">"#C0392B"</span>, <span class="st">"#2C7FB8"</span>),</span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="at">axis.label.size =</span> <span class="dv">4</span>,</span>
<span id="cb26-6"><a href="#cb26-6"></a>  <span class="at">grid.label.size =</span> <span class="dv">0</span>,</span>
<span id="cb26-7"><a href="#cb26-7"></a>  <span class="at">axis.label.offset =</span> <span class="fl">1.2</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-10"><a href="#cb26-10"></a>    <span class="at">title =</span> <span class="st">"Race Comparision across Two Counties"</span>,</span>
<span id="cb26-11"><a href="#cb26-11"></a>    <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-14"><a href="#cb26-14"></a>  <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-15"><a href="#cb26-15"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb26-16"><a href="#cb26-16"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb26-17"><a href="#cb26-17"></a>  <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb26-18"><a href="#cb26-18"></a>) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"County"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">ggradar</span>(</span>
<span id="cb27-2"><a href="#cb27-2"></a>  radar_education,</span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="at">group.colours =</span> <span class="fu">c</span>(<span class="st">"#C0392B"</span>, <span class="st">"#2C7FB8"</span>),</span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="at">axis.label.size =</span> <span class="dv">4</span>,</span>
<span id="cb27-5"><a href="#cb27-5"></a>  <span class="at">grid.label.size =</span> <span class="dv">0</span>,</span>
<span id="cb27-6"><a href="#cb27-6"></a>  <span class="at">axis.label.offset =</span> <span class="fl">1.2</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-9"><a href="#cb27-9"></a>    <span class="at">title =</span> <span class="st">"Education Comparision across Two Counties"</span>,</span>
<span id="cb27-10"><a href="#cb27-10"></a>    <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12"></a>  <span class="fu">theme</span>(</span>
<span id="cb27-13"><a href="#cb27-13"></a>  <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb27-15"><a href="#cb27-15"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb27-16"><a href="#cb27-16"></a>  <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb27-17"><a href="#cb27-17"></a>) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"County"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">ggradar</span>(</span>
<span id="cb28-2"><a href="#cb28-2"></a>  radar_total,</span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="at">group.colours =</span> <span class="fu">c</span>(<span class="st">"#C0392B"</span>, <span class="st">"#2C7FB8"</span>),</span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="at">axis.label.size =</span> <span class="dv">4</span>,</span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="at">grid.label.size =</span> <span class="dv">0</span>,</span>
<span id="cb28-6"><a href="#cb28-6"></a>  <span class="at">axis.label.offset =</span> <span class="fl">1.2</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-9"><a href="#cb28-9"></a>    <span class="at">title =</span> <span class="st">"All Variable Comparision across Two Counties"</span>,</span>
<span id="cb28-10"><a href="#cb28-10"></a>    <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-13"><a href="#cb28-13"></a>  <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-14"><a href="#cb28-14"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb28-15"><a href="#cb28-15"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb28-16"><a href="#cb28-16"></a>  <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb28-17"><a href="#cb28-17"></a>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"County"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section><section id="larger-scale" class="level1"><h1>Larger Scale</h1>
<p>We then decided to determine which variable had the largest discrepancy between San Francisco and Maricopa county. By creating a radar plot, we determined that the white population from the race data was the most different between the two counties.</p>
<p>When plotting the percentage of each state that is white who answered the survey, strong trends that we saw in our radar plots were not as strongly reflected, showing that at a larger scale, the states that are more white aren’t necessarily more conservative. We can see this most clearly with states such as Minnesota and Vermont, both of which run liberal, but also have a high percentage of white people. The opposite can be said for states like Texas and Florida, which both tend to be in the middle when it comes to the percentage of the population that is white, but they tend to run more conservative. This suggests that the trends we observed at the county level might not be able to be more widely applied at the state level.</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./eda/eda-member1.html" class="pagination-link" aria-label="Nico T">
        <span class="nav-page-text"><span class="chapter-title">Nico T</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb29" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1"></a><span class="co">---</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="an">title:</span><span class="co"> "A Tale of Two Counties"</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">---</span></span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="in">```{r loading libraries}</span></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="co">#| include: false</span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="fu">.libPaths</span>(<span class="st">"C:/R-packages"</span>)</span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="co"># loading libraries</span></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="fu">library</span>(stringr)</span>
<span id="cb29-11"><a href="#cb29-11"></a><span class="fu">library</span>(forcats)</span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="fu">library</span>(tidycensus) <span class="co"># Getting our data</span></span>
<span id="cb29-14"><a href="#cb29-14"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="fu">library</span>(grid) <span class="co"># For mapping inset graphs</span></span>
<span id="cb29-16"><a href="#cb29-16"></a><span class="fu">library</span>(classInt) <span class="co"># Making breaks</span></span>
<span id="cb29-17"><a href="#cb29-17"></a><span class="fu">library</span>(ggspatial) <span class="co"># For adding map annotations</span></span>
<span id="cb29-18"><a href="#cb29-18"></a><span class="fu">library</span>(magick) <span class="co">#for reading pngs</span></span>
<span id="cb29-19"><a href="#cb29-19"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb29-20"><a href="#cb29-20"></a><span class="fu">library</span>(ggradar)<span class="co"># For making the radar plots</span></span>
<span id="cb29-21"><a href="#cb29-21"></a></span>
<span id="cb29-22"><a href="#cb29-22"></a><span class="in">```</span></span>
<span id="cb29-23"><a href="#cb29-23"></a><span class="fu"># Intro</span></span>
<span id="cb29-24"><a href="#cb29-24"></a>  Life can be very different depending on what area you live in. For example, price of living, type of household one lives in, as well as how well educated you are, these are all influenced heavily by where you live in the United States. For our project, we wanted to choose two very different counties, comparing and contrasting the differences in the lifestyle of the average person living there.</span>
<span id="cb29-25"><a href="#cb29-25"></a></span>
<span id="cb29-26"><a href="#cb29-26"></a></span>
<span id="cb29-27"><a href="#cb29-27"></a><span class="fu"># ACS Background</span></span>
<span id="cb29-28"><a href="#cb29-28"></a>  The United States Census Bureau also collects the decennial census, which surveys every citizen in the United States on a ten year cycle. This survey often collects basic information about the population. The Census Bureau also runs the American Community Survey (ACS) which asks more in depth questions. The ACS does not survey all Americans like the census does, which can lead to possible margins of error which are also reported along with the data. Despite this, the ACS offers a deeper look into the demographics of the United States. This is why we chose to work with this data. To access the data from the ACS, we utilized the tidycensus package in RStudio. The tidycensus package allows users of RStudio streamlined access to the Census API, which allows developers to use census and ACS data. This made it easier for us to focus on the following cities and their counties.</span>
<span id="cb29-29"><a href="#cb29-29"></a></span>
<span id="cb29-30"><a href="#cb29-30"></a></span>
<span id="cb29-31"><a href="#cb29-31"></a><span class="fu"># Motivation</span></span>
<span id="cb29-32"><a href="#cb29-32"></a>  We decided to choose the two most politically different cities in the United States for our comparison. This paper by Pew Research did a study of the most liberal and conservative big cities in America, assigning each a value from -1 (very liberal) to +1 (very conservative). However, please note that big cities often tend towards liberalism, so while San Francisco (the most liberal city) was assigned a score of -1, Mesa (the most conservative city) was assigned a score of +0.4. To pull the census data, we used counties, so San Francisco became “San Francisco county,” and the city of Mesa became “Maricopa county.”</span>
<span id="cb29-33"><a href="#cb29-33"></a>  </span>
<span id="cb29-34"><a href="#cb29-34"></a><span class="fu"># Variable Choices</span></span>
<span id="cb29-35"><a href="#cb29-35"></a>  Along with our goal to see how polarization and demographics are related,  we decided to look at demographics that are most commonly associated with a conservative-liberal or democrat-split.</span>
<span id="cb29-36"><a href="#cb29-36"></a>     The first of these variables is race. In the American political climate, while political candidates tend to try to reach out to people of different races, they tend to focus their attention on one or two groups and address their issues. Typically, more liberal or democratic views are seen to appeal to more diverse groups while focusing on issues that concern them while more conservative views tend to focus on the average white American and less so on the entire population.</span>
<span id="cb29-37"><a href="#cb29-37"></a>    The next variable is types of households. What does the living situation of the people who answered the ACS in these areas look like? When listening to debates, you often hear conservatives advocating for traditional values and living situations such as married couples living together with their families and fulfilling the “American Dream”. Liberals don’t tend to have the same view, and value all types  of living situations. </span>
<span id="cb29-38"><a href="#cb29-38"></a>    Income is also a factor that comes into play in American Politics. Both conservative and liberal politicians claim to want to help the working class, however, year after year there seems to be more people from lower income brackets voting for the more conservative candidate.</span>
<span id="cb29-39"><a href="#cb29-39"></a>    The last variable that we will be analyzing is education. While education and income variables are pretty closely related (people with higher income are more likely to have a higher level of education), there is still a distinct relationship between education levels and the views of a person. Those who tend to have higher levels of income are assumed to be more liberal than those who have had a less rigorous education background. </span>
<span id="cb29-40"><a href="#cb29-40"></a>    Are these preconceptions consistent with the “most liberal” and “most conservative” cities in the United States and their surrounding areas? Or do we look at demographics too seriously when thinking about political backgrounds. </span>
<span id="cb29-41"><a href="#cb29-41"></a></span>
<span id="cb29-42"><a href="#cb29-42"></a></span>
<span id="cb29-43"><a href="#cb29-43"></a></span>
<span id="cb29-44"><a href="#cb29-44"></a><span class="in">```{r making funcitons for map data}</span></span>
<span id="cb29-45"><a href="#cb29-45"></a><span class="co"># Getting our data</span></span>
<span id="cb29-46"><a href="#cb29-46"></a><span class="co"># We are making a function to streamline our data collection from tidy census</span></span>
<span id="cb29-47"><a href="#cb29-47"></a></span>
<span id="cb29-48"><a href="#cb29-48"></a>get_data <span class="ot">&lt;-</span> <span class="cf">function</span>(city, variable_list){</span>
<span id="cb29-49"><a href="#cb29-49"></a>  <span class="cf">if</span>(city <span class="sc">==</span> <span class="st">"San Francisco"</span>){</span>
<span id="cb29-50"><a href="#cb29-50"></a>    <span class="fu">return</span>(<span class="fu">get_acs</span>(</span>
<span id="cb29-51"><a href="#cb29-51"></a>      <span class="at">state =</span> <span class="st">"CA"</span>,</span>
<span id="cb29-52"><a href="#cb29-52"></a>      <span class="at">county =</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-53"><a href="#cb29-53"></a>      <span class="at">geography =</span> <span class="st">"tract"</span>,</span>
<span id="cb29-54"><a href="#cb29-54"></a>      <span class="at">variables =</span> variable_list,</span>
<span id="cb29-55"><a href="#cb29-55"></a>      <span class="at">geometry =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-56"><a href="#cb29-56"></a>      <span class="at">year =</span> <span class="dv">2021</span></span>
<span id="cb29-57"><a href="#cb29-57"></a>    )</span>
<span id="cb29-58"><a href="#cb29-58"></a>    )</span>
<span id="cb29-59"><a href="#cb29-59"></a>  }</span>
<span id="cb29-60"><a href="#cb29-60"></a>  <span class="cf">else</span>{</span>
<span id="cb29-61"><a href="#cb29-61"></a>    <span class="fu">return</span>(<span class="fu">get_acs</span>(</span>
<span id="cb29-62"><a href="#cb29-62"></a>      <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb29-63"><a href="#cb29-63"></a>      <span class="at">county =</span> <span class="st">"Maricopa"</span>,</span>
<span id="cb29-64"><a href="#cb29-64"></a>      <span class="at">geography =</span> <span class="st">"tract"</span>,</span>
<span id="cb29-65"><a href="#cb29-65"></a>      <span class="at">variables =</span> variable_list,</span>
<span id="cb29-66"><a href="#cb29-66"></a>      <span class="at">geometry =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-67"><a href="#cb29-67"></a>      <span class="at">year =</span> <span class="dv">2021</span></span>
<span id="cb29-68"><a href="#cb29-68"></a>    )</span>
<span id="cb29-69"><a href="#cb29-69"></a>    )</span>
<span id="cb29-70"><a href="#cb29-70"></a>  }</span>
<span id="cb29-71"><a href="#cb29-71"></a>}</span>
<span id="cb29-72"><a href="#cb29-72"></a></span>
<span id="cb29-73"><a href="#cb29-73"></a><span class="in">```</span></span>
<span id="cb29-74"><a href="#cb29-74"></a></span>
<span id="cb29-75"><a href="#cb29-75"></a><span class="in">```{r making functions for data wrangling}</span></span>
<span id="cb29-76"><a href="#cb29-76"></a><span class="co"># Since we are going to be making two identical data sets for each variable we are looking at, it is useful to make a function to reduce clutter and chances or error</span></span>
<span id="cb29-77"><a href="#cb29-77"></a></span>
<span id="cb29-78"><a href="#cb29-78"></a><span class="co"># This function helps us turn or single value lists into a double</span></span>
<span id="cb29-79"><a href="#cb29-79"></a>convert_to_numeric <span class="ot">&lt;-</span> <span class="cf">function</span>(value){</span>
<span id="cb29-80"><a href="#cb29-80"></a>  <span class="fu">as.numeric</span>(<span class="fu">paste</span>(value))</span>
<span id="cb29-81"><a href="#cb29-81"></a>}</span>
<span id="cb29-82"><a href="#cb29-82"></a></span>
<span id="cb29-83"><a href="#cb29-83"></a><span class="co"># This function helps us do the wrangling for the race data</span></span>
<span id="cb29-84"><a href="#cb29-84"></a>wrangling_race <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb29-85"><a href="#cb29-85"></a>  data <span class="sc">|&gt;</span> </span>
<span id="cb29-86"><a href="#cb29-86"></a>    <span class="fu">select</span>(geometry,variable,estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-87"><a href="#cb29-87"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(variable <span class="sc">==</span> <span class="st">"B02001_002"</span> <span class="sc">~</span> <span class="st">"white_population"</span>,</span>
<span id="cb29-88"><a href="#cb29-88"></a>                                variable <span class="sc">==</span> <span class="st">"B02001_003"</span> <span class="sc">~</span> <span class="st">"black_african_american"</span>,</span>
<span id="cb29-89"><a href="#cb29-89"></a>                                variable <span class="sc">==</span> <span class="st">"B02001_004"</span> <span class="sc">~</span> <span class="st">"native_american"</span>,</span>
<span id="cb29-90"><a href="#cb29-90"></a>                                variable <span class="sc">==</span> <span class="st">"B02001_005"</span> <span class="sc">~</span> <span class="st">"asian"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-91"><a href="#cb29-91"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-92"><a href="#cb29-92"></a>    <span class="fu">mutate</span>(<span class="at">white_population =</span> <span class="fu">convert_to_numeric</span>(white_population),</span>
<span id="cb29-93"><a href="#cb29-93"></a>           <span class="at">black_african_american =</span> <span class="fu">convert_to_numeric</span>(black_african_american),</span>
<span id="cb29-94"><a href="#cb29-94"></a>           <span class="at">native_american =</span> <span class="fu">convert_to_numeric</span>(native_american),</span>
<span id="cb29-95"><a href="#cb29-95"></a>           <span class="at">asian =</span> <span class="fu">convert_to_numeric</span>(asian)) <span class="sc">|&gt;</span> </span>
<span id="cb29-96"><a href="#cb29-96"></a>    <span class="fu">mutate</span>(<span class="at">majority =</span> <span class="fu">case_when</span>(white_population <span class="sc">&gt;</span> black_african_american <span class="sc">&amp;</span> white_population <span class="sc">&gt;</span> native_american <span class="sc">&amp;</span> white_population <span class="sc">&gt;</span> asian <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb29-97"><a href="#cb29-97"></a>                                black_african_american <span class="sc">&gt;</span> white_population <span class="sc">&amp;</span> black_african_american <span class="sc">&gt;</span> native_american <span class="sc">&amp;</span> black_african_american <span class="sc">&gt;</span> asian <span class="sc">~</span> <span class="st">"Black/African American"</span>,</span>
<span id="cb29-98"><a href="#cb29-98"></a>                                native_american <span class="sc">&gt;</span> white_population <span class="sc">&amp;</span> native_american <span class="sc">&gt;</span> black_african_american <span class="sc">&amp;</span> native_american <span class="sc">&gt;</span> asian <span class="sc">~</span> <span class="st">"Native American"</span>,</span>
<span id="cb29-99"><a href="#cb29-99"></a>                                asian <span class="sc">&gt;</span> white_population <span class="sc">&amp;</span> asian <span class="sc">&gt;</span> black_african_american <span class="sc">&amp;</span> asian <span class="sc">&gt;</span> native_american <span class="sc">~</span> <span class="st">"Asian"</span>))</span>
<span id="cb29-100"><a href="#cb29-100"></a>}</span>
<span id="cb29-101"><a href="#cb29-101"></a></span>
<span id="cb29-102"><a href="#cb29-102"></a><span class="co"># This function helps us wrangle the education data</span></span>
<span id="cb29-103"><a href="#cb29-103"></a>wrangling_education <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb29-104"><a href="#cb29-104"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb29-105"><a href="#cb29-105"></a>    <span class="fu">select</span>(geometry,variable,estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-106"><a href="#cb29-106"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(variable <span class="sc">==</span> <span class="st">"B15003_002"</span> <span class="sc">~</span> <span class="st">"none"</span>,</span>
<span id="cb29-107"><a href="#cb29-107"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_003"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-108"><a href="#cb29-108"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_004"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-109"><a href="#cb29-109"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_005"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-110"><a href="#cb29-110"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_006"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-111"><a href="#cb29-111"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_007"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-112"><a href="#cb29-112"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_008"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-113"><a href="#cb29-113"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_009"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-114"><a href="#cb29-114"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_009"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-115"><a href="#cb29-115"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_010"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-116"><a href="#cb29-116"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_011"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-117"><a href="#cb29-117"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_012"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-118"><a href="#cb29-118"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_013"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-119"><a href="#cb29-119"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_014"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-120"><a href="#cb29-120"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_015"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-121"><a href="#cb29-121"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_016"</span> <span class="sc">~</span> <span class="st">"pre_highschool"</span>,</span>
<span id="cb29-122"><a href="#cb29-122"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_017"</span> <span class="sc">~</span> <span class="st">"highschool_or_equivalent"</span>,</span>
<span id="cb29-123"><a href="#cb29-123"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_018"</span> <span class="sc">~</span> <span class="st">"highschool_or_equivalent"</span>,</span>
<span id="cb29-124"><a href="#cb29-124"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_019"</span> <span class="sc">~</span> <span class="st">"some_college"</span>,</span>
<span id="cb29-125"><a href="#cb29-125"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_020"</span> <span class="sc">~</span> <span class="st">"some_college"</span>,</span>
<span id="cb29-126"><a href="#cb29-126"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_021"</span> <span class="sc">~</span> <span class="st">"undergraduate"</span>,</span>
<span id="cb29-127"><a href="#cb29-127"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_022"</span> <span class="sc">~</span> <span class="st">"undergraduate"</span>,</span>
<span id="cb29-128"><a href="#cb29-128"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_023"</span> <span class="sc">~</span> <span class="st">"undergraduate"</span>,</span>
<span id="cb29-129"><a href="#cb29-129"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_024"</span> <span class="sc">~</span> <span class="st">"graduate"</span>,</span>
<span id="cb29-130"><a href="#cb29-130"></a>                              variable <span class="sc">==</span> <span class="st">"B15003_025"</span> <span class="sc">~</span> <span class="st">"graduate"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-131"><a href="#cb29-131"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-132"><a href="#cb29-132"></a>    <span class="fu">mutate</span>(<span class="at">none =</span> <span class="fu">convert_to_numeric</span>(none),</span>
<span id="cb29-133"><a href="#cb29-133"></a>         <span class="at">pre_highschool =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(pre_highschool, sum)),</span>
<span id="cb29-134"><a href="#cb29-134"></a>         <span class="at">highschool_or_equivalent =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(highschool_or_equivalent, sum)),</span>
<span id="cb29-135"><a href="#cb29-135"></a>         <span class="at">some_college =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(some_college, sum)),</span>
<span id="cb29-136"><a href="#cb29-136"></a>         <span class="at">undergraduate =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(undergraduate, sum)),</span>
<span id="cb29-137"><a href="#cb29-137"></a>         <span class="at">graduate =</span> <span class="fu">convert_to_numeric</span>(<span class="fu">lapply</span>(graduate, sum))) <span class="sc">|&gt;</span> </span>
<span id="cb29-138"><a href="#cb29-138"></a>    <span class="fu">mutate</span>(<span class="at">majority =</span> <span class="fu">case_when</span>(none <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> none <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> none <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> none <span class="sc">&gt;</span> undergraduate <span class="sc">&amp;</span> none <span class="sc">&gt;</span> graduate <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb29-139"><a href="#cb29-139"></a>                                       pre_highschool <span class="sc">&gt;</span> none <span class="sc">&amp;</span> pre_highschool <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> pre_highschool <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> pre_highschool <span class="sc">&gt;</span> undergraduate <span class="sc">&amp;</span> pre_highschool <span class="sc">&gt;</span>graduate <span class="sc">~</span> <span class="st">"Pre-highschool"</span>,</span>
<span id="cb29-140"><a href="#cb29-140"></a>                                       highschool_or_equivalent <span class="sc">&gt;</span> none <span class="sc">&amp;</span> highschool_or_equivalent <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> highschool_or_equivalent <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> highschool_or_equivalent <span class="sc">&gt;</span> undergraduate <span class="sc">&amp;</span> highschool_or_equivalent <span class="sc">&gt;</span> graduate <span class="sc">~</span> <span class="st">"Highschool or Equivalent"</span>,</span>
<span id="cb29-141"><a href="#cb29-141"></a>                                       some_college <span class="sc">&gt;</span> none <span class="sc">&amp;</span> some_college <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> some_college <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> some_college <span class="sc">&gt;</span> undergraduate <span class="sc">&amp;</span> some_college <span class="sc">&gt;</span> graduate <span class="sc">~</span> <span class="st">"Some College"</span>,</span>
<span id="cb29-142"><a href="#cb29-142"></a>                                       undergraduate <span class="sc">&gt;</span> none <span class="sc">&amp;</span> undergraduate <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> undergraduate <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> undergraduate <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> undergraduate <span class="sc">&gt;</span> graduate <span class="sc">~</span> <span class="st">"Undergraduate Degree"</span>,</span>
<span id="cb29-143"><a href="#cb29-143"></a>                                       graduate <span class="sc">&gt;</span> none <span class="sc">&amp;</span> graduate <span class="sc">&gt;</span> pre_highschool <span class="sc">&amp;</span> graduate <span class="sc">&gt;</span> highschool_or_equivalent <span class="sc">&amp;</span> graduate <span class="sc">&gt;</span> some_college <span class="sc">&amp;</span> graduate <span class="sc">&gt;</span> undergraduate <span class="sc">~</span> <span class="st">"graduate"</span>))</span>
<span id="cb29-144"><a href="#cb29-144"></a>}</span>
<span id="cb29-145"><a href="#cb29-145"></a></span>
<span id="cb29-146"><a href="#cb29-146"></a><span class="co"># Function for wrangling the household data</span></span>
<span id="cb29-147"><a href="#cb29-147"></a>wrangling_households <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb29-148"><a href="#cb29-148"></a>  data <span class="sc">|&gt;</span> </span>
<span id="cb29-149"><a href="#cb29-149"></a>    <span class="fu">select</span>(geometry,variable,estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-150"><a href="#cb29-150"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(variable <span class="sc">==</span> <span class="st">"B11001_003"</span> <span class="sc">~</span> <span class="st">"married_couple"</span>,</span>
<span id="cb29-151"><a href="#cb29-151"></a>                                variable <span class="sc">==</span> <span class="st">"B11001_005"</span> <span class="sc">~</span> <span class="st">"male_householder"</span>,</span>
<span id="cb29-152"><a href="#cb29-152"></a>                                variable <span class="sc">==</span> <span class="st">"B11001_006"</span> <span class="sc">~</span> <span class="st">"female_householder"</span>,</span>
<span id="cb29-153"><a href="#cb29-153"></a>                                variable <span class="sc">==</span> <span class="st">"B11001_008"</span> <span class="sc">~</span> <span class="st">"lives_alone"</span>,</span>
<span id="cb29-154"><a href="#cb29-154"></a>                                variable <span class="sc">==</span> <span class="st">"B11001_009"</span> <span class="sc">~</span> <span class="st">"not_alone"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-155"><a href="#cb29-155"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-156"><a href="#cb29-156"></a>    <span class="fu">mutate</span>(<span class="at">married_couple =</span> <span class="fu">convert_to_numeric</span>(married_couple),</span>
<span id="cb29-157"><a href="#cb29-157"></a>           <span class="at">male_householder =</span> <span class="fu">convert_to_numeric</span>(male_householder),</span>
<span id="cb29-158"><a href="#cb29-158"></a>           <span class="at">female_householder =</span> <span class="fu">convert_to_numeric</span>(female_householder),</span>
<span id="cb29-159"><a href="#cb29-159"></a>           <span class="at">lives_alone =</span> <span class="fu">convert_to_numeric</span>(lives_alone),</span>
<span id="cb29-160"><a href="#cb29-160"></a>           <span class="at">not_alone =</span> <span class="fu">convert_to_numeric</span>(not_alone)) <span class="sc">|&gt;</span> </span>
<span id="cb29-161"><a href="#cb29-161"></a>    <span class="fu">mutate</span>(<span class="at">majority =</span> <span class="fu">case_when</span>(married_couple <span class="sc">&gt;</span> male_householder <span class="sc">&amp;</span> married_couple <span class="sc">&gt;</span> female_householder <span class="sc">&amp;</span> married_couple <span class="sc">&gt;</span> lives_alone <span class="sc">&amp;</span> married_couple <span class="sc">&gt;</span> not_alone <span class="sc">~</span> <span class="st">"Married couple (family)"</span>,</span>
<span id="cb29-162"><a href="#cb29-162"></a>                                male_householder <span class="sc">&gt;</span> married_couple <span class="sc">&amp;</span> male_householder <span class="sc">&gt;</span> female_householder <span class="sc">&amp;</span> male_householder <span class="sc">&gt;</span> lives_alone <span class="sc">&amp;</span> male_householder <span class="sc">&gt;</span> not_alone <span class="sc">~</span> <span class="st">"Male householder, no spouse (family)"</span>,</span>
<span id="cb29-163"><a href="#cb29-163"></a>                                female_householder <span class="sc">&gt;</span> married_couple <span class="sc">&amp;</span> female_householder <span class="sc">&gt;</span> male_householder <span class="sc">&amp;</span> female_householder <span class="sc">&gt;</span> lives_alone <span class="sc">&amp;</span> female_householder <span class="sc">&gt;</span> not_alone <span class="sc">~</span> <span class="st">"Female householder, no spouse (family)"</span>,</span>
<span id="cb29-164"><a href="#cb29-164"></a>                                lives_alone <span class="sc">&gt;</span> married_couple <span class="sc">&amp;</span> lives_alone <span class="sc">&gt;</span> male_householder <span class="sc">&amp;</span> lives_alone <span class="sc">&gt;</span> female_householder <span class="sc">&amp;</span> lives_alone <span class="sc">&gt;</span> not_alone <span class="sc">~</span> <span class="st">"Lives alone (non-family)"</span>,</span>
<span id="cb29-165"><a href="#cb29-165"></a>                                not_alone <span class="sc">&gt;</span> married_couple <span class="sc">&amp;</span> not_alone <span class="sc">&gt;</span> male_householder <span class="sc">&amp;</span> not_alone <span class="sc">&gt;</span> female_householder <span class="sc">&amp;</span> not_alone <span class="sc">&gt;</span> lives_alone <span class="sc">~</span> <span class="st">"Does not live alone (non-family)"</span>))</span>
<span id="cb29-166"><a href="#cb29-166"></a>}</span>
<span id="cb29-167"><a href="#cb29-167"></a></span>
<span id="cb29-168"><a href="#cb29-168"></a><span class="co"># This function helps us clean the data for median income</span></span>
<span id="cb29-169"><a href="#cb29-169"></a>median_income <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb29-170"><a href="#cb29-170"></a>  data <span class="sc">|&gt;</span> </span>
<span id="cb29-171"><a href="#cb29-171"></a>    <span class="fu">select</span>(geometry,variable,estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-172"><a href="#cb29-172"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-173"><a href="#cb29-173"></a>                              variable <span class="sc">==</span> <span class="st">"B07011_001"</span> <span class="sc">~</span> <span class="st">"median_income"</span></span>
<span id="cb29-174"><a href="#cb29-174"></a>                              )</span>
<span id="cb29-175"><a href="#cb29-175"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb29-176"><a href="#cb29-176"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-177"><a href="#cb29-177"></a>    <span class="fu">mutate</span>(<span class="at">median_income =</span> <span class="fu">as.numeric</span>(<span class="fu">paste</span>(median_income)))</span>
<span id="cb29-178"><a href="#cb29-178"></a>}</span>
<span id="cb29-179"><a href="#cb29-179"></a><span class="in">```</span></span>
<span id="cb29-180"><a href="#cb29-180"></a></span>
<span id="cb29-181"><a href="#cb29-181"></a><span class="in">```{r pulling San Francisco map data, include=FALSE}</span></span>
<span id="cb29-182"><a href="#cb29-182"></a><span class="co"># Getting all the San Francisco data we need</span></span>
<span id="cb29-183"><a href="#cb29-183"></a><span class="co"># Data for race in San Francisco</span></span>
<span id="cb29-184"><a href="#cb29-184"></a>sanfrancisco_race <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"San Francisco"</span>, <span class="fu">c</span>(<span class="st">"B02001_002"</span>, <span class="st">"B02001_003"</span>, <span class="st">"B02001_004"</span>, <span class="st">"B02001_005"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-185"><a href="#cb29-185"></a>  <span class="fu">wrangling_race</span>()</span>
<span id="cb29-186"><a href="#cb29-186"></a></span>
<span id="cb29-187"><a href="#cb29-187"></a><span class="co"># Data for households in San Francisco</span></span>
<span id="cb29-188"><a href="#cb29-188"></a>sanfrancisco_households <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"San Francisco"</span>, <span class="fu">c</span>(<span class="st">"B11001_003"</span>, <span class="st">"B11001_005"</span>, <span class="st">"B11001_006"</span>, <span class="st">"B11001_008"</span>,<span class="st">"B11001_009"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-189"><a href="#cb29-189"></a>  <span class="fu">wrangling_households</span>()</span>
<span id="cb29-190"><a href="#cb29-190"></a></span>
<span id="cb29-191"><a href="#cb29-191"></a><span class="co"># Data for income in San Francisco</span></span>
<span id="cb29-192"><a href="#cb29-192"></a>sanfrancisco_income <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"San Francisco"</span>, <span class="st">"B07011_001"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-193"><a href="#cb29-193"></a>  <span class="fu">median_income</span>()</span>
<span id="cb29-194"><a href="#cb29-194"></a></span>
<span id="cb29-195"><a href="#cb29-195"></a><span class="co"># Data for education in San Francisco</span></span>
<span id="cb29-196"><a href="#cb29-196"></a>sanfrancisco_education <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"San Francisco"</span>, <span class="fu">c</span>(<span class="st">"B15003_002"</span>, <span class="st">"B15003_003"</span>, <span class="st">"B15003_004"</span>, <span class="st">"B15003_005"</span>, <span class="st">"B15003_006"</span>, <span class="st">"B15003_007"</span>, <span class="st">"B15003_008"</span>, <span class="st">"B15003_009"</span>, <span class="st">"B15003_010"</span>, <span class="st">"B15003_011"</span>, <span class="st">"B15003_012"</span>, <span class="st">"B15003_013"</span>, <span class="st">"B15003_014"</span>, <span class="st">"B15003_015"</span>, <span class="st">"B15003_016"</span>, <span class="st">"B15003_017"</span>, <span class="st">"B15003_018"</span>, <span class="st">"B15003_019"</span>, <span class="st">"B15003_020"</span>, <span class="st">"B15003_021"</span>, <span class="st">"B15003_022"</span>, <span class="st">"B15003_023"</span>, <span class="st">"B15003_024"</span>, <span class="st">"B15003_025"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-197"><a href="#cb29-197"></a>  <span class="fu">wrangling_education</span>()</span>
<span id="cb29-198"><a href="#cb29-198"></a></span>
<span id="cb29-199"><a href="#cb29-199"></a><span class="co"># City Location </span></span>
<span id="cb29-200"><a href="#cb29-200"></a>sanfrancisco_city <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lat =</span> <span class="fl">37.7749</span>, <span class="at">long =</span> <span class="sc">-</span><span class="fl">122.4194</span>, <span class="at">name =</span> <span class="st">"San Fransisco"</span>)</span>
<span id="cb29-201"><a href="#cb29-201"></a></span>
<span id="cb29-202"><a href="#cb29-202"></a><span class="in">```</span></span>
<span id="cb29-203"><a href="#cb29-203"></a></span>
<span id="cb29-204"><a href="#cb29-204"></a><span class="in">```{r pulling Mesa map data, include=FALSE}</span></span>
<span id="cb29-205"><a href="#cb29-205"></a><span class="co"># Getting all the data for Mesa</span></span>
<span id="cb29-206"><a href="#cb29-206"></a><span class="co"># Data for race in Mesa</span></span>
<span id="cb29-207"><a href="#cb29-207"></a>mesa_race <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"Mesa"</span>, <span class="fu">c</span>(<span class="st">"B02001_002"</span>, <span class="st">"B02001_003"</span>, <span class="st">"B02001_004"</span>, <span class="st">"B02001_005"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-208"><a href="#cb29-208"></a>  <span class="fu">wrangling_race</span>()</span>
<span id="cb29-209"><a href="#cb29-209"></a></span>
<span id="cb29-210"><a href="#cb29-210"></a><span class="co"># Data for households in Mesa</span></span>
<span id="cb29-211"><a href="#cb29-211"></a>mesa_households <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"Mesa"</span>, <span class="fu">c</span>(<span class="st">"B11001_003"</span>, <span class="st">"B11001_005"</span>, <span class="st">"B11001_006"</span>, <span class="st">"B11001_008"</span>,<span class="st">"B11001_009"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-212"><a href="#cb29-212"></a>  <span class="fu">wrangling_households</span>()</span>
<span id="cb29-213"><a href="#cb29-213"></a></span>
<span id="cb29-214"><a href="#cb29-214"></a><span class="co"># Data for income in Mesa</span></span>
<span id="cb29-215"><a href="#cb29-215"></a>mesa_income <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"Mesa"</span>, <span class="st">"B07011_001"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-216"><a href="#cb29-216"></a>  <span class="fu">median_income</span>()</span>
<span id="cb29-217"><a href="#cb29-217"></a></span>
<span id="cb29-218"><a href="#cb29-218"></a><span class="co"># Data for education in Mesa</span></span>
<span id="cb29-219"><a href="#cb29-219"></a>mesa_education <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"Mesa"</span>, <span class="fu">c</span>(<span class="st">"B15003_002"</span>, <span class="st">"B15003_003"</span>, <span class="st">"B15003_004"</span>, <span class="st">"B15003_005"</span>, <span class="st">"B15003_006"</span>, <span class="st">"B15003_007"</span>, <span class="st">"B15003_008"</span>, <span class="st">"B15003_009"</span>, <span class="st">"B15003_010"</span>, <span class="st">"B15003_011"</span>, <span class="st">"B15003_012"</span>, <span class="st">"B15003_013"</span>, <span class="st">"B15003_014"</span>, <span class="st">"B15003_015"</span>, <span class="st">"B15003_016"</span>, <span class="st">"B15003_017"</span>, <span class="st">"B15003_018"</span>, <span class="st">"B15003_019"</span>, <span class="st">"B15003_020"</span>, <span class="st">"B15003_021"</span>, <span class="st">"B15003_022"</span>, <span class="st">"B15003_023"</span>, <span class="st">"B15003_024"</span>, <span class="st">"B15003_025"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-220"><a href="#cb29-220"></a>  <span class="fu">wrangling_education</span>()</span>
<span id="cb29-221"><a href="#cb29-221"></a></span>
<span id="cb29-222"><a href="#cb29-222"></a><span class="co"># City Location</span></span>
<span id="cb29-223"><a href="#cb29-223"></a>mesa_city <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">lat =</span> <span class="fl">33.4152</span>, <span class="at">long =</span> <span class="sc">-</span> <span class="fl">111.8315</span>, <span class="at">name =</span> <span class="st">"Mesa"</span>)</span>
<span id="cb29-224"><a href="#cb29-224"></a></span>
<span id="cb29-225"><a href="#cb29-225"></a><span class="in">```</span></span>
<span id="cb29-226"><a href="#cb29-226"></a></span>
<span id="cb29-227"><a href="#cb29-227"></a><span class="in">```{r pulling race data and wrangling for barplot, include=FALSE}</span></span>
<span id="cb29-228"><a href="#cb29-228"></a>sf_race <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb29-229"><a href="#cb29-229"></a>  <span class="at">state =</span> <span class="st">"CA"</span>,</span>
<span id="cb29-230"><a href="#cb29-230"></a>  <span class="at">county =</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-231"><a href="#cb29-231"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb29-232"><a href="#cb29-232"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B02001_002"</span>, <span class="st">"B02001_003"</span>, <span class="st">"B02001_004"</span>, <span class="st">"B02001_005"</span>, </span>
<span id="cb29-233"><a href="#cb29-233"></a>                <span class="st">"B02001_006"</span>, <span class="st">"B02001_007"</span>, <span class="st">"B02001_008"</span>),</span>
<span id="cb29-234"><a href="#cb29-234"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb29-235"><a href="#cb29-235"></a>)</span>
<span id="cb29-236"><a href="#cb29-236"></a></span>
<span id="cb29-237"><a href="#cb29-237"></a>ms_race <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb29-238"><a href="#cb29-238"></a>  <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb29-239"><a href="#cb29-239"></a>  <span class="at">county =</span> <span class="st">"Maricopa"</span>,</span>
<span id="cb29-240"><a href="#cb29-240"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb29-241"><a href="#cb29-241"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B02001_002"</span>, <span class="st">"B02001_003"</span>, <span class="st">"B02001_004"</span>, <span class="st">"B02001_005"</span>, </span>
<span id="cb29-242"><a href="#cb29-242"></a>                <span class="st">"B02001_006"</span>, <span class="st">"B02001_007"</span>, <span class="st">"B02001_008"</span>),</span>
<span id="cb29-243"><a href="#cb29-243"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb29-244"><a href="#cb29-244"></a>)</span>
<span id="cb29-245"><a href="#cb29-245"></a></span>
<span id="cb29-246"><a href="#cb29-246"></a>race_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sf_race, ms_race)<span class="sc">%&gt;%</span></span>
<span id="cb29-247"><a href="#cb29-247"></a>  <span class="fu">select</span>(NAME, variable, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb29-248"><a href="#cb29-248"></a>  <span class="fu">rename</span>(<span class="st">"county"</span> <span class="ot">=</span> <span class="st">"NAME"</span>,</span>
<span id="cb29-249"><a href="#cb29-249"></a>         <span class="st">"race"</span> <span class="ot">=</span> <span class="st">"variable"</span>,</span>
<span id="cb29-250"><a href="#cb29-250"></a>         <span class="st">"population"</span> <span class="ot">=</span> <span class="st">"estimate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-251"><a href="#cb29-251"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-252"><a href="#cb29-252"></a>    race <span class="sc">==</span> <span class="st">"B02001_002"</span> <span class="sc">~</span> <span class="st">"White"</span>,</span>
<span id="cb29-253"><a href="#cb29-253"></a>    race <span class="sc">==</span> <span class="st">"B02001_003"</span> <span class="sc">~</span> <span class="st">"Black"</span>,</span>
<span id="cb29-254"><a href="#cb29-254"></a>    race <span class="sc">==</span> <span class="st">"B02001_004"</span> <span class="sc">~</span> <span class="st">"American Indian"</span>,</span>
<span id="cb29-255"><a href="#cb29-255"></a>    race <span class="sc">==</span> <span class="st">"B02001_005"</span> <span class="sc">~</span> <span class="st">"Asian"</span>,</span>
<span id="cb29-256"><a href="#cb29-256"></a>    race <span class="sc">==</span> <span class="st">"B02001_006"</span> <span class="sc">~</span> <span class="st">"Pacific Islander"</span>,</span>
<span id="cb29-257"><a href="#cb29-257"></a>    race <span class="sc">==</span> <span class="st">"B02001_007"</span> <span class="sc">~</span> <span class="st">"Other"</span>,</span>
<span id="cb29-258"><a href="#cb29-258"></a>    race <span class="sc">==</span> <span class="st">"B02001_008"</span> <span class="sc">~</span> <span class="st">"Two or more races"</span></span>
<span id="cb29-259"><a href="#cb29-259"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-260"><a href="#cb29-260"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-261"><a href="#cb29-261"></a>    county <span class="sc">==</span> <span class="st">"San Francisco County, California"</span> <span class="sc">~</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-262"><a href="#cb29-262"></a>    county <span class="sc">==</span> <span class="st">"Maricopa County, Arizona"</span> <span class="sc">~</span> <span class="st">"Maricopa"</span></span>
<span id="cb29-263"><a href="#cb29-263"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-264"><a href="#cb29-264"></a>  <span class="fu">filter</span>(race <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"White"</span>, <span class="st">"Black"</span>, <span class="st">"Asian"</span>, <span class="st">"American Indian"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-265"><a href="#cb29-265"></a>  <span class="fu">mutate</span>(<span class="at">race =</span> <span class="fu">factor</span>(</span>
<span id="cb29-266"><a href="#cb29-266"></a>    race,</span>
<span id="cb29-267"><a href="#cb29-267"></a>    <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb29-268"><a href="#cb29-268"></a>      <span class="st">"American Indian"</span>,</span>
<span id="cb29-269"><a href="#cb29-269"></a>      <span class="st">"Black"</span>,</span>
<span id="cb29-270"><a href="#cb29-270"></a>      <span class="st">"Asian"</span>,</span>
<span id="cb29-271"><a href="#cb29-271"></a>      <span class="st">"White"</span></span>
<span id="cb29-272"><a href="#cb29-272"></a>    )</span>
<span id="cb29-273"><a href="#cb29-273"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-274"><a href="#cb29-274"></a>  <span class="fu">group_by</span>(county) <span class="sc">%&gt;%</span></span>
<span id="cb29-275"><a href="#cb29-275"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> population<span class="sc">/</span><span class="fu">sum</span>(population)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-276"><a href="#cb29-276"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">if_else</span>(</span>
<span id="cb29-277"><a href="#cb29-277"></a>    county <span class="sc">==</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-278"><a href="#cb29-278"></a>    <span class="sc">-</span>prop,</span>
<span id="cb29-279"><a href="#cb29-279"></a>    prop</span>
<span id="cb29-280"><a href="#cb29-280"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-281"><a href="#cb29-281"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb29-282"><a href="#cb29-282"></a><span class="in">```</span></span>
<span id="cb29-283"><a href="#cb29-283"></a></span>
<span id="cb29-284"><a href="#cb29-284"></a><span class="in">```{r pulling education data and wrangling for barplot}</span></span>
<span id="cb29-285"><a href="#cb29-285"></a>sf_ed <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb29-286"><a href="#cb29-286"></a>  <span class="at">state =</span> <span class="st">"CA"</span>,</span>
<span id="cb29-287"><a href="#cb29-287"></a>  <span class="at">county =</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-288"><a href="#cb29-288"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb29-289"><a href="#cb29-289"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B15003_002"</span>,<span class="st">"B15003_003"</span>,<span class="st">"B15003_004"</span>,<span class="st">"B15003_005"</span>,</span>
<span id="cb29-290"><a href="#cb29-290"></a>                <span class="st">"B15003_006"</span>,<span class="st">"B15003_007"</span>,<span class="st">"B15003_008"</span>,<span class="st">"B15003_009"</span>,<span class="st">"B15003_010"</span>,</span>
<span id="cb29-291"><a href="#cb29-291"></a>                <span class="st">"B15003_011"</span>,<span class="st">"B15003_012"</span>,<span class="st">"B15003_013"</span>,<span class="st">"B15003_014"</span>,<span class="st">"B15003_015"</span>,</span>
<span id="cb29-292"><a href="#cb29-292"></a>                <span class="st">"B15003_016"</span>,<span class="st">"B15003_017"</span>,<span class="st">"B15003_018"</span>,<span class="st">"B15003_019"</span>,<span class="st">"B15003_020"</span>,</span>
<span id="cb29-293"><a href="#cb29-293"></a>                <span class="st">"B15003_021"</span>,<span class="st">"B15003_022"</span>,<span class="st">"B15003_023"</span>,<span class="st">"B15003_024"</span>,<span class="st">"B15003_025"</span>),</span>
<span id="cb29-294"><a href="#cb29-294"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb29-295"><a href="#cb29-295"></a>) </span>
<span id="cb29-296"><a href="#cb29-296"></a></span>
<span id="cb29-297"><a href="#cb29-297"></a>ms_ed <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb29-298"><a href="#cb29-298"></a>  <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb29-299"><a href="#cb29-299"></a>  <span class="at">county =</span> <span class="st">"Maricopa"</span>,</span>
<span id="cb29-300"><a href="#cb29-300"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb29-301"><a href="#cb29-301"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B15003_002"</span>,<span class="st">"B15003_003"</span>,<span class="st">"B15003_004"</span>,<span class="st">"B15003_005"</span>,</span>
<span id="cb29-302"><a href="#cb29-302"></a>                <span class="st">"B15003_006"</span>,<span class="st">"B15003_007"</span>,<span class="st">"B15003_008"</span>,<span class="st">"B15003_009"</span>,<span class="st">"B15003_010"</span>,</span>
<span id="cb29-303"><a href="#cb29-303"></a>                <span class="st">"B15003_011"</span>,<span class="st">"B15003_012"</span>,<span class="st">"B15003_013"</span>,<span class="st">"B15003_014"</span>,<span class="st">"B15003_015"</span>,</span>
<span id="cb29-304"><a href="#cb29-304"></a>                <span class="st">"B15003_016"</span>,<span class="st">"B15003_017"</span>,<span class="st">"B15003_018"</span>,<span class="st">"B15003_019"</span>,<span class="st">"B15003_020"</span>,</span>
<span id="cb29-305"><a href="#cb29-305"></a>                <span class="st">"B15003_021"</span>,<span class="st">"B15003_022"</span>,<span class="st">"B15003_023"</span>,<span class="st">"B15003_024"</span>,<span class="st">"B15003_025"</span>),</span>
<span id="cb29-306"><a href="#cb29-306"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb29-307"><a href="#cb29-307"></a>)</span>
<span id="cb29-308"><a href="#cb29-308"></a></span>
<span id="cb29-309"><a href="#cb29-309"></a>education_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sf_ed, ms_ed) <span class="sc">%&gt;%</span> </span>
<span id="cb29-310"><a href="#cb29-310"></a>  <span class="fu">select</span>(NAME, variable, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb29-311"><a href="#cb29-311"></a>  <span class="fu">rename</span>(<span class="st">"county"</span> <span class="ot">=</span> <span class="st">"NAME"</span>,</span>
<span id="cb29-312"><a href="#cb29-312"></a>         <span class="st">"education"</span> <span class="ot">=</span> <span class="st">"variable"</span>,</span>
<span id="cb29-313"><a href="#cb29-313"></a>         <span class="st">"population"</span> <span class="ot">=</span> <span class="st">"estimate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-314"><a href="#cb29-314"></a>  <span class="fu">mutate</span>(<span class="at">education =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-315"><a href="#cb29-315"></a>    education <span class="sc">==</span> <span class="st">"B15003_002"</span> <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb29-316"><a href="#cb29-316"></a>    education <span class="sc">==</span> <span class="st">"B15003_003"</span> <span class="sc">~</span> <span class="st">"Nursery"</span>,</span>
<span id="cb29-317"><a href="#cb29-317"></a>    education <span class="sc">==</span> <span class="st">"B15003_004"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb29-318"><a href="#cb29-318"></a>    education <span class="sc">==</span> <span class="st">"B15003_005"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb29-319"><a href="#cb29-319"></a>    education <span class="sc">==</span> <span class="st">"B15003_006"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb29-320"><a href="#cb29-320"></a>    education <span class="sc">==</span> <span class="st">"B15003_007"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb29-321"><a href="#cb29-321"></a>    education <span class="sc">==</span> <span class="st">"B15003_008"</span> <span class="sc">~</span> <span class="st">"Kindergarten"</span>,</span>
<span id="cb29-322"><a href="#cb29-322"></a>    education <span class="sc">==</span> <span class="st">"B15003_009"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb29-323"><a href="#cb29-323"></a>    education <span class="sc">==</span> <span class="st">"B15003_010"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb29-324"><a href="#cb29-324"></a>    education <span class="sc">==</span> <span class="st">"B15003_011"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb29-325"><a href="#cb29-325"></a>    education <span class="sc">==</span> <span class="st">"B15003_012"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb29-326"><a href="#cb29-326"></a>    education <span class="sc">==</span> <span class="st">"B15003_013"</span> <span class="sc">~</span> <span class="st">"Middle"</span>,</span>
<span id="cb29-327"><a href="#cb29-327"></a>    education <span class="sc">==</span> <span class="st">"B15003_014"</span> <span class="sc">~</span> <span class="st">"Middle"</span>,</span>
<span id="cb29-328"><a href="#cb29-328"></a>    education <span class="sc">==</span> <span class="st">"B15003_015"</span> <span class="sc">~</span> <span class="st">"Middle"</span>,</span>
<span id="cb29-329"><a href="#cb29-329"></a>    education <span class="sc">==</span> <span class="st">"B15003_016"</span> <span class="sc">~</span> <span class="st">"Middle"</span>,</span>
<span id="cb29-330"><a href="#cb29-330"></a>    education <span class="sc">==</span> <span class="st">"B15003_017"</span> <span class="sc">~</span> <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb29-331"><a href="#cb29-331"></a>    education <span class="sc">==</span> <span class="st">"B15003_018"</span> <span class="sc">~</span> <span class="st">"GED"</span>,</span>
<span id="cb29-332"><a href="#cb29-332"></a>    education <span class="sc">==</span> <span class="st">"B15003_019"</span> <span class="sc">~</span> <span class="st">"Some College"</span>,</span>
<span id="cb29-333"><a href="#cb29-333"></a>    education <span class="sc">==</span> <span class="st">"B15003_020"</span> <span class="sc">~</span> <span class="st">"Some College"</span>,</span>
<span id="cb29-334"><a href="#cb29-334"></a>    education <span class="sc">==</span> <span class="st">"B15003_021"</span> <span class="sc">~</span> <span class="st">"Associate's"</span>,</span>
<span id="cb29-335"><a href="#cb29-335"></a>    education <span class="sc">==</span> <span class="st">"B15003_022"</span> <span class="sc">~</span> <span class="st">"Bachelor's"</span>,</span>
<span id="cb29-336"><a href="#cb29-336"></a>    education <span class="sc">==</span> <span class="st">"B15003_023"</span> <span class="sc">~</span> <span class="st">"Master's"</span>,</span>
<span id="cb29-337"><a href="#cb29-337"></a>    education <span class="sc">==</span> <span class="st">"B15003_024"</span> <span class="sc">~</span> <span class="st">"Professional"</span>,</span>
<span id="cb29-338"><a href="#cb29-338"></a>    education <span class="sc">==</span> <span class="st">"B15003_025"</span> <span class="sc">~</span> <span class="st">"Doctorate"</span></span>
<span id="cb29-339"><a href="#cb29-339"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-340"><a href="#cb29-340"></a>  <span class="fu">mutate</span>(<span class="at">education =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-341"><a href="#cb29-341"></a>    education <span class="sc">==</span> <span class="st">"None"</span> <span class="sc">~</span> <span class="st">"None"</span>,</span>
<span id="cb29-342"><a href="#cb29-342"></a>    education <span class="sc">==</span> <span class="st">"Nursery"</span> <span class="sc">~</span> <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb29-343"><a href="#cb29-343"></a>    education <span class="sc">==</span> <span class="st">"Kindergarten"</span> <span class="sc">~</span> <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb29-344"><a href="#cb29-344"></a>    education <span class="sc">==</span> <span class="st">"Elementary"</span> <span class="sc">~</span> <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb29-345"><a href="#cb29-345"></a>    education <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb29-346"><a href="#cb29-346"></a>    education <span class="sc">==</span> <span class="st">"Highschool (or equivalent)"</span> <span class="sc">~</span> <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb29-347"><a href="#cb29-347"></a>    education <span class="sc">==</span> <span class="st">"GED"</span> <span class="sc">~</span> <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb29-348"><a href="#cb29-348"></a>    education <span class="sc">==</span> <span class="st">"Some College"</span> <span class="sc">~</span> <span class="st">"Some College"</span>,</span>
<span id="cb29-349"><a href="#cb29-349"></a>    education <span class="sc">==</span> <span class="st">"Associate's"</span> <span class="sc">~</span> <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb29-350"><a href="#cb29-350"></a>    education <span class="sc">==</span> <span class="st">"Bachelor's"</span> <span class="sc">~</span> <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb29-351"><a href="#cb29-351"></a>    education <span class="sc">==</span> <span class="st">"Professional"</span> <span class="sc">~</span> <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb29-352"><a href="#cb29-352"></a>    education <span class="sc">==</span> <span class="st">"Master's"</span> <span class="sc">~</span> <span class="st">"Graduate Degree"</span>,</span>
<span id="cb29-353"><a href="#cb29-353"></a>    education <span class="sc">==</span> <span class="st">"Doctorate"</span> <span class="sc">~</span> <span class="st">"Graduate Degree"</span>,</span>
<span id="cb29-354"><a href="#cb29-354"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-355"><a href="#cb29-355"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-356"><a href="#cb29-356"></a>    county <span class="sc">==</span> <span class="st">"San Francisco County, California"</span> <span class="sc">~</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-357"><a href="#cb29-357"></a>    county <span class="sc">==</span> <span class="st">"Maricopa County, Arizona"</span> <span class="sc">~</span> <span class="st">"Maricopa"</span></span>
<span id="cb29-358"><a href="#cb29-358"></a>  ))<span class="sc">%&gt;%</span> </span>
<span id="cb29-359"><a href="#cb29-359"></a>  <span class="fu">group_by</span>(county) <span class="sc">%&gt;%</span></span>
<span id="cb29-360"><a href="#cb29-360"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> population <span class="sc">/</span> <span class="fu">sum</span>(population)) <span class="sc">%&gt;%</span></span>
<span id="cb29-361"><a href="#cb29-361"></a>  <span class="fu">mutate</span>(<span class="at">education =</span> <span class="fu">factor</span>(</span>
<span id="cb29-362"><a href="#cb29-362"></a>    education,</span>
<span id="cb29-363"><a href="#cb29-363"></a>    <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb29-364"><a href="#cb29-364"></a>      <span class="st">"Graduate Degree"</span>,</span>
<span id="cb29-365"><a href="#cb29-365"></a>      <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb29-366"><a href="#cb29-366"></a>      <span class="st">"Some College"</span>,</span>
<span id="cb29-367"><a href="#cb29-367"></a>      <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb29-368"><a href="#cb29-368"></a>      <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb29-369"><a href="#cb29-369"></a>      <span class="st">"None"</span></span>
<span id="cb29-370"><a href="#cb29-370"></a>    )</span>
<span id="cb29-371"><a href="#cb29-371"></a>  ))<span class="sc">%&gt;%</span></span>
<span id="cb29-372"><a href="#cb29-372"></a>  <span class="fu">group_by</span>(county, education) <span class="sc">%&gt;%</span></span>
<span id="cb29-373"><a href="#cb29-373"></a>  <span class="fu">summarize</span>(<span class="at">prop =</span> <span class="fu">sum</span>(prop)) <span class="sc">%&gt;%</span></span>
<span id="cb29-374"><a href="#cb29-374"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-375"><a href="#cb29-375"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> prop<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-376"><a href="#cb29-376"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">if_else</span>(</span>
<span id="cb29-377"><a href="#cb29-377"></a>    county <span class="sc">==</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-378"><a href="#cb29-378"></a>    <span class="sc">-</span>prop,</span>
<span id="cb29-379"><a href="#cb29-379"></a>    prop</span>
<span id="cb29-380"><a href="#cb29-380"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-381"><a href="#cb29-381"></a>  <span class="fu">mutate</span>(<span class="at">education =</span> <span class="fu">factor</span>(</span>
<span id="cb29-382"><a href="#cb29-382"></a>    education,</span>
<span id="cb29-383"><a href="#cb29-383"></a>    <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb29-384"><a href="#cb29-384"></a>      <span class="st">"None"</span>,</span>
<span id="cb29-385"><a href="#cb29-385"></a>      <span class="st">"Pre-Highschool"</span>,</span>
<span id="cb29-386"><a href="#cb29-386"></a>      <span class="st">"Highschool (or equivalent)"</span>,</span>
<span id="cb29-387"><a href="#cb29-387"></a>      <span class="st">"Some College"</span>,</span>
<span id="cb29-388"><a href="#cb29-388"></a>      <span class="st">"Undergraduate Degree (or equivalent)"</span>,</span>
<span id="cb29-389"><a href="#cb29-389"></a>      <span class="st">"Graduate Degree"</span></span>
<span id="cb29-390"><a href="#cb29-390"></a>    )</span>
<span id="cb29-391"><a href="#cb29-391"></a>  ))</span>
<span id="cb29-392"><a href="#cb29-392"></a><span class="in">```</span></span>
<span id="cb29-393"><a href="#cb29-393"></a></span>
<span id="cb29-394"><a href="#cb29-394"></a><span class="in">```{r pulling income data}</span></span>
<span id="cb29-395"><a href="#cb29-395"></a><span class="co"># data for maps</span></span>
<span id="cb29-396"><a href="#cb29-396"></a><span class="co"># Data for income in San Francisco</span></span>
<span id="cb29-397"><a href="#cb29-397"></a>sanfrancisco_income <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"San Francisco"</span>, <span class="st">"B07011_001"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-398"><a href="#cb29-398"></a>  <span class="fu">median_income</span>()</span>
<span id="cb29-399"><a href="#cb29-399"></a></span>
<span id="cb29-400"><a href="#cb29-400"></a><span class="co"># Data for income in Mesa</span></span>
<span id="cb29-401"><a href="#cb29-401"></a>mesa_income <span class="ot">&lt;-</span> <span class="fu">get_data</span>(<span class="st">"Mesa"</span>, <span class="st">"B07011_001"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-402"><a href="#cb29-402"></a>  <span class="fu">median_income</span>()</span>
<span id="cb29-403"><a href="#cb29-403"></a><span class="in">```</span></span>
<span id="cb29-404"><a href="#cb29-404"></a></span>
<span id="cb29-405"><a href="#cb29-405"></a></span>
<span id="cb29-406"><a href="#cb29-406"></a><span class="in">```{r making map breaks for income maps}</span></span>
<span id="cb29-407"><a href="#cb29-407"></a><span class="co"># For breaks we will use the Jenk's Natural Intervals method. This will help us create more natural intervals where the variance in each interval is minimized while the variance between intervals is maximized.</span></span>
<span id="cb29-408"><a href="#cb29-408"></a></span>
<span id="cb29-409"><a href="#cb29-409"></a><span class="co"># Since we want the maps to have the same breaks, we are going to combine our data to better create breaks that can be used across datasets</span></span>
<span id="cb29-410"><a href="#cb29-410"></a></span>
<span id="cb29-411"><a href="#cb29-411"></a><span class="co"># Making the breaks for white population maps</span></span>
<span id="cb29-412"><a href="#cb29-412"></a>money_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sanfrancisco_income, mesa_income)</span>
<span id="cb29-413"><a href="#cb29-413"></a></span>
<span id="cb29-414"><a href="#cb29-414"></a>income_ni <span class="ot">&lt;-</span> <span class="fu">classIntervals</span>(money_data<span class="sc">$</span>median_income,</span>
<span id="cb29-415"><a href="#cb29-415"></a>                              <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb29-416"><a href="#cb29-416"></a>                              <span class="at">style =</span> <span class="st">"jenks"</span></span>
<span id="cb29-417"><a href="#cb29-417"></a>                              )<span class="sc">$</span>brks</span>
<span id="cb29-418"><a href="#cb29-418"></a></span>
<span id="cb29-419"><a href="#cb29-419"></a>income_labels <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb29-420"><a href="#cb29-420"></a></span>
<span id="cb29-421"><a href="#cb29-421"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(income_ni)){</span>
<span id="cb29-422"><a href="#cb29-422"></a>  income_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb29-423"><a href="#cb29-423"></a>      income_labels, <span class="fu">paste0</span>(</span>
<span id="cb29-424"><a href="#cb29-424"></a>        <span class="st">"$"</span>, income_ni[i],</span>
<span id="cb29-425"><a href="#cb29-425"></a>        <span class="st">" to $"</span>,</span>
<span id="cb29-426"><a href="#cb29-426"></a>        income_ni[i<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb29-427"><a href="#cb29-427"></a>      )</span>
<span id="cb29-428"><a href="#cb29-428"></a>  )</span>
<span id="cb29-429"><a href="#cb29-429"></a>}</span>
<span id="cb29-430"><a href="#cb29-430"></a></span>
<span id="cb29-431"><a href="#cb29-431"></a>income_labels <span class="ot">&lt;-</span> income_labels[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(income_labels)<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb29-432"><a href="#cb29-432"></a></span>
<span id="cb29-433"><a href="#cb29-433"></a>sanfrancisco_income<span class="sc">$</span>cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb29-434"><a href="#cb29-434"></a>  sanfrancisco_income<span class="sc">$</span>median_income,</span>
<span id="cb29-435"><a href="#cb29-435"></a>  <span class="at">breaks =</span> income_ni,</span>
<span id="cb29-436"><a href="#cb29-436"></a>  <span class="at">labels =</span> income_labels,</span>
<span id="cb29-437"><a href="#cb29-437"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span></span>
<span id="cb29-438"><a href="#cb29-438"></a>)</span>
<span id="cb29-439"><a href="#cb29-439"></a></span>
<span id="cb29-440"><a href="#cb29-440"></a>mesa_income<span class="sc">$</span>cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb29-441"><a href="#cb29-441"></a>  mesa_income<span class="sc">$</span>median_income ,</span>
<span id="cb29-442"><a href="#cb29-442"></a>  <span class="at">breaks =</span> income_ni,</span>
<span id="cb29-443"><a href="#cb29-443"></a>  <span class="at">labels =</span> income_labels,</span>
<span id="cb29-444"><a href="#cb29-444"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span></span>
<span id="cb29-445"><a href="#cb29-445"></a>)</span>
<span id="cb29-446"><a href="#cb29-446"></a></span>
<span id="cb29-447"><a href="#cb29-447"></a><span class="in">```</span></span>
<span id="cb29-448"><a href="#cb29-448"></a></span>
<span id="cb29-449"><a href="#cb29-449"></a><span class="in">```{r pulling households data and wrangling for barplot}</span></span>
<span id="cb29-450"><a href="#cb29-450"></a>sf_households <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb29-451"><a href="#cb29-451"></a>  <span class="at">state =</span> <span class="st">"CA"</span>,</span>
<span id="cb29-452"><a href="#cb29-452"></a>  <span class="at">county =</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-453"><a href="#cb29-453"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb29-454"><a href="#cb29-454"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B11001_003"</span>, <span class="st">"B11001_005"</span>, <span class="st">"B11001_006"</span>, </span>
<span id="cb29-455"><a href="#cb29-455"></a>                <span class="st">"B11001_008"</span>, <span class="st">"B11001_009"</span>),</span>
<span id="cb29-456"><a href="#cb29-456"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb29-457"><a href="#cb29-457"></a>)</span>
<span id="cb29-458"><a href="#cb29-458"></a></span>
<span id="cb29-459"><a href="#cb29-459"></a>ms_households <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb29-460"><a href="#cb29-460"></a>  <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb29-461"><a href="#cb29-461"></a>  <span class="at">county =</span> <span class="st">"Maricopa"</span>,</span>
<span id="cb29-462"><a href="#cb29-462"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb29-463"><a href="#cb29-463"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B11001_003"</span>, <span class="st">"B11001_005"</span>, <span class="st">"B11001_006"</span>, </span>
<span id="cb29-464"><a href="#cb29-464"></a>                <span class="st">"B11001_008"</span>, <span class="st">"B11001_009"</span>),</span>
<span id="cb29-465"><a href="#cb29-465"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb29-466"><a href="#cb29-466"></a>)</span>
<span id="cb29-467"><a href="#cb29-467"></a></span>
<span id="cb29-468"><a href="#cb29-468"></a>household_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sf_households, ms_households) <span class="sc">%&gt;%</span></span>
<span id="cb29-469"><a href="#cb29-469"></a>  <span class="fu">select</span>(NAME, variable, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb29-470"><a href="#cb29-470"></a>  <span class="fu">rename</span>(<span class="st">"county"</span> <span class="ot">=</span> <span class="st">"NAME"</span>,</span>
<span id="cb29-471"><a href="#cb29-471"></a>         <span class="st">"household"</span> <span class="ot">=</span> <span class="st">"variable"</span>,</span>
<span id="cb29-472"><a href="#cb29-472"></a>         <span class="st">"population"</span> <span class="ot">=</span> <span class="st">"estimate"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb29-473"><a href="#cb29-473"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-474"><a href="#cb29-474"></a>    county <span class="sc">==</span> <span class="st">"San Francisco County, California"</span> <span class="sc">~</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-475"><a href="#cb29-475"></a>    county <span class="sc">==</span> <span class="st">"Maricopa County, Arizona"</span> <span class="sc">~</span> <span class="st">"Maricopa"</span></span>
<span id="cb29-476"><a href="#cb29-476"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-477"><a href="#cb29-477"></a>  <span class="fu">mutate</span>(<span class="at">household =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-478"><a href="#cb29-478"></a>    household <span class="sc">==</span> <span class="st">"B11001_003"</span> <span class="sc">~</span> <span class="st">"Married couple (family)"</span>,</span>
<span id="cb29-479"><a href="#cb29-479"></a>    household <span class="sc">==</span> <span class="st">"B11001_005"</span> <span class="sc">~</span> <span class="st">"Male householder, no spouse (family)"</span>,</span>
<span id="cb29-480"><a href="#cb29-480"></a>    household <span class="sc">==</span> <span class="st">"B11001_006"</span> <span class="sc">~</span> <span class="st">"Female householder, no spouse (family)"</span>,</span>
<span id="cb29-481"><a href="#cb29-481"></a>    household <span class="sc">==</span> <span class="st">"B11001_008"</span> <span class="sc">~</span> <span class="st">"Lives alone (non-family)"</span>,</span>
<span id="cb29-482"><a href="#cb29-482"></a>    household <span class="sc">==</span> <span class="st">"B11001_009"</span> <span class="sc">~</span> <span class="st">"Does not live alone (non-family)"</span></span>
<span id="cb29-483"><a href="#cb29-483"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb29-484"><a href="#cb29-484"></a>  <span class="fu">mutate</span>(<span class="at">household =</span> <span class="fu">factor</span>(</span>
<span id="cb29-485"><a href="#cb29-485"></a>    household,</span>
<span id="cb29-486"><a href="#cb29-486"></a>    <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb29-487"><a href="#cb29-487"></a>      <span class="st">"Lives alone (non-family)"</span>,</span>
<span id="cb29-488"><a href="#cb29-488"></a>      <span class="st">"Does not live alone (non-family)"</span>,</span>
<span id="cb29-489"><a href="#cb29-489"></a>      <span class="st">"Female householder, no spouse (family)"</span>,</span>
<span id="cb29-490"><a href="#cb29-490"></a>      <span class="st">"Male householder, no spouse (family)"</span>,</span>
<span id="cb29-491"><a href="#cb29-491"></a>      <span class="st">"Married couple (family)"</span></span>
<span id="cb29-492"><a href="#cb29-492"></a>    )</span>
<span id="cb29-493"><a href="#cb29-493"></a>  ))<span class="sc">%&gt;%</span></span>
<span id="cb29-494"><a href="#cb29-494"></a>  <span class="fu">group_by</span>(county) <span class="sc">%&gt;%</span></span>
<span id="cb29-495"><a href="#cb29-495"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> population<span class="sc">/</span><span class="fu">sum</span>(population)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-496"><a href="#cb29-496"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">if_else</span>(</span>
<span id="cb29-497"><a href="#cb29-497"></a>    county <span class="sc">==</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-498"><a href="#cb29-498"></a>    <span class="sc">-</span>prop,</span>
<span id="cb29-499"><a href="#cb29-499"></a>    prop</span>
<span id="cb29-500"><a href="#cb29-500"></a>  ))</span>
<span id="cb29-501"><a href="#cb29-501"></a>  </span>
<span id="cb29-502"><a href="#cb29-502"></a><span class="in">```</span></span>
<span id="cb29-503"><a href="#cb29-503"></a></span>
<span id="cb29-504"><a href="#cb29-504"></a><span class="in">```{r function for mapping San Francisco}</span></span>
<span id="cb29-505"><a href="#cb29-505"></a>make_sanfrancisco <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable, title_text, legend_name, colors){</span>
<span id="cb29-506"><a href="#cb29-506"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb29-507"><a href="#cb29-507"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> data,</span>
<span id="cb29-508"><a href="#cb29-508"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> variable),</span>
<span id="cb29-509"><a href="#cb29-509"></a>          <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-510"><a href="#cb29-510"></a>          <span class="at">size =</span> <span class="fl">0.5</span></span>
<span id="cb29-511"><a href="#cb29-511"></a>          )<span class="sc">+</span></span>
<span id="cb29-512"><a href="#cb29-512"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> sanfrancisco_city, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb29-513"><a href="#cb29-513"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> sanfrancisco_city, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">label =</span> name), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.04</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb29-514"><a href="#cb29-514"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">122.5</span>, <span class="sc">-</span><span class="fl">122.4</span>), </span>
<span id="cb29-515"><a href="#cb29-515"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb29-516"><a href="#cb29-516"></a>                     )<span class="sc">+</span></span>
<span id="cb29-517"><a href="#cb29-517"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">37.7</span>, <span class="fl">37.84</span>), </span>
<span id="cb29-518"><a href="#cb29-518"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb29-519"><a href="#cb29-519"></a>                     )<span class="sc">+</span></span>
<span id="cb29-520"><a href="#cb29-520"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb29-521"><a href="#cb29-521"></a>    <span class="at">name =</span> legend_name,</span>
<span id="cb29-522"><a href="#cb29-522"></a>    <span class="at">values =</span> colors</span>
<span id="cb29-523"><a href="#cb29-523"></a>  )<span class="sc">+</span></span>
<span id="cb29-524"><a href="#cb29-524"></a>  <span class="fu">guides</span>(</span>
<span id="cb29-525"><a href="#cb29-525"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb29-526"><a href="#cb29-526"></a>      <span class="at">direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb29-527"><a href="#cb29-527"></a>      <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>),</span>
<span id="cb29-528"><a href="#cb29-528"></a>      <span class="at">keywidth =</span> <span class="fu">unit</span>(<span class="dv">13</span>, <span class="st">"mm"</span>),</span>
<span id="cb29-529"><a href="#cb29-529"></a>      <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb29-530"><a href="#cb29-530"></a>      <span class="at">label.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb29-531"><a href="#cb29-531"></a>      <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb29-532"><a href="#cb29-532"></a>      <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb29-533"><a href="#cb29-533"></a>      <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb29-534"><a href="#cb29-534"></a>      <span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-535"><a href="#cb29-535"></a>    )</span>
<span id="cb29-536"><a href="#cb29-536"></a>  )<span class="sc">+</span></span>
<span id="cb29-537"><a href="#cb29-537"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-538"><a href="#cb29-538"></a>    <span class="at">title =</span> title_text</span>
<span id="cb29-539"><a href="#cb29-539"></a>  )<span class="sc">+</span></span>
<span id="cb29-540"><a href="#cb29-540"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb29-541"><a href="#cb29-541"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"tl"</span>,</span>
<span id="cb29-542"><a href="#cb29-542"></a>                         <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-543"><a href="#cb29-543"></a>                         <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">3.25</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-544"><a href="#cb29-544"></a>                         <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-545"><a href="#cb29-545"></a>                         <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-546"><a href="#cb29-546"></a>                         <span class="at">style =</span> <span class="fu">north_arrow_nautical</span>())<span class="sc">+</span></span>
<span id="cb29-547"><a href="#cb29-547"></a>  <span class="fu">annotation_scale</span>(<span class="at">plot_unit =</span> <span class="st">"mi"</span>,</span>
<span id="cb29-548"><a href="#cb29-548"></a>                   <span class="at">location =</span> <span class="st">"br"</span>,</span>
<span id="cb29-549"><a href="#cb29-549"></a>                   <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">4.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-550"><a href="#cb29-550"></a>                   <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">7.5</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb29-551"><a href="#cb29-551"></a>  <span class="fu">coord_sf</span>(<span class="at">clip =</span> <span class="st">"off"</span>)<span class="sc">+</span></span>
<span id="cb29-552"><a href="#cb29-552"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-553"><a href="#cb29-553"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb29-554"><a href="#cb29-554"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb29-555"><a href="#cb29-555"></a>                              <span class="at">size =</span> <span class="fl">15.75</span>,</span>
<span id="cb29-556"><a href="#cb29-556"></a>                              <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb29-557"><a href="#cb29-557"></a>                              <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb29-558"><a href="#cb29-558"></a>                              ),</span>
<span id="cb29-559"><a href="#cb29-559"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)</span>
<span id="cb29-560"><a href="#cb29-560"></a>  )</span>
<span id="cb29-561"><a href="#cb29-561"></a>}</span>
<span id="cb29-562"><a href="#cb29-562"></a><span class="in">```</span></span>
<span id="cb29-563"><a href="#cb29-563"></a></span>
<span id="cb29-564"><a href="#cb29-564"></a><span class="in">```{r function for mapping Mesa}</span></span>
<span id="cb29-565"><a href="#cb29-565"></a>make_mesa <span class="ot">&lt;-</span> <span class="cf">function</span>(data, variable, title_text, legend_name, colors){</span>
<span id="cb29-566"><a href="#cb29-566"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb29-567"><a href="#cb29-567"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> data,</span>
<span id="cb29-568"><a href="#cb29-568"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> variable),</span>
<span id="cb29-569"><a href="#cb29-569"></a>          <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-570"><a href="#cb29-570"></a>          <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb29-571"><a href="#cb29-571"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> mesa_city, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb29-572"><a href="#cb29-572"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> mesa_city, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">label =</span> name), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.04</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb29-573"><a href="#cb29-573"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb29-574"><a href="#cb29-574"></a>    <span class="at">name =</span> legend_name,</span>
<span id="cb29-575"><a href="#cb29-575"></a>    <span class="at">values =</span> colors)<span class="sc">+</span></span>
<span id="cb29-576"><a href="#cb29-576"></a>  <span class="fu">guides</span>(</span>
<span id="cb29-577"><a href="#cb29-577"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb29-578"><a href="#cb29-578"></a>      <span class="at">direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb29-579"><a href="#cb29-579"></a>      <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"mm"</span>),</span>
<span id="cb29-580"><a href="#cb29-580"></a>      <span class="at">keywidth =</span> <span class="fu">unit</span>(<span class="dv">13</span>, <span class="st">"mm"</span>),</span>
<span id="cb29-581"><a href="#cb29-581"></a>      <span class="at">title.position =</span> <span class="st">"top"</span>,</span>
<span id="cb29-582"><a href="#cb29-582"></a>      <span class="at">label.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb29-583"><a href="#cb29-583"></a>      <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb29-584"><a href="#cb29-584"></a>      <span class="at">label.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb29-585"><a href="#cb29-585"></a>      <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb29-586"><a href="#cb29-586"></a>      <span class="at">byrow =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb29-587"><a href="#cb29-587"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-588"><a href="#cb29-588"></a>    <span class="at">title =</span> title_text</span>
<span id="cb29-589"><a href="#cb29-589"></a>  )<span class="sc">+</span></span>
<span id="cb29-590"><a href="#cb29-590"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb29-591"><a href="#cb29-591"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">"tr"</span>,</span>
<span id="cb29-592"><a href="#cb29-592"></a>                         <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-593"><a href="#cb29-593"></a>                         <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-594"><a href="#cb29-594"></a>                         <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-595"><a href="#cb29-595"></a>                         <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.8</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-596"><a href="#cb29-596"></a>                         <span class="at">style =</span> <span class="fu">north_arrow_nautical</span>())<span class="sc">+</span></span>
<span id="cb29-597"><a href="#cb29-597"></a>  <span class="fu">annotation_scale</span>(<span class="at">plot_unit =</span> <span class="st">"mi"</span>,</span>
<span id="cb29-598"><a href="#cb29-598"></a>                   <span class="at">location =</span> <span class="st">"br"</span>,</span>
<span id="cb29-599"><a href="#cb29-599"></a>                   <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="fl">2.5</span>, <span class="st">"cm"</span>),</span>
<span id="cb29-600"><a href="#cb29-600"></a>                   <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">5.5</span>, <span class="st">"cm"</span>))<span class="sc">+</span></span>
<span id="cb29-601"><a href="#cb29-601"></a>  <span class="fu">coord_sf</span>(<span class="at">clip =</span> <span class="st">"off"</span>)<span class="sc">+</span></span>
<span id="cb29-602"><a href="#cb29-602"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-603"><a href="#cb29-603"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb29-604"><a href="#cb29-604"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb29-605"><a href="#cb29-605"></a>                              <span class="at">size =</span> <span class="fl">15.75</span>,</span>
<span id="cb29-606"><a href="#cb29-606"></a>                              <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb29-607"><a href="#cb29-607"></a>                              <span class="at">hjust =</span> <span class="fl">0.5</span></span>
<span id="cb29-608"><a href="#cb29-608"></a>                              ),</span>
<span id="cb29-609"><a href="#cb29-609"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)</span>
<span id="cb29-610"><a href="#cb29-610"></a>  )</span>
<span id="cb29-611"><a href="#cb29-611"></a>}</span>
<span id="cb29-612"><a href="#cb29-612"></a><span class="in">```</span></span>
<span id="cb29-613"><a href="#cb29-613"></a></span>
<span id="cb29-614"><a href="#cb29-614"></a><span class="in">```{r San Francisco Race map, fig.height=7.5, fig.width=7.5}</span></span>
<span id="cb29-615"><a href="#cb29-615"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>,<span class="st">"#6c31fd"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb29-616"><a href="#cb29-616"></a></span>
<span id="cb29-617"><a href="#cb29-617"></a>sanfrancisco_race_map <span class="ot">&lt;-</span> <span class="fu">make_sanfrancisco</span>(<span class="at">data =</span> sanfrancisco_race, <span class="at">variable =</span> sanfrancisco_race<span class="sc">$</span>majority, <span class="at">title_text =</span>  <span class="st">"San Francisco County"</span>, <span class="at">legend_name =</span> <span class="st">"Predominate Race in Census Tract"</span>, <span class="at">colors =</span> cols)</span>
<span id="cb29-618"><a href="#cb29-618"></a></span>
<span id="cb29-619"><a href="#cb29-619"></a><span class="fu">ggsave</span>(<span class="st">"sanfrancisco_race_map.png"</span>, sanfrancisco_race_map)</span>
<span id="cb29-620"><a href="#cb29-620"></a><span class="in">```</span></span>
<span id="cb29-621"><a href="#cb29-621"></a></span>
<span id="cb29-622"><a href="#cb29-622"></a><span class="in">```{r Mesa Race Map, fig.height=7.5, fig.width=7.5}</span></span>
<span id="cb29-623"><a href="#cb29-623"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>, <span class="st">"#6c31fd"</span>, <span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb29-624"><a href="#cb29-624"></a></span>
<span id="cb29-625"><a href="#cb29-625"></a>mesa_race_map <span class="ot">&lt;-</span><span class="fu">make_mesa</span>(<span class="at">data =</span> mesa_race, mesa_race<span class="sc">$</span>majority, <span class="st">"Maricopa County"</span>, <span class="st">"Predominate Race in Census Tract"</span>, cols)</span>
<span id="cb29-626"><a href="#cb29-626"></a></span>
<span id="cb29-627"><a href="#cb29-627"></a><span class="fu">ggsave</span>(<span class="st">"mesa_race.png"</span>, mesa_race_map)</span>
<span id="cb29-628"><a href="#cb29-628"></a><span class="in">```</span></span>
<span id="cb29-629"><a href="#cb29-629"></a></span>
<span id="cb29-630"><a href="#cb29-630"></a><span class="in">```{r Race Barplot, fig.width=10, fig.height=7.5}</span></span>
<span id="cb29-631"><a href="#cb29-631"></a>race_barplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(race_data, <span class="fu">aes</span>(<span class="at">x =</span> race, <span class="at">y =</span> prop, <span class="at">fill =</span> race)) <span class="sc">+</span></span>
<span id="cb29-632"><a href="#cb29-632"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb29-633"><a href="#cb29-633"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb29-634"><a href="#cb29-634"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Race Distribution in the Two Counties"</span>,</span>
<span id="cb29-635"><a href="#cb29-635"></a>       <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span>,</span>
<span id="cb29-636"><a href="#cb29-636"></a>       <span class="at">y =</span> <span class="st">"Percent of Population"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Race Group"</span>) <span class="sc">+</span></span>
<span id="cb29-637"><a href="#cb29-637"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb29-638"><a href="#cb29-638"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb29-639"><a href="#cb29-639"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb29-640"><a href="#cb29-640"></a>  <span class="st">"#fe8127"</span>,</span>
<span id="cb29-641"><a href="#cb29-641"></a>  <span class="st">"#6c31fd"</span>,</span>
<span id="cb29-642"><a href="#cb29-642"></a>  <span class="st">"#5fa09f"</span>,</span>
<span id="cb29-643"><a href="#cb29-643"></a>  <span class="st">"#fedf60"</span></span>
<span id="cb29-644"><a href="#cb29-644"></a>))  <span class="sc">+</span> </span>
<span id="cb29-645"><a href="#cb29-645"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb29-646"><a href="#cb29-646"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-647"><a href="#cb29-647"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.7</span>,<span class="fl">0.4</span>),</span>
<span id="cb29-648"><a href="#cb29-648"></a>        <span class="at">legend.direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb29-649"><a href="#cb29-649"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.315</span>, <span class="at">vjust =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb29-650"><a href="#cb29-650"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.265</span>, <span class="at">vjust =</span> <span class="dv">8</span>),</span>
<span id="cb29-651"><a href="#cb29-651"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb29-652"><a href="#cb29-652"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="fl">4.5</span>, <span class="at">y =</span><span class="sc">-</span><span class="dv">30</span>, <span class="at">label =</span> <span class="st">"San Francisco County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb29-653"><a href="#cb29-653"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.5</span>, <span class="at">y=</span> <span class="dv">30</span>, <span class="at">label =</span> <span class="st">"Maricopa County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb29-654"><a href="#cb29-654"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">24.93</span>, <span class="at">label =</span> <span class="st">"49.9%"</span>)<span class="sc">+</span></span>
<span id="cb29-655"><a href="#cb29-655"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span><span class="dv">3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">21.53</span>, <span class="at">label =</span> <span class="st">"43.0%"</span>)<span class="sc">+</span></span>
<span id="cb29-656"><a href="#cb29-656"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">12.3</span>, <span class="at">label =</span> <span class="st">"6.3%"</span>)<span class="sc">+</span></span>
<span id="cb29-657"><a href="#cb29-657"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">1</span>, <span class="at">y =</span><span class="sc">-</span><span class="fl">6.8</span>, <span class="at">label =</span> <span class="st">"0.8%"</span>)<span class="sc">+</span></span>
<span id="cb29-658"><a href="#cb29-658"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">41.95</span>, <span class="at">label =</span> <span class="st">"83.9%"</span>)<span class="sc">+</span></span>
<span id="cb29-659"><a href="#cb29-659"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">11.8</span>, <span class="at">label =</span> <span class="st">"5.9%"</span>)<span class="sc">+</span></span>
<span id="cb29-660"><a href="#cb29-660"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">13.68</span>, <span class="at">label =</span> <span class="st">"7.7%"</span>)<span class="sc">+</span></span>
<span id="cb29-661"><a href="#cb29-661"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">8.58</span>, <span class="at">label =</span> <span class="st">"2.5%"</span>)<span class="sc">+</span></span>
<span id="cb29-662"><a href="#cb29-662"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">60</span>, <span class="at">label =</span> <span class="st">"Map colors are the same as this graph, except that the </span><span class="sc">\n</span><span class="st"> color represents the race that is makes up the majority of the </span><span class="sc">\n</span><span class="st"> population in the census tract."</span>)</span>
<span id="cb29-663"><a href="#cb29-663"></a></span>
<span id="cb29-664"><a href="#cb29-664"></a><span class="fu">ggsave</span>(<span class="st">"race_barplot.png"</span>, race_barplot)</span>
<span id="cb29-665"><a href="#cb29-665"></a><span class="in">```</span></span>
<span id="cb29-666"><a href="#cb29-666"></a></span>
<span id="cb29-667"><a href="#cb29-667"></a><span class="in">```{r Combining Race Plots}</span></span>
<span id="cb29-668"><a href="#cb29-668"></a>race_map_sf <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"sanfrancisco_race_map.png"</span>)</span>
<span id="cb29-669"><a href="#cb29-669"></a>race_map_mesa <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"mesa_race.png"</span>)</span>
<span id="cb29-670"><a href="#cb29-670"></a>race_barplot_ig <span class="ot">&lt;-</span> <span class="fu">image_border</span>(<span class="fu">image_scale</span>(<span class="fu">image_read</span>(<span class="st">"race_barplot.png"</span>),<span class="st">"x1570"</span>), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">geometry =</span> <span class="st">"0x340"</span>)</span>
<span id="cb29-671"><a href="#cb29-671"></a>race_maps <span class="ot">&lt;-</span> <span class="fu">image_append</span>(<span class="fu">c</span>(race_map_sf,race_barplot_ig, race_map_mesa))</span>
<span id="cb29-672"><a href="#cb29-672"></a><span class="fu">image_write</span>(race_maps, <span class="at">path =</span> <span class="st">"race_plot.png"</span>, <span class="at">format =</span> <span class="st">"png"</span>)</span>
<span id="cb29-673"><a href="#cb29-673"></a><span class="in">```</span></span>
<span id="cb29-674"><a href="#cb29-674"></a></span>
<span id="cb29-675"><a href="#cb29-675"></a><span class="fu"># Race</span></span>
<span id="cb29-676"><a href="#cb29-676"></a><span class="al">![Plot shows the distribution of race in the two counties by census tract and as a county as a whole](race_plot.png)</span>{.column-screen}</span>
<span id="cb29-677"><a href="#cb29-677"></a></span>
<span id="cb29-678"><a href="#cb29-678"></a>San Francisco county was predominantly white (49.9%), with also a large Asian population, and a smaller Black and American Indian population. Maricopa county, on the other hand, was overwhelmingly white (83.9%), with a smaller Asian, Black, and American Indian population.</span>
<span id="cb29-679"><a href="#cb29-679"></a></span>
<span id="cb29-680"><a href="#cb29-680"></a></span>
<span id="cb29-681"><a href="#cb29-681"></a><span class="in">```{r making San Francisco Household Type Map, fig.height= 7.5, fig.width = 7.5}</span></span>
<span id="cb29-682"><a href="#cb29-682"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>, <span class="st">"#8289fe"</span>, <span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb29-683"><a href="#cb29-683"></a>sanfrancisco_household_map <span class="ot">&lt;-</span> <span class="fu">make_sanfrancisco</span>(sanfrancisco_households, sanfrancisco_households<span class="sc">$</span>majority, <span class="st">"San Francisco County"</span>, <span class="st">"Majority Education level"</span>, cols)</span>
<span id="cb29-684"><a href="#cb29-684"></a></span>
<span id="cb29-685"><a href="#cb29-685"></a><span class="fu">ggsave</span>(<span class="st">"sanfrancisco_households.png"</span>, sanfrancisco_household_map)</span>
<span id="cb29-686"><a href="#cb29-686"></a><span class="in">```</span></span>
<span id="cb29-687"><a href="#cb29-687"></a></span>
<span id="cb29-688"><a href="#cb29-688"></a><span class="in">```{r Making Mesa Household Map, fig.height=7.5, fig.width=7.5}</span></span>
<span id="cb29-689"><a href="#cb29-689"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>, <span class="st">"#8289fe"</span>, <span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb29-690"><a href="#cb29-690"></a></span>
<span id="cb29-691"><a href="#cb29-691"></a>mesa_households_map <span class="ot">&lt;-</span> <span class="fu">make_mesa</span>(mesa_households,mesa_households<span class="sc">$</span>majority, <span class="st">"Maricopa County"</span>, <span class="st">"Household Type"</span>, cols)</span>
<span id="cb29-692"><a href="#cb29-692"></a></span>
<span id="cb29-693"><a href="#cb29-693"></a><span class="fu">ggsave</span>(<span class="st">"mesa_households.png"</span>, mesa_households_map)</span>
<span id="cb29-694"><a href="#cb29-694"></a><span class="in">```</span></span>
<span id="cb29-695"><a href="#cb29-695"></a></span>
<span id="cb29-696"><a href="#cb29-696"></a><span class="in">```{r Household bargraph, fig.width= 10, fig.height = 7.5}</span></span>
<span id="cb29-697"><a href="#cb29-697"></a>household_barplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(household_data, <span class="fu">aes</span>(<span class="at">x =</span> household, <span class="at">y =</span> prop, <span class="at">fill =</span> household)) <span class="sc">+</span></span>
<span id="cb29-698"><a href="#cb29-698"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb29-699"><a href="#cb29-699"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb29-700"><a href="#cb29-700"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Household Comparision across Two Counties"</span>,</span>
<span id="cb29-701"><a href="#cb29-701"></a>       <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span>,</span>
<span id="cb29-702"><a href="#cb29-702"></a>         <span class="at">y =</span> <span class="st">"Percent of Population"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Household Type"</span>) <span class="sc">+</span></span>
<span id="cb29-703"><a href="#cb29-703"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb29-704"><a href="#cb29-704"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb29-705"><a href="#cb29-705"></a>  <span class="st">"#fe8127"</span>,</span>
<span id="cb29-706"><a href="#cb29-706"></a>  <span class="st">"#5fa09f"</span>,</span>
<span id="cb29-707"><a href="#cb29-707"></a>  <span class="st">"#8289fe"</span>,</span>
<span id="cb29-708"><a href="#cb29-708"></a>  <span class="st">"#6c31fd"</span>,</span>
<span id="cb29-709"><a href="#cb29-709"></a>  <span class="st">"#fedf60"</span></span>
<span id="cb29-710"><a href="#cb29-710"></a>)) <span class="sc">+</span></span>
<span id="cb29-711"><a href="#cb29-711"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb29-712"><a href="#cb29-712"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb29-713"><a href="#cb29-713"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-714"><a href="#cb29-714"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.84</span>,<span class="fl">0.47</span>),</span>
<span id="cb29-715"><a href="#cb29-715"></a>        <span class="at">legend.direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb29-716"><a href="#cb29-716"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.315</span>, <span class="at">vjust =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb29-717"><a href="#cb29-717"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.265</span>, <span class="at">vjust =</span> <span class="dv">8</span>),</span>
<span id="cb29-718"><a href="#cb29-718"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb29-719"><a href="#cb29-719"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="fl">5.5</span>, <span class="at">y =</span><span class="sc">-</span><span class="dv">30</span>, <span class="at">label =</span> <span class="st">"San Francisco County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb29-720"><a href="#cb29-720"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">5.5</span>, <span class="at">y=</span> <span class="dv">30</span>, <span class="at">label =</span> <span class="st">"Maricopa County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb29-721"><a href="#cb29-721"></a></span>
<span id="cb29-722"><a href="#cb29-722"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">17.75</span>, <span class="at">label =</span> <span class="st">"35.5%"</span>)<span class="sc">+</span></span>
<span id="cb29-723"><a href="#cb29-723"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">9.5</span>, <span class="at">label =</span> <span class="st">"3.5%"</span>)<span class="sc">+</span></span>
<span id="cb29-724"><a href="#cb29-724"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span><span class="dv">3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">3.85</span>, <span class="at">label =</span> <span class="st">"7.7%"</span>)<span class="sc">+</span></span>
<span id="cb29-725"><a href="#cb29-725"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">7.6</span>, <span class="at">label =</span> <span class="st">"15.2%"</span>)<span class="sc">+</span></span>
<span id="cb29-726"><a href="#cb29-726"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">1</span>, <span class="at">y =</span><span class="sc">-</span><span class="dv">19</span>, <span class="at">label =</span> <span class="st">"38.0%"</span>)<span class="sc">+</span></span>
<span id="cb29-727"><a href="#cb29-727"></a>  </span>
<span id="cb29-728"><a href="#cb29-728"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fl">23.65</span>, <span class="at">label =</span> <span class="st">"47.3%"</span>)<span class="sc">+</span></span>
<span id="cb29-729"><a href="#cb29-729"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">11.7</span>, <span class="at">label =</span> <span class="st">"5.7%"</span>)<span class="sc">+</span></span>
<span id="cb29-730"><a href="#cb29-730"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">6</span>, <span class="at">label =</span> <span class="st">"12.0%"</span>)<span class="sc">+</span></span>
<span id="cb29-731"><a href="#cb29-731"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">4.25</span>, <span class="at">label =</span> <span class="st">"8.5%"</span>)<span class="sc">+</span></span>
<span id="cb29-732"><a href="#cb29-732"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">13.2</span>, <span class="at">label =</span> <span class="st">"26.4%"</span>)</span>
<span id="cb29-733"><a href="#cb29-733"></a></span>
<span id="cb29-734"><a href="#cb29-734"></a><span class="fu">ggsave</span>(<span class="st">"household_barplot.png"</span>, household_barplot)</span>
<span id="cb29-735"><a href="#cb29-735"></a><span class="in">```</span></span>
<span id="cb29-736"><a href="#cb29-736"></a></span>
<span id="cb29-737"><a href="#cb29-737"></a><span class="in">```{r assembling household plot}</span></span>
<span id="cb29-738"><a href="#cb29-738"></a>household_map_sf <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"sanfrancisco_households.png"</span>)</span>
<span id="cb29-739"><a href="#cb29-739"></a>household_map_mesa <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"mesa_households.png"</span>)</span>
<span id="cb29-740"><a href="#cb29-740"></a>household_barplot_ig <span class="ot">&lt;-</span> <span class="fu">image_border</span>(<span class="fu">image_scale</span>(<span class="fu">image_read</span>(<span class="st">"household_barplot.png"</span>),<span class="st">"x1570"</span>), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">geometry =</span> <span class="st">"0x340"</span>)</span>
<span id="cb29-741"><a href="#cb29-741"></a>race_maps <span class="ot">&lt;-</span> <span class="fu">image_append</span>(<span class="fu">c</span>(household_map_sf,household_barplot_ig, household_map_mesa))</span>
<span id="cb29-742"><a href="#cb29-742"></a><span class="fu">image_write</span>(race_maps, <span class="at">path =</span> <span class="st">"household_plot.png"</span>, <span class="at">format =</span> <span class="st">"png"</span>)</span>
<span id="cb29-743"><a href="#cb29-743"></a><span class="in">```</span></span>
<span id="cb29-744"><a href="#cb29-744"></a></span>
<span id="cb29-745"><a href="#cb29-745"></a><span class="fu"># Households</span></span>
<span id="cb29-746"><a href="#cb29-746"></a></span>
<span id="cb29-747"><a href="#cb29-747"></a><span class="al">![Plot shows the distribution of household types in the two counties by census tract and as a county as a whole](household_plot.png)</span>{.column-screen}</span>
<span id="cb29-748"><a href="#cb29-748"></a></span>
<span id="cb29-749"><a href="#cb29-749"></a>  In our plot, we can see that within these two counties, our preconceived notion is that more traditional/family household types are in the area considered the “most conservative” while there are more non-traditional/non-family households in the area considered the most liberal. The bar plot demonstrates that, while both San Francisco and Maricopa County both have a large percentage of their households that fall in the married couple category, Maricopa County has slightly more. The opposite can be said about live alone households, where San Francisco has a larger percentage of their households falling under this category than Maricopa County. </span>
<span id="cb29-750"><a href="#cb29-750"></a>  The maps also show that these trends are more true around the cities, where most census tracts around San Francisco have the majority of their households that fall within a non-traditional housing category. More of the census tracts that surround Mesa have the majority of their households fall under the married couple category, which backs up our original idea.</span>
<span id="cb29-751"><a href="#cb29-751"></a></span>
<span id="cb29-752"><a href="#cb29-752"></a><span class="in">```{r San Francisco Income map, fig.width = 7.5, fig.height=7.5}</span></span>
<span id="cb29-753"><a href="#cb29-753"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#edf8fb"</span>, <span class="st">"#b2e2e2"</span>,<span class="st">"#66c2a4"</span>,<span class="st">"#2ca25f"</span>,<span class="st">"#006d2c"</span>)</span>
<span id="cb29-754"><a href="#cb29-754"></a><span class="fu">make_sanfrancisco</span>(sanfrancisco_income,sanfrancisco_income<span class="sc">$</span>cat, <span class="st">"San Francisco County Median Income Distribution"</span>, <span class="st">"Median Income"</span>,cols)</span>
<span id="cb29-755"><a href="#cb29-755"></a><span class="in">```</span></span>
<span id="cb29-756"><a href="#cb29-756"></a></span>
<span id="cb29-757"><a href="#cb29-757"></a><span class="in">```{r Mesa Income Map, fig.width = 7.5, fig.height=7.5}</span></span>
<span id="cb29-758"><a href="#cb29-758"></a>cols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#edf8fb"</span>, <span class="st">"#b2e2e2"</span>,<span class="st">"#66c2a4"</span>,<span class="st">"#2ca25f"</span>,<span class="st">"#006d2c"</span>)</span>
<span id="cb29-759"><a href="#cb29-759"></a><span class="fu">make_mesa</span>(mesa_income, mesa_income<span class="sc">$</span>cat,<span class="st">"Maricopa County Median Income Distribution"</span>, <span class="st">"Median Income"</span>,cols)</span>
<span id="cb29-760"><a href="#cb29-760"></a><span class="in">```</span></span>
<span id="cb29-761"><a href="#cb29-761"></a></span>
<span id="cb29-762"><a href="#cb29-762"></a><span class="in">```{r Code for income barplot}</span></span>
<span id="cb29-763"><a href="#cb29-763"></a>avg_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb29-764"><a href="#cb29-764"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb29-765"><a href="#cb29-765"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B07011_001"</span>),</span>
<span id="cb29-766"><a href="#cb29-766"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb29-767"><a href="#cb29-767"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb29-768"><a href="#cb29-768"></a>  <span class="fu">summarize</span>(<span class="at">income =</span> <span class="fu">mean</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-769"><a href="#cb29-769"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="st">"Average U.S County"</span>)</span>
<span id="cb29-770"><a href="#cb29-770"></a></span>
<span id="cb29-771"><a href="#cb29-771"></a>sf_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb29-772"><a href="#cb29-772"></a>  <span class="at">state =</span> <span class="st">"CA"</span>,</span>
<span id="cb29-773"><a href="#cb29-773"></a>  <span class="at">county =</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-774"><a href="#cb29-774"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb29-775"><a href="#cb29-775"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B07011_001"</span>),</span>
<span id="cb29-776"><a href="#cb29-776"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb29-777"><a href="#cb29-777"></a>)</span>
<span id="cb29-778"><a href="#cb29-778"></a></span>
<span id="cb29-779"><a href="#cb29-779"></a>ms_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb29-780"><a href="#cb29-780"></a>  <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb29-781"><a href="#cb29-781"></a>  <span class="at">county =</span> <span class="st">"Maricopa"</span>,</span>
<span id="cb29-782"><a href="#cb29-782"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb29-783"><a href="#cb29-783"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B07011_001"</span>),</span>
<span id="cb29-784"><a href="#cb29-784"></a>  <span class="at">year =</span> <span class="dv">2023</span></span>
<span id="cb29-785"><a href="#cb29-785"></a>)</span>
<span id="cb29-786"><a href="#cb29-786"></a></span>
<span id="cb29-787"><a href="#cb29-787"></a>income_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sf_income, ms_income)<span class="sc">%&gt;%</span></span>
<span id="cb29-788"><a href="#cb29-788"></a>  <span class="fu">select</span>(NAME, estimate) <span class="sc">%&gt;%</span></span>
<span id="cb29-789"><a href="#cb29-789"></a>  <span class="fu">rename</span>(<span class="st">"county"</span> <span class="ot">=</span> <span class="st">"NAME"</span>,</span>
<span id="cb29-790"><a href="#cb29-790"></a>         <span class="st">"income"</span> <span class="ot">=</span> <span class="st">"estimate"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb29-791"><a href="#cb29-791"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-792"><a href="#cb29-792"></a>    county <span class="sc">==</span> <span class="st">"San Francisco County, California"</span> <span class="sc">~</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb29-793"><a href="#cb29-793"></a>    county <span class="sc">==</span> <span class="st">"Maricopa County, Arizona"</span> <span class="sc">~</span> <span class="st">"Maricopa"</span>),</span>
<span id="cb29-794"><a href="#cb29-794"></a>    <span class="at">income =</span> income<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-795"><a href="#cb29-795"></a>  <span class="fu">rbind</span>(avg_income) </span>
<span id="cb29-796"><a href="#cb29-796"></a></span>
<span id="cb29-797"><a href="#cb29-797"></a><span class="fu">ggplot</span>(income_data, <span class="fu">aes</span>(<span class="at">x =</span> county, <span class="at">y =</span> income, <span class="at">fill =</span> county)) <span class="sc">+</span></span>
<span id="cb29-798"><a href="#cb29-798"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb29-799"><a href="#cb29-799"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-800"><a href="#cb29-800"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-801"><a href="#cb29-801"></a>    <span class="at">title =</span> <span class="st">"Average Annual Income in Two Counties"</span>,</span>
<span id="cb29-802"><a href="#cb29-802"></a>    <span class="at">x =</span> <span class="st">"County"</span>,</span>
<span id="cb29-803"><a href="#cb29-803"></a>    <span class="at">y =</span> <span class="st">"Income (thousand)"</span>,</span>
<span id="cb29-804"><a href="#cb29-804"></a>    <span class="at">fill =</span> <span class="st">"County"</span></span>
<span id="cb29-805"><a href="#cb29-805"></a>  ) <span class="sc">+</span></span>
<span id="cb29-806"><a href="#cb29-806"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb29-807"><a href="#cb29-807"></a>    <span class="st">"Average U.S County"</span> <span class="ot">=</span> <span class="st">"#7F7F7F"</span>,</span>
<span id="cb29-808"><a href="#cb29-808"></a>    <span class="st">"Maricopa"</span> <span class="ot">=</span> <span class="st">"#C0392B"</span>,</span>
<span id="cb29-809"><a href="#cb29-809"></a>    <span class="st">"San Francisco"</span> <span class="ot">=</span> <span class="st">"#2C7FB8"</span></span>
<span id="cb29-810"><a href="#cb29-810"></a>  ))</span>
<span id="cb29-811"><a href="#cb29-811"></a><span class="in">```</span></span>
<span id="cb29-812"><a href="#cb29-812"></a></span>
<span id="cb29-813"><a href="#cb29-813"></a>#Income</span>
<span id="cb29-814"><a href="#cb29-814"></a>San Francisco county had a much larger average annual income ($69,000), than Maricopa ($43,000). However, they were both larger than the average U.S county annual income, which was only $35,000.</span>
<span id="cb29-815"><a href="#cb29-815"></a></span>
<span id="cb29-816"><a href="#cb29-816"></a><span class="in">```{r making sanfrancisco education map, fig.height= 7.5, fig.width = 7.5}</span></span>
<span id="cb29-817"><a href="#cb29-817"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>,<span class="st">"#8289fe"</span>,<span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb29-818"><a href="#cb29-818"></a></span>
<span id="cb29-819"><a href="#cb29-819"></a>sf_education_map <span class="ot">&lt;-</span> <span class="fu">make_sanfrancisco</span>(sanfrancisco_education, sanfrancisco_education<span class="sc">$</span>majority, <span class="st">"San Francisco County"</span>, <span class="st">"Majority Education level"</span>, cols)</span>
<span id="cb29-820"><a href="#cb29-820"></a></span>
<span id="cb29-821"><a href="#cb29-821"></a><span class="fu">ggsave</span>(<span class="st">"sanfrancisco_education.png"</span>, sf_education_map)</span>
<span id="cb29-822"><a href="#cb29-822"></a><span class="in">```</span></span>
<span id="cb29-823"><a href="#cb29-823"></a></span>
<span id="cb29-824"><a href="#cb29-824"></a><span class="in">```{r making mesa map for education, fig.width= 7.5, fig.height=7.5}</span></span>
<span id="cb29-825"><a href="#cb29-825"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5fa09f"</span>,<span class="st">"#6c31fd"</span>,<span class="st">"#8289fe"</span>,<span class="st">"#fe8127"</span>, <span class="st">"#fedf60"</span>)</span>
<span id="cb29-826"><a href="#cb29-826"></a></span>
<span id="cb29-827"><a href="#cb29-827"></a>mesa_education_map<span class="ot">&lt;-</span><span class="fu">make_mesa</span>(mesa_education, mesa_education<span class="sc">$</span>majority,<span class="st">"Maricopa"</span>, <span class="st">"Majority Education level"</span>, cols)</span>
<span id="cb29-828"><a href="#cb29-828"></a></span>
<span id="cb29-829"><a href="#cb29-829"></a><span class="fu">ggsave</span>(<span class="st">"mesa_education.png"</span>, mesa_education_map)</span>
<span id="cb29-830"><a href="#cb29-830"></a><span class="in">```</span></span>
<span id="cb29-831"><a href="#cb29-831"></a></span>
<span id="cb29-832"><a href="#cb29-832"></a><span class="in">```{r education barplot, fig.height= 7.5, fig.width=10}</span></span>
<span id="cb29-833"><a href="#cb29-833"></a>education_bar_plot<span class="ot">&lt;-</span><span class="fu">ggplot</span>(education_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> prop, <span class="at">fill =</span> education)) <span class="sc">+</span></span>
<span id="cb29-834"><a href="#cb29-834"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb29-835"><a href="#cb29-835"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb29-836"><a href="#cb29-836"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Education Level across Two Counties"</span>,</span>
<span id="cb29-837"><a href="#cb29-837"></a>       <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span>,</span>
<span id="cb29-838"><a href="#cb29-838"></a>       <span class="at">y =</span> <span class="st">"Percent of Population"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Highest Education Attained"</span>) <span class="sc">+</span></span>
<span id="cb29-839"><a href="#cb29-839"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb29-840"><a href="#cb29-840"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)  <span class="sc">+</span></span>
<span id="cb29-841"><a href="#cb29-841"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb29-842"><a href="#cb29-842"></a>  <span class="st">"#6c31fd"</span>,</span>
<span id="cb29-843"><a href="#cb29-843"></a>  <span class="st">"#8289fe"</span>,</span>
<span id="cb29-844"><a href="#cb29-844"></a>  <span class="st">"#5fa09f"</span>,</span>
<span id="cb29-845"><a href="#cb29-845"></a>  <span class="st">"#fe8127"</span>,</span>
<span id="cb29-846"><a href="#cb29-846"></a>  <span class="st">"#fedf60"</span>,</span>
<span id="cb29-847"><a href="#cb29-847"></a>  <span class="st">"#d23743"</span></span>
<span id="cb29-848"><a href="#cb29-848"></a>))  <span class="sc">+</span> </span>
<span id="cb29-849"><a href="#cb29-849"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb29-850"><a href="#cb29-850"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-851"><a href="#cb29-851"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.23</span>,<span class="fl">0.3</span>),</span>
<span id="cb29-852"><a href="#cb29-852"></a>        <span class="at">legend.direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb29-853"><a href="#cb29-853"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.315</span>, <span class="at">vjust =</span> <span class="fl">3.5</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb29-854"><a href="#cb29-854"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.265</span>, <span class="at">vjust =</span> <span class="dv">8</span>),</span>
<span id="cb29-855"><a href="#cb29-855"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb29-856"><a href="#cb29-856"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="fl">6.5</span>, <span class="at">y =</span><span class="sc">-</span><span class="dv">32</span>, <span class="at">label =</span> <span class="st">"San Francisco County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb29-857"><a href="#cb29-857"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y=</span> <span class="dv">22</span>, <span class="at">label =</span> <span class="st">"Maricopa County"</span>, <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb29-858"><a href="#cb29-858"></a>  <span class="co">#</span></span>
<span id="cb29-859"><a href="#cb29-859"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">6</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">10.05</span>, <span class="at">label =</span> <span class="st">"20.1%"</span>)<span class="sc">+</span></span>
<span id="cb29-860"><a href="#cb29-860"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">22.65</span>, <span class="at">label =</span> <span class="st">"45.3%"</span>)<span class="sc">+</span></span>
<span id="cb29-861"><a href="#cb29-861"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">label =</span> <span class="st">"12.0%"</span>)<span class="sc">+</span></span>
<span id="cb29-862"><a href="#cb29-862"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span><span class="dv">3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">5.65</span>, <span class="at">label =</span> <span class="st">"11.3%"</span>)<span class="sc">+</span></span>
<span id="cb29-863"><a href="#cb29-863"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">3.75</span>, <span class="at">label =</span> <span class="st">"7.5%"</span>)<span class="sc">+</span></span>
<span id="cb29-864"><a href="#cb29-864"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">1</span>, <span class="at">y =</span><span class="sc">-</span><span class="fl">7.85</span>, <span class="at">label =</span> <span class="st">"3.7%"</span>)<span class="sc">+</span></span>
<span id="cb29-865"><a href="#cb29-865"></a>  </span>
<span id="cb29-866"><a href="#cb29-866"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">6</span>, <span class="at">y =</span> <span class="fl">5.65</span>, <span class="at">label =</span> <span class="st">"11.3%"</span>)<span class="sc">+</span></span>
<span id="cb29-867"><a href="#cb29-867"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fl">16.8</span>, <span class="at">label =</span> <span class="st">"33.6%"</span>)<span class="sc">+</span></span>
<span id="cb29-868"><a href="#cb29-868"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="fl">11.3</span>, <span class="at">label =</span> <span class="st">"22.6%"</span>)<span class="sc">+</span></span>
<span id="cb29-869"><a href="#cb29-869"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fl">11.5</span>, <span class="at">label =</span> <span class="st">"22.0%"</span>)<span class="sc">+</span></span>
<span id="cb29-870"><a href="#cb29-870"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">4.3</span>, <span class="at">label =</span> <span class="st">"8.6%"</span>)<span class="sc">+</span></span>
<span id="cb29-871"><a href="#cb29-871"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">5.9</span>, <span class="at">label =</span> <span class="st">"1.9%"</span>)</span>
<span id="cb29-872"><a href="#cb29-872"></a></span>
<span id="cb29-873"><a href="#cb29-873"></a><span class="fu">ggsave</span>(<span class="st">"education_barplot.png"</span>, education_bar_plot)</span>
<span id="cb29-874"><a href="#cb29-874"></a><span class="in">```</span></span>
<span id="cb29-875"><a href="#cb29-875"></a></span>
<span id="cb29-876"><a href="#cb29-876"></a><span class="in">```{r assembling the education plots}</span></span>
<span id="cb29-877"><a href="#cb29-877"></a>household_map_sf <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"sanfrancisco_education.png"</span>)</span>
<span id="cb29-878"><a href="#cb29-878"></a>household_map_mesa <span class="ot">&lt;-</span> <span class="fu">image_read</span>(<span class="st">"mesa_education.png"</span>)</span>
<span id="cb29-879"><a href="#cb29-879"></a>household_barplot_ig <span class="ot">&lt;-</span> <span class="fu">image_border</span>(<span class="fu">image_scale</span>(<span class="fu">image_read</span>(<span class="st">"education_barplot.png"</span>),<span class="st">"x1570"</span>), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">geometry =</span> <span class="st">"0x340"</span>)</span>
<span id="cb29-880"><a href="#cb29-880"></a>race_maps <span class="ot">&lt;-</span> <span class="fu">image_append</span>(<span class="fu">c</span>(household_map_sf,household_barplot_ig, household_map_mesa))</span>
<span id="cb29-881"><a href="#cb29-881"></a><span class="fu">image_write</span>(race_maps, <span class="at">path =</span> <span class="st">"education_plot.png"</span>, <span class="at">format =</span> <span class="st">"png"</span>)</span>
<span id="cb29-882"><a href="#cb29-882"></a><span class="in">```</span></span>
<span id="cb29-883"><a href="#cb29-883"></a></span>
<span id="cb29-884"><a href="#cb29-884"></a><span class="fu"># Education</span></span>
<span id="cb29-885"><a href="#cb29-885"></a><span class="al">![Plot shows the distribution of the average highest level of education recieved in the two counties by census tract and as a county as a whole.](education_plot.png)</span>{.column-screen}</span>
<span id="cb29-886"><a href="#cb29-886"></a></span>
<span id="cb29-887"><a href="#cb29-887"></a>  Our education plot was consistent with our other findings, where the information displayed is consistent with our prior thoughts. However, census tracts around both cities have a majority of people who answered the survey with an undergraduate degree as their highest level of education. This could be because Maricopa county is quite large, and incorporated more areas than San Francisco County, which could have resulted in the more even distribution of highest degree levels. </span>
<span id="cb29-888"><a href="#cb29-888"></a></span>
<span id="cb29-889"><a href="#cb29-889"></a><span class="in">```{r Setting up radar plots}</span></span>
<span id="cb29-890"><a href="#cb29-890"></a>radar_house <span class="ot">&lt;-</span> household_data <span class="sc">%&gt;%</span></span>
<span id="cb29-891"><a href="#cb29-891"></a>  <span class="fu">select</span>(<span class="sc">-</span>population) <span class="sc">%&gt;%</span></span>
<span id="cb29-892"><a href="#cb29-892"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">abs</span>(prop)) <span class="sc">%&gt;%</span></span>
<span id="cb29-893"><a href="#cb29-893"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb29-894"><a href="#cb29-894"></a>    <span class="at">names_from =</span> household,</span>
<span id="cb29-895"><a href="#cb29-895"></a>    <span class="at">values_from =</span> prop</span>
<span id="cb29-896"><a href="#cb29-896"></a>  )</span>
<span id="cb29-897"><a href="#cb29-897"></a></span>
<span id="cb29-898"><a href="#cb29-898"></a>radar_race <span class="ot">&lt;-</span> race_data <span class="sc">%&gt;%</span></span>
<span id="cb29-899"><a href="#cb29-899"></a>  <span class="fu">select</span>(<span class="sc">-</span>population) <span class="sc">%&gt;%</span></span>
<span id="cb29-900"><a href="#cb29-900"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">abs</span>(prop)) <span class="sc">%&gt;%</span></span>
<span id="cb29-901"><a href="#cb29-901"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb29-902"><a href="#cb29-902"></a>    <span class="at">names_from =</span> race,</span>
<span id="cb29-903"><a href="#cb29-903"></a>    <span class="at">values_from =</span> prop</span>
<span id="cb29-904"><a href="#cb29-904"></a>  )</span>
<span id="cb29-905"><a href="#cb29-905"></a></span>
<span id="cb29-906"><a href="#cb29-906"></a>radar_education <span class="ot">&lt;-</span> education_data <span class="sc">%&gt;%</span></span>
<span id="cb29-907"><a href="#cb29-907"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">abs</span>(prop)) <span class="sc">%&gt;%</span></span>
<span id="cb29-908"><a href="#cb29-908"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb29-909"><a href="#cb29-909"></a>    <span class="at">names_from =</span> education,</span>
<span id="cb29-910"><a href="#cb29-910"></a>    <span class="at">values_from =</span> prop</span>
<span id="cb29-911"><a href="#cb29-911"></a>  )</span>
<span id="cb29-912"><a href="#cb29-912"></a></span>
<span id="cb29-913"><a href="#cb29-913"></a>radar_total <span class="ot">&lt;-</span> <span class="fu">cbind</span>(radar_house, radar_race <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>county), radar_education <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>county))</span>
<span id="cb29-914"><a href="#cb29-914"></a></span>
<span id="cb29-915"><a href="#cb29-915"></a><span class="fu">colnames</span>(radar_house) <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(<span class="fu">colnames</span>(radar_house), <span class="at">width =</span> <span class="dv">15</span>)</span>
<span id="cb29-916"><a href="#cb29-916"></a><span class="fu">colnames</span>(radar_race) <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(<span class="fu">colnames</span>(radar_race), <span class="at">width =</span> <span class="dv">15</span>)</span>
<span id="cb29-917"><a href="#cb29-917"></a><span class="fu">colnames</span>(radar_education) <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(<span class="fu">colnames</span>(radar_education), <span class="at">width =</span> <span class="dv">15</span>)</span>
<span id="cb29-918"><a href="#cb29-918"></a><span class="fu">colnames</span>(radar_total) <span class="ot">&lt;-</span> <span class="fu">str_wrap</span>(<span class="fu">colnames</span>(radar_total), <span class="at">width =</span> <span class="dv">15</span>)</span>
<span id="cb29-919"><a href="#cb29-919"></a></span>
<span id="cb29-920"><a href="#cb29-920"></a><span class="in">```</span></span>
<span id="cb29-921"><a href="#cb29-921"></a></span>
<span id="cb29-922"><a href="#cb29-922"></a><span class="in">```{r, fig.width=10, fig.height=7}</span></span>
<span id="cb29-923"><a href="#cb29-923"></a><span class="co"># Radar with House Variables</span></span>
<span id="cb29-924"><a href="#cb29-924"></a><span class="fu">ggradar</span>(</span>
<span id="cb29-925"><a href="#cb29-925"></a>  radar_house,</span>
<span id="cb29-926"><a href="#cb29-926"></a>  <span class="at">group.colours =</span> <span class="fu">c</span>(<span class="st">"#C0392B"</span>, <span class="st">"#2C7FB8"</span>),</span>
<span id="cb29-927"><a href="#cb29-927"></a>  <span class="at">axis.label.size =</span> <span class="dv">4</span>,</span>
<span id="cb29-928"><a href="#cb29-928"></a>  <span class="at">grid.label.size =</span> <span class="dv">0</span>,</span>
<span id="cb29-929"><a href="#cb29-929"></a>  <span class="at">axis.label.offset =</span> <span class="fl">1.2</span></span>
<span id="cb29-930"><a href="#cb29-930"></a>) <span class="sc">+</span></span>
<span id="cb29-931"><a href="#cb29-931"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-932"><a href="#cb29-932"></a>    <span class="at">title =</span> <span class="st">"Household Comparision across Two Counties"</span>,</span>
<span id="cb29-933"><a href="#cb29-933"></a>    <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span></span>
<span id="cb29-934"><a href="#cb29-934"></a>) <span class="sc">+</span></span>
<span id="cb29-935"><a href="#cb29-935"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-936"><a href="#cb29-936"></a>  <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-937"><a href="#cb29-937"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb29-938"><a href="#cb29-938"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb29-939"><a href="#cb29-939"></a>  <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb29-940"><a href="#cb29-940"></a>) <span class="sc">+</span></span>
<span id="cb29-941"><a href="#cb29-941"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"County"</span>))</span>
<span id="cb29-942"><a href="#cb29-942"></a><span class="in">```</span></span>
<span id="cb29-943"><a href="#cb29-943"></a></span>
<span id="cb29-944"><a href="#cb29-944"></a><span class="in">```{r, fig.width=10, fig.height=7}</span></span>
<span id="cb29-945"><a href="#cb29-945"></a><span class="co"># Radar with Race Variables</span></span>
<span id="cb29-946"><a href="#cb29-946"></a><span class="fu">ggradar</span>(</span>
<span id="cb29-947"><a href="#cb29-947"></a>  radar_house,</span>
<span id="cb29-948"><a href="#cb29-948"></a>  <span class="at">group.colours =</span> <span class="fu">c</span>(<span class="st">"#C0392B"</span>, <span class="st">"#2C7FB8"</span>),</span>
<span id="cb29-949"><a href="#cb29-949"></a>  <span class="at">axis.label.size =</span> <span class="dv">4</span>,</span>
<span id="cb29-950"><a href="#cb29-950"></a>  <span class="at">grid.label.size =</span> <span class="dv">0</span>,</span>
<span id="cb29-951"><a href="#cb29-951"></a>  <span class="at">axis.label.offset =</span> <span class="fl">1.2</span></span>
<span id="cb29-952"><a href="#cb29-952"></a>) <span class="sc">+</span></span>
<span id="cb29-953"><a href="#cb29-953"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-954"><a href="#cb29-954"></a>    <span class="at">title =</span> <span class="st">"Race Comparision across Two Counties"</span>,</span>
<span id="cb29-955"><a href="#cb29-955"></a>    <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span></span>
<span id="cb29-956"><a href="#cb29-956"></a>) <span class="sc">+</span></span>
<span id="cb29-957"><a href="#cb29-957"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-958"><a href="#cb29-958"></a>  <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-959"><a href="#cb29-959"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb29-960"><a href="#cb29-960"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb29-961"><a href="#cb29-961"></a>  <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb29-962"><a href="#cb29-962"></a>) <span class="sc">+</span></span>
<span id="cb29-963"><a href="#cb29-963"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"County"</span>))</span>
<span id="cb29-964"><a href="#cb29-964"></a><span class="in">```</span></span>
<span id="cb29-965"><a href="#cb29-965"></a></span>
<span id="cb29-966"><a href="#cb29-966"></a><span class="in">```{r, fig.width=10, fig.height=7}</span></span>
<span id="cb29-967"><a href="#cb29-967"></a><span class="fu">ggradar</span>(</span>
<span id="cb29-968"><a href="#cb29-968"></a>  radar_education,</span>
<span id="cb29-969"><a href="#cb29-969"></a>  <span class="at">group.colours =</span> <span class="fu">c</span>(<span class="st">"#C0392B"</span>, <span class="st">"#2C7FB8"</span>),</span>
<span id="cb29-970"><a href="#cb29-970"></a>  <span class="at">axis.label.size =</span> <span class="dv">4</span>,</span>
<span id="cb29-971"><a href="#cb29-971"></a>  <span class="at">grid.label.size =</span> <span class="dv">0</span>,</span>
<span id="cb29-972"><a href="#cb29-972"></a>  <span class="at">axis.label.offset =</span> <span class="fl">1.2</span></span>
<span id="cb29-973"><a href="#cb29-973"></a>) <span class="sc">+</span></span>
<span id="cb29-974"><a href="#cb29-974"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-975"><a href="#cb29-975"></a>    <span class="at">title =</span> <span class="st">"Education Comparision across Two Counties"</span>,</span>
<span id="cb29-976"><a href="#cb29-976"></a>    <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span></span>
<span id="cb29-977"><a href="#cb29-977"></a>) <span class="sc">+</span></span>
<span id="cb29-978"><a href="#cb29-978"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-979"><a href="#cb29-979"></a>  <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-980"><a href="#cb29-980"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb29-981"><a href="#cb29-981"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb29-982"><a href="#cb29-982"></a>  <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb29-983"><a href="#cb29-983"></a>) <span class="sc">+</span></span>
<span id="cb29-984"><a href="#cb29-984"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"County"</span>))</span>
<span id="cb29-985"><a href="#cb29-985"></a><span class="in">```</span></span>
<span id="cb29-986"><a href="#cb29-986"></a></span>
<span id="cb29-987"><a href="#cb29-987"></a><span class="in">```{r, fig.width=10, fig.height=7}</span></span>
<span id="cb29-988"><a href="#cb29-988"></a><span class="fu">ggradar</span>(</span>
<span id="cb29-989"><a href="#cb29-989"></a>  radar_total,</span>
<span id="cb29-990"><a href="#cb29-990"></a>  <span class="at">group.colours =</span> <span class="fu">c</span>(<span class="st">"#C0392B"</span>, <span class="st">"#2C7FB8"</span>),</span>
<span id="cb29-991"><a href="#cb29-991"></a>  <span class="at">axis.label.size =</span> <span class="dv">4</span>,</span>
<span id="cb29-992"><a href="#cb29-992"></a>  <span class="at">grid.label.size =</span> <span class="dv">0</span>,</span>
<span id="cb29-993"><a href="#cb29-993"></a>  <span class="at">axis.label.offset =</span> <span class="fl">1.2</span></span>
<span id="cb29-994"><a href="#cb29-994"></a>) <span class="sc">+</span></span>
<span id="cb29-995"><a href="#cb29-995"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-996"><a href="#cb29-996"></a>    <span class="at">title =</span> <span class="st">"All Variable Comparision across Two Counties"</span>,</span>
<span id="cb29-997"><a href="#cb29-997"></a>    <span class="at">subtitle =</span> <span class="st">"Measured by Percent of Observed Population"</span></span>
<span id="cb29-998"><a href="#cb29-998"></a>) <span class="sc">+</span></span>
<span id="cb29-999"><a href="#cb29-999"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-1000"><a href="#cb29-1000"></a>  <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb29-1001"><a href="#cb29-1001"></a>  <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb29-1002"><a href="#cb29-1002"></a>  <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb29-1003"><a href="#cb29-1003"></a>  <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)</span>
<span id="cb29-1004"><a href="#cb29-1004"></a>) <span class="sc">+</span></span>
<span id="cb29-1005"><a href="#cb29-1005"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"County"</span>))</span>
<span id="cb29-1006"><a href="#cb29-1006"></a><span class="in">```</span></span>
<span id="cb29-1007"><a href="#cb29-1007"></a></span>
<span id="cb29-1008"><a href="#cb29-1008"></a><span class="fu"># Larger Scale</span></span>
<span id="cb29-1009"><a href="#cb29-1009"></a>  We then decided to determine which variable had the largest discrepancy between San Francisco and Maricopa county. By creating a radar plot, we determined that the white population from the race data was the most different between the two counties.</span>
<span id="cb29-1010"><a href="#cb29-1010"></a></span>
<span id="cb29-1011"><a href="#cb29-1011"></a><span class="in">```{r final map, fig.cap= "Plot shows the distribution of the United States White Populaiton by State. Uses ACS 2021 data.", fig.alt= "Map shows the distribution of the United State's White Population. This goes against our suspitions that the trends would continue at a state level.", include=FALSE}</span></span>
<span id="cb29-1012"><a href="#cb29-1012"></a>final_map_data <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb29-1013"><a href="#cb29-1013"></a>        <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B02001_001"</span>,<span class="st">"B02001_002"</span>),</span>
<span id="cb29-1014"><a href="#cb29-1014"></a>        <span class="at">year =</span> <span class="dv">2021</span>,</span>
<span id="cb29-1015"><a href="#cb29-1015"></a>        <span class="at">geometry =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-1016"><a href="#cb29-1016"></a>  <span class="fu">select</span>(geometry,variable,estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-1017"><a href="#cb29-1017"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">case_when</span>(variable <span class="sc">==</span> <span class="st">"B02001_001"</span> <span class="sc">~</span> <span class="st">"total_population"</span>,</span>
<span id="cb29-1018"><a href="#cb29-1018"></a>                              variable <span class="sc">==</span> <span class="st">"B02001_002"</span> <span class="sc">~</span> <span class="st">"white_population"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-1019"><a href="#cb29-1019"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb29-1020"><a href="#cb29-1020"></a>  <span class="fu">mutate</span>(<span class="at">white_population =</span> <span class="fu">convert_to_numeric</span>(white_population),</span>
<span id="cb29-1021"><a href="#cb29-1021"></a>         <span class="at">total_population =</span> <span class="fu">convert_to_numeric</span>(total_population),</span>
<span id="cb29-1022"><a href="#cb29-1022"></a>         <span class="at">percent_white =</span> white_population<span class="sc">/</span>total_population)</span>
<span id="cb29-1023"><a href="#cb29-1023"></a></span>
<span id="cb29-1024"><a href="#cb29-1024"></a></span>
<span id="cb29-1025"><a href="#cb29-1025"></a>white_ni <span class="ot">&lt;-</span> <span class="fu">classIntervals</span>(final_map_data<span class="sc">$</span>percent_white,</span>
<span id="cb29-1026"><a href="#cb29-1026"></a>                              <span class="at">n =</span> <span class="dv">5</span>,</span>
<span id="cb29-1027"><a href="#cb29-1027"></a>                              <span class="at">style =</span> <span class="st">"jenks"</span></span>
<span id="cb29-1028"><a href="#cb29-1028"></a>                              )<span class="sc">$</span>brks</span>
<span id="cb29-1029"><a href="#cb29-1029"></a></span>
<span id="cb29-1030"><a href="#cb29-1030"></a>white_labels <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb29-1031"><a href="#cb29-1031"></a></span>
<span id="cb29-1032"><a href="#cb29-1032"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(white_ni)){</span>
<span id="cb29-1033"><a href="#cb29-1033"></a>  white_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb29-1034"><a href="#cb29-1034"></a>      white_labels, <span class="fu">paste0</span>(</span>
<span id="cb29-1035"><a href="#cb29-1035"></a>        <span class="fu">round</span>(white_ni[i<span class="sc">*</span><span class="dv">100</span>],<span class="dv">2</span>),</span>
<span id="cb29-1036"><a href="#cb29-1036"></a>        <span class="st">"% to "</span>,</span>
<span id="cb29-1037"><a href="#cb29-1037"></a>        <span class="fu">round</span>(white_ni[i<span class="sc">+</span><span class="dv">1</span><span class="sc">*</span><span class="dv">100</span>],<span class="dv">2</span>), <span class="st">"%"</span></span>
<span id="cb29-1038"><a href="#cb29-1038"></a>      )</span>
<span id="cb29-1039"><a href="#cb29-1039"></a>  )</span>
<span id="cb29-1040"><a href="#cb29-1040"></a>}</span>
<span id="cb29-1041"><a href="#cb29-1041"></a></span>
<span id="cb29-1042"><a href="#cb29-1042"></a>white_labels <span class="ot">&lt;-</span> white_labels[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(white_labels)<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb29-1043"><a href="#cb29-1043"></a></span>
<span id="cb29-1044"><a href="#cb29-1044"></a>final_map_data<span class="sc">$</span>cat <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb29-1045"><a href="#cb29-1045"></a>  final_map_data<span class="sc">$</span>percent_white,</span>
<span id="cb29-1046"><a href="#cb29-1046"></a>  <span class="at">breaks =</span> white_ni,</span>
<span id="cb29-1047"><a href="#cb29-1047"></a>  <span class="at">labels =</span> white_labels,</span>
<span id="cb29-1048"><a href="#cb29-1048"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span></span>
<span id="cb29-1049"><a href="#cb29-1049"></a>)</span>
<span id="cb29-1050"><a href="#cb29-1050"></a></span>
<span id="cb29-1051"><a href="#cb29-1051"></a>colors <span class="ot">=</span> <span class="fu">c</span>( <span class="st">"#0571b0"</span>,<span class="st">"#92c5de"</span>,<span class="st">"white"</span>,<span class="st">"#f4a582"</span>,<span class="st">"#ca0020"</span>)</span>
<span id="cb29-1052"><a href="#cb29-1052"></a></span>
<span id="cb29-1053"><a href="#cb29-1053"></a>final_map_data <span class="sc">|&gt;</span> </span>
<span id="cb29-1054"><a href="#cb29-1054"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb29-1055"><a href="#cb29-1055"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cat),</span>
<span id="cb29-1056"><a href="#cb29-1056"></a>          <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb29-1057"><a href="#cb29-1057"></a>          <span class="at">size =</span> <span class="fl">0.5</span></span>
<span id="cb29-1058"><a href="#cb29-1058"></a>          )<span class="sc">+</span></span>
<span id="cb29-1059"><a href="#cb29-1059"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">125</span>, <span class="sc">-</span><span class="dv">67</span>), </span>
<span id="cb29-1060"><a href="#cb29-1060"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb29-1061"><a href="#cb29-1061"></a>                     )<span class="sc">+</span></span>
<span id="cb29-1062"><a href="#cb29-1062"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>), </span>
<span id="cb29-1063"><a href="#cb29-1063"></a>                     <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb29-1064"><a href="#cb29-1064"></a>                     )<span class="sc">+</span></span>
<span id="cb29-1065"><a href="#cb29-1065"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"US White Density"</span>)<span class="sc">+</span></span>
<span id="cb29-1066"><a href="#cb29-1066"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb29-1067"><a href="#cb29-1067"></a>    <span class="at">name =</span> <span class="st">"Percent White"</span>,</span>
<span id="cb29-1068"><a href="#cb29-1068"></a>    <span class="at">values =</span> colors</span>
<span id="cb29-1069"><a href="#cb29-1069"></a>  )<span class="sc">+</span></span>
<span id="cb29-1070"><a href="#cb29-1070"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb29-1071"><a href="#cb29-1071"></a>  </span>
<span id="cb29-1072"><a href="#cb29-1072"></a><span class="in">```</span></span>
<span id="cb29-1073"><a href="#cb29-1073"></a></span>
<span id="cb29-1074"><a href="#cb29-1074"></a>  When plotting the percentage of each state that is white who answered the survey, strong trends that we saw in our radar plots were not as strongly reflected, showing that at a larger scale, the states that are more white aren’t necessarily more conservative. We can  see this most clearly with states such as Minnesota and Vermont, both of which run liberal, but also have a high percentage of white people. The opposite can be said for states like Texas and Florida, which both tend to be in the middle when it comes to the percentage of the population that is white, but they tend to run more conservative.</span>
<span id="cb29-1075"><a href="#cb29-1075"></a>  This suggests that the trends we observed at the county level might not be able to be more widely applied at the state level.</span>
<span id="cb29-1076"><a href="#cb29-1076"></a></span>
<span id="cb29-1077"><a href="#cb29-1077"></a></span>
<span id="cb29-1078"><a href="#cb29-1078"></a></span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>